<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="RALPH's Super-Intranet - Retro 90s Company Dashboard">
    <meta name="theme-color" content="#EB008B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>RALPH Intranet - System 1.0</title>
    <script src="cms-config.js"></script>
    <script src="api-integration.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        :root {
            --ralph-pink: #EB008B;
            --ralph-pink-light: #ff1493;
            --terminal-green: #00ff00;
            --terminal-cyan: #00ffff;
            --terminal-yellow: #ffff00;
            --gray-light: #c0c0c0;
            --gray-dark: #808080;
            --window-bg: #c0c0c0;
            --black: #000000;
            --white: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        body {
            font-family: 'VT323', monospace;
            background: var(--ralph-pink);
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    rgba(255,255,255,.2) 0px,
                    transparent 1px,
                    transparent 2px,
                    rgba(255,255,255,.2) 3px
                );
            color: var(--black);
            cursor: auto;
            position: fixed;
            touch-action: manipulation;
        }
        
        .desktop {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .desktop-ascii {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 14px;
            line-height: 1;
            color: rgba(255, 255, 255, 0.3);
            white-space: pre;
            font-family: 'VT323', monospace;
            pointer-events: none;
            text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.2);
            z-index: 1;
            overflow: hidden;
            max-width: calc(100vw - 40px);
        }
        
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: var(--gray-light);
            border-top: 2px solid var(--white);
            display: flex;
            align-items: center;
            padding: 0 4px;
            z-index: 1000;
            box-shadow: inset -1px -1px var(--black), inset 1px 1px #dfdfdf;
        }
        
        .start-button {
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            padding: 4px 12px;
            font-family: 'VT323', monospace;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-right: 8px;
        }
        
        .start-button:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }
        
        .ralph-logo {
            width: 16px;
            height: 16px;
            background: var(--ralph-pink);
            display: inline-block;
        }
        
        .clock {
            margin-left: auto;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            padding: 4px 8px;
            font-size: 18px;
        }
        
        .desktop-icons {
            position: absolute;
            right: 20px;
            top: 20px;
            display: grid;
            grid-template-columns: repeat(2, 100px);
            grid-auto-rows: 100px;
            gap: 20px;
            height: calc(100vh - 80px);
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            text-align: center;
            padding: 8px;
            border: 2px solid transparent;
            touch-action: manipulation;
        }
        
        .icon:hover, .icon:active {
            background: rgba(235, 0, 139, 0.2);
            border: 2px dotted var(--ralph-pink);
        }
        
        .icon-image {
            width: 48px;
            height: 48px;
            margin-bottom: 4px;
            position: relative;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .icon-label {
            font-size: 14px;
            color: var(--white);
            text-shadow: 1px 1px 0 var(--black);
            word-break: break-word;
            line-height: 1.2;
        }
        
        .window {
            position: absolute;
            background: var(--window-bg);
            border: 2px solid;
            border-color: var(--white) var(--black) var(--black) var(--white);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
            display: none;
            min-width: 300px;
            min-height: 200px;
            max-width: 90vw;
            max-height: 85vh;
        }
        
        .window.active {
            display: block;
        }
        
        .window-header {
            background: linear-gradient(90deg, #000080, var(--ralph-pink));
            color: white;
            padding: 3px;
            display: flex;
            align-items: center;
            font-size: 16px;
            cursor: move;
            touch-action: none;
        }
        
        .window-title {
            flex: 1;
            padding: 0 8px;
            font-weight: bold;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .window-button {
            width: 20px;
            height: 20px;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--black) var(--black) var(--white);
            font-family: 'VT323', monospace;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .window-button:active {
            border-color: var(--black) var(--white) var(--white) var(--black);
        }
        
        .window-content {
            padding: 12px;
            background: var(--white);
            margin: 4px;
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            height: calc(100% - 40px);
            overflow-y: auto;
            overflow-x: hidden;
            font-size: 18px;
        }
        
        .module-item {
            background: #f0f0f0;
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            padding: 8px;
            margin-bottom: 8px;
        }
        
        .module-item h3 {
            color: var(--ralph-pink);
            font-size: 20px;
            margin-bottom: 8px;
            border-bottom: 2px dotted var(--ralph-pink);
            padding-bottom: 4px;
        }
        
        .progress-bar {
            background: var(--gray-dark);
            border: 2px solid;
            border-color: var(--black) var(--white) var(--white) var(--black);
            height: 20px;
            position: relative;
            margin: 8px 0;
        }
        
        .progress-fill {
            background: repeating-linear-gradient(
                90deg,
                var(--ralph-pink),
                var(--ralph-pink) 10px,
                var(--ralph-pink-light) 10px,
                var(--ralph-pink-light) 20px
            );
            height: 100%;
            transition: width 0.3s;
        }
        
        .pixel-button {
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            padding: 8px 16px;
            font-family: 'VT323', monospace;
            font-size: 18px;
            cursor: pointer;
            margin: 4px;
            touch-action: manipulation;
        }
        
        .pixel-button:hover, .pixel-button:active {
            background: var(--ralph-pink);
            color: white;
        }
        
        .pixel-button:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }
        
        .blink {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .ascii-art {
            font-size: 12px;
            line-height: 1;
            color: var(--ralph-pink);
            white-space: pre;
            margin: 8px 0;
        }
        
        input[type="text"], textarea {
            background: var(--white);
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            padding: 4px;
            font-family: 'VT323', monospace;
            font-size: 18px;
            width: 100%;
            margin: 4px 0;
        }
        
        .scanlines::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                transparent 50%,
                rgba(0, 0, 0, 0.1) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
        }
        
        .crt-flicker {
            animation: flicker 0.15s infinite;
        }
        
        @keyframes flicker {
            0% { opacity: 0.97; }
            50% { opacity: 1; }
            100% { opacity: 0.98; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--terminal-yellow);
            border: 2px solid var(--black);
            padding: 12px;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
            font-size: 18px;
            z-index: 9998;
            display: none;
            max-width: 300px;
        }
        
        .notification.show {
            display: block;
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--black);
            color: var(--terminal-green);
            font-family: 'VT323', monospace;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s;
            padding: 20px;
        }
        
        .boot-screen.hide {
            opacity: 0;
            pointer-events: none;
        }
        
        .boot-logo {
            font-size: 20px;
            line-height: 1;
            color: var(--ralph-pink);
            white-space: pre;
            margin-bottom: 40px;
            text-shadow: 0 0 10px var(--ralph-pink);
            overflow: hidden;
            max-width: 100%;
        }
        
        .boot-text {
            color: var(--terminal-green);
            font-size: 18px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .loading-bar-container {
            width: 90%;
            max-width: 400px;
            height: 30px;
            border: 2px solid var(--terminal-green);
            background: var(--black);
            position: relative;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }
        
        .loading-bar {
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                var(--ralph-pink),
                var(--ralph-pink) 10px,
                var(--ralph-pink-light) 10px,
                var(--ralph-pink-light) 20px
            );
            width: 0%;
            transition: width 0.3s;
        }
        
        .loading-percentage {
            position: absolute;
            right: -50px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--terminal-green);
            font-size: 18px;
        }
        
        .boot-messages {
            margin-top: 30px;
            height: 100px;
            overflow: hidden;
            font-size: 14px;
            color: var(--terminal-green);
            text-align: left;
            width: 90%;
            max-width: 500px;
        }
        
        .boot-message {
            margin: 2px 0;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        /* Mobile Responsive Styles */
        @media screen and (max-width: 768px) {
            body {
                overflow-y: auto;
                overflow-x: hidden;
                position: relative;
            }
            
            .desktop {
                min-height: 100vh;
                height: auto;
                overflow-y: auto;
                overflow-x: hidden;
            }
            
            .desktop-ascii {
                font-size: 8px;
                line-height: 0.9;
                top: 10px;
                left: 10px;
            }
            
            .desktop-icons {
                position: relative;
                right: auto;
                top: auto;
                padding: 120px 20px 60px 20px;
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                grid-auto-rows: 90px;
                gap: 10px;
                height: auto;
                width: 100%;
                overflow: visible;
            }
            
            .icon {
                padding: 4px;
            }
            
            .icon-image {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .icon-label {
                font-size: 12px;
            }
            
            .window {
                position: fixed !important;
                top: 10px !important;
                left: 10px !important;
                right: 10px !important;
                bottom: 50px !important;
                width: auto !important;
                height: auto !important;
                max-width: none;
                max-height: none;
                z-index: 900;
            }
            
            .window-header {
                touch-action: none;
                padding: 5px;
            }
            
            .window-title {
                font-size: 14px;
            }
            
            .window-button {
                width: 30px;
                height: 30px;
                font-size: 18px;
            }
            
            .window-content {
                font-size: 16px;
                padding: 8px;
            }
            
            .module-item h3 {
                font-size: 18px;
            }
            
            .pixel-button {
                font-size: 16px;
                padding: 10px 12px;
            }
            
            .notification {
                right: 10px;
                top: 10px;
                font-size: 14px;
                max-width: calc(100vw - 40px);
            }
            
            .boot-logo {
                font-size: 10px;
                line-height: 0.9;
            }
            
            .boot-text {
                font-size: 14px;
            }
            
            .loading-percentage {
                right: -40px;
                font-size: 14px;
            }
            
            .boot-messages {
                font-size: 12px;
            }
            
            input[type="text"], textarea {
                font-size: 16px;
                padding: 8px;
            }
            
            /* Hide scanlines on mobile for performance */
            .scanlines::before {
                display: none;
            }
            
            /* Simplify animations on mobile */
            .crt-flicker {
                animation: none;
            }
        }
        
        /* Small mobile devices */
        @media screen and (max-width: 480px) {
            .desktop-ascii {
                font-size: 6px;
                line-height: 0.8;
            }
            
            .desktop-icons {
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
                grid-auto-rows: 80px;
                padding: 100px 10px 60px 10px;
            }
            
            .icon-image {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }
            
            .icon-label {
                font-size: 11px;
            }
            
            .boot-logo {
                font-size: 8px;
            }
        }
        
        /* Landscape mobile */
        @media screen and (max-width: 768px) and (orientation: landscape) {
            .desktop-icons {
                padding: 80px 20px 60px 20px;
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
                grid-auto-rows: 70px;
            }
            
            .desktop-ascii {
                font-size: 6px;
            }
            
            .window {
                top: 5px !important;
                bottom: 45px !important;
            }
        }
        
        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            .icon:hover {
                background: transparent;
                border-color: transparent;
            }
            
            .pixel-button:hover {
                background: var(--gray-light);
                color: inherit;
            }
        }
    </style>
</head>
<body>
    <div class="boot-screen" id="bootScreen">
        <div class="boot-logo" id="bootLogo">
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
 â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
 â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•  â•šâ•â•
        </div>
        <div class="boot-text">INITIALIZING SUPER-INTRANET SYSTEM v1.0</div>
        <div class="loading-bar-container">
            <div class="loading-bar" id="loadingBar"></div>
            <div class="loading-percentage" id="loadingPercentage">0%</div>
        </div>
        <div class="boot-messages" id="bootMessages"></div>
    </div>
    
    <div class="desktop scanlines crt-flicker" style="display: none;" id="desktop">
        <div class="desktop-ascii" id="desktopAscii">
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â•šâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘     â•‘â•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘     â•‘â•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
 â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘     â•‘â•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•  â•šâ•â•     â•šâ•â•šâ•â•â•â•â•â•â•

â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—      
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘      
â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•      

â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘   
â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘   
â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   
â•šâ•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•   

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                  [ SYSTEM v1.0 ONLINE ]
        </div>
        <div class="desktop-icons">
            <div class="icon" onclick="openWindow('newbiz')">
                <div class="icon-image">ğŸ“Š</div>
                <div class="icon-label">New Biz Pipeline</div>
            </div>
            
            <div class="icon" onclick="openWindow('premieres')">
                <div class="icon-image">ğŸ¬</div>
                <div class="icon-label">Premiere Dates</div>
            </div>
            
            <div class="icon" onclick="openWindow('challenge')">
                <div class="icon-image">ğŸ¨</div>
                <div class="icon-label">Creative Challenge</div>
            </div>
            
            <div class="icon" onclick="openWindow('shoutouts')">
                <div class="icon-image">ğŸ‰</div>
                <div class="icon-label">Shoutouts</div>
            </div>
            
            <div class="icon" onclick="openWindow('articles')">
                <div class="icon-image">ğŸ“°</div>
                <div class="icon-label">Industry Articles</div>
            </div>
            
            <div class="icon" onclick="openWindow('ralphnews')">
                <div class="icon-image">ğŸ“¢</div>
                <div class="icon-label">RALPH News</div>
            </div>
            
            <div class="icon" onclick="openWindow('suggestions')">
                <div class="icon-image">ğŸ’­</div>
                <div class="icon-label">Suggestion Box</div>
            </div>
            
            <div class="icon" onclick="openWindow('announcements')">
                <div class="icon-image">ğŸ“£</div>
                <div class="icon-label">Announcements</div>
            </div>
            
            <div class="icon" onclick="openWindow('links')">
                <div class="icon-image">ğŸ”—</div>
                <div class="icon-label">Helpful Links</div>
            </div>
            
            <div class="icon" onclick="openWindow('innovation')">
                <div class="icon-image">ğŸ’¡</div>
                <div class="icon-label">Innovation Updates</div>
            </div>
            
            <div class="icon" onclick="openWindow('resources')">
                <div class="icon-image">ğŸ“</div>
                <div class="icon-label">Resources</div>
            </div>
        </div>
        
        <!-- Windows -->
        <div id="chatbot" class="window active" style="bottom: 60px; left: 20px; top: auto; width: 450px; height: 400px;">
            <div class="window-header">
                <div class="window-title">ğŸ’¬ RALPH Assistant v1.0</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('chatbot')">_</button>
                    <button class="window-button" onclick="maximizeWindow('chatbot')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('chatbot')">X</button>
                </div>
            </div>
            <div class="window-content" style="display: flex; flex-direction: column; padding: 8px;">
                <div id="chatDisplay" style="flex: 1; background: #000; color: #00ff00; padding: 10px; font-family: 'VT323', monospace; font-size: 16px; overflow-y: auto; margin-bottom: 8px; border: 2px solid; border-color: #808080 #ffffff #ffffff #808080;">
                    <div style="color: #EB008B;">=======================================</div>
                    <div style="color: #EB008B;">RALPH ASSISTANT v1.0 - INITIALIZED</div>
                    <div style="color: #EB008B;">=======================================</div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ffff00;">ASSISTANT:</span> Welcome to RALPH's Super-Intranet!
                    </div>
                    <div style="margin-top: 10px;">
                        Here's what you can do:
                    </div>
                    <div style="margin-top: 10px; color: #00ffff;">
                        â–º Click any desktop icon to open modules<br>
                        â–º Drag windows by their title bars<br>
                        â–º Minimize, maximize, or close windows<br>
                        â–º Submit suggestions in the Suggestion Box<br>
                        â–º Accept monthly creative challenges<br>
                        â–º Check project pipelines and deadlines<br>
                        â–º Send shoutouts to team members
                    </div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ffff00;">TIP:</span> Press ESC to close all windows
                    </div>
                    <div style="margin-top: 10px;">
                        Type 'help' for more commands or ask me anything!
                    </div>
                    <div style="margin-top: 10px; color: #00ff00;" class="blink">
                        > _
                    </div>
                </div>
                <div style="display: flex; gap: 4px;">
                    <input type="text" id="chatInput" placeholder="Type your message here..." style="flex: 1; background: #000; color: #00ff00; border: 2px solid #00ff00; font-family: 'VT323', monospace; font-size: 16px; padding: 6px;">
                    <button class="pixel-button" onclick="sendChat()" style="margin: 0; padding: 6px 12px;">SEND</button>
                </div>
            </div>
        </div>
        
        <div id="newbiz" class="window" style="top: 50px; left: 50px;">
            <div class="window-header">
                <div class="window-title">ğŸ“Š New Business Pipeline v2.0</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('newbiz')">_</button>
                    <button class="window-button" onclick="maximizeWindow('newbiz')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('newbiz')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="ascii-art">
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  RALPH PIPELINE TRACKER 1.0  â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                </div>
                <div class="module-item">
                    <h3>ACTIVE PITCHES</h3>
                    <p>â–¸ Global Tech Corp - Video Campaign</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 75%;"></div>
                    </div>
                    <p>â–¸ Fashion Brand X - Social Strategy</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 45%;"></div>
                    </div>
                    <p>â–¸ Auto Company Z - Launch Film</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 90%;"></div>
                    </div>
                </div>
                <div class="module-item">
                    <h3>UPCOMING MEETINGS</h3>
                    <p class="blink">â–º Tomorrow 2:00 PM - Tech Startup Pitch</p>
                    <p>â–º Thursday - Beauty Brand Presentation</p>
                    <p>â–º Next Week - Entertainment Client RFP</p>
                </div>
            </div>
        </div>
        
        <div id="premieres" class="window" style="top: 100px; left: 100px;">
            <div class="window-header">
                <div class="window-title">ğŸ¬ Project Premiere Calendar</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('premieres')">_</button>
                    <button class="window-button" onclick="maximizeWindow('premieres')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('premieres')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>THIS MONTH</h3>
                    <p>ğŸ“… Dec 15 - "Urban Dreams" Documentary</p>
                    <p>ğŸ“… Dec 20 - Holiday Campaign Launch</p>
                    <p>ğŸ“… Dec 28 - Year-End Showcase</p>
                </div>
                <div class="module-item">
                    <h3>JANUARY 2025</h3>
                    <p>ğŸ“… Jan 10 - New Product Launch Film</p>
                    <p>ğŸ“… Jan 15 - Brand Refresh Campaign</p>
                    <p>ğŸ“… Jan 25 - Super Bowl Teaser</p>
                </div>
            </div>
        </div>
        
        <div id="challenge" class="window" style="top: 150px; left: 150px;">
            <div class="window-header">
                <div class="window-title">ğŸ¨ Monthly Creative Challenge</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('challenge')">_</button>
                    <button class="window-button" onclick="maximizeWindow('challenge')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('challenge')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="ascii-art">
     _____ _____ _____ _____ _____ 
    |     | __  |   __|  _  |_   _|
    |   --|    -|   __|     | | |  
    |_____|__|__|_____|__|__| |_|  
                </div>
                <div class="module-item">
                    <h3>DECEMBER CHALLENGE</h3>
                    <p><strong>Theme:</strong> "Retro Future"</p>
                    <p>Create a 30-second concept using only 8-bit graphics and chiptune music!</p>
                    <p><strong>Prize:</strong> ğŸ† Golden Pixel Award + Extra PTO Day</p>
                    <button class="pixel-button" onclick="showNotification('Challenge Accepted!')">ACCEPT CHALLENGE</button>
                </div>
                <div class="module-item">
                    <h3>LAST MONTH'S WINNER</h3>
                    <p>ğŸ¥‡ Sarah M. - "Neon Dreams" Concept</p>
                    <button class="pixel-button">VIEW SUBMISSION</button>
                </div>
            </div>
        </div>
        
        <div id="shoutouts" class="window" style="top: 50px; left: 200px;">
            <div class="window-header">
                <div class="window-title">ğŸ‰ Shoutouts & Celebrations</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('shoutouts')">_</button>
                    <button class="window-button" onclick="maximizeWindow('shoutouts')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('shoutouts')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>BIRTHDAYS THIS MONTH ğŸ‚</h3>
                    <p class="blink">â–º Today - Mike R. from Production!</p>
                    <p>â–º Dec 18 - Jennifer L. from Creative</p>
                    <p>â–º Dec 22 - Alex T. from Strategy</p>
                </div>
                <div class="module-item">
                    <h3>WORK ANNIVERSARIES ğŸŠ</h3>
                    <p>â­ 5 Years - David K.</p>
                    <p>â­ 3 Years - Lisa M.</p>
                    <p>â­ 1 Year - Team Expansion Crew!</p>
                </div>
                <div class="module-item">
                    <h3>SHOUTOUTS ğŸ“¢</h3>
                    <p>"Huge thanks to the edit team for crushing it on the Tech Corp project!" - Management</p>
                    <p>"Props to IT for the smooth system upgrade!" - Everyone</p>
                    <button class="pixel-button" onclick="showNotification('Shoutout sent!')">SEND SHOUTOUT</button>
                </div>
            </div>
        </div>
        
        <div id="articles" class="window" style="top: 100px; left: 250px;">
            <div class="window-header">
                <div class="window-title">ğŸ“° Industry Articles</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('articles')">_</button>
                    <button class="window-button" onclick="maximizeWindow('articles')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('articles')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>TRENDING NOW</h3>
                    <p>ğŸ“– "The Rise of AI in Creative Production"</p>
                    <p>ğŸ“– "2025 Design Trends to Watch"</p>
                    <p>ğŸ“– "Sustainable Filmmaking Practices"</p>
                    <button class="pixel-button">READ MORE</button>
                </div>
                <div class="module-item">
                    <h3>MUST READS</h3>
                    <p>ğŸ“š AdWeek: "Agencies of the Future"</p>
                    <p>ğŸ“š Campaign: "Digital First Strategies"</p>
                    <p>ğŸ“š Creative Review: "Best Campaigns 2024"</p>
                </div>
            </div>
        </div>
        
        <div id="ralphnews" class="window" style="top: 150px; left: 300px;">
            <div class="window-header">
                <div class="window-title">ğŸ“¢ RALPH News Network</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('ralphnews')">_</button>
                    <button class="window-button" onclick="maximizeWindow('ralphnews')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('ralphnews')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="ascii-art">
    â–‘â–ˆâ–€â–„â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–ˆ
    â–‘â–ˆâ–€â–„â–‘â–ˆâ–€â–ˆâ–‘â–ˆâ–‘â–‘â–‘â–ˆâ–€â–€â–‘â–ˆâ–€â–ˆ
    â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–‘â–€â–€â–€â–‘â–€â–‘â–‘â–‘â–€â–‘â–€
                </div>
                <div class="module-item">
                    <h3>BREAKING NEWS</h3>
                    <p class="blink">ğŸ”´ LIVE: New Office Space Opening Q1 2025!</p>
                    <p>â€¢ Award Win: Best Campaign at Industry Awards</p>
                    <p>â€¢ Client Win: Major Automotive Account</p>
                </div>
                <div class="module-item">
                    <h3>COMPANY UPDATES</h3>
                    <p>âœ“ New Equipment in Studio B</p>
                    <p>âœ“ Holiday Party December 20th</p>
                    <p>âœ“ Q4 Numbers Looking Strong!</p>
                </div>
            </div>
        </div>
        
        <div id="suggestions" class="window" style="top: 50px; left: 350px;">
            <div class="window-header">
                <div class="window-title">ğŸ’­ Digital Suggestion Box</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('suggestions')">_</button>
                    <button class="window-button" onclick="maximizeWindow('suggestions')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('suggestions')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>SUBMIT YOUR IDEA</h3>
                    <input type="text" placeholder="Your Name...">
                    <textarea rows="4" placeholder="Your brilliant idea here..."></textarea>
                    <button class="pixel-button" onclick="submitSuggestion()">SUBMIT</button>
                </div>
                <div class="module-item">
                    <h3>RECENT SUGGESTIONS</h3>
                    <p>ğŸ’¡ "Coffee machine upgrade" - Status: APPROVED âœ“</p>
                    <p>ğŸ’¡ "Flexible Friday hours" - Status: IN REVIEW</p>
                    <p>ğŸ’¡ "Pet-friendly office days" - Status: CONSIDERING</p>
                </div>
            </div>
        </div>
        
        <div id="announcements" class="window" style="top: 100px; left: 400px;">
            <div class="window-header">
                <div class="window-title">ğŸ“£ System Announcements</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('announcements')">_</button>
                    <button class="window-button" onclick="maximizeWindow('announcements')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('announcements')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3 class="blink">âš ï¸ IMPORTANT âš ï¸</h3>
                    <p>System maintenance scheduled for Saturday 2:00 AM</p>
                    <p>Please save all work before Friday EOD</p>
                </div>
                <div class="module-item">
                    <h3>GENERAL ANNOUNCEMENTS</h3>
                    <p>ğŸ“Œ Parking lot B closed for repairs this week</p>
                    <p>ğŸ“Œ New health benefits info session Thursday</p>
                    <p>ğŸ“Œ Kitchen renovation complete - enjoy!</p>
                </div>
            </div>
        </div>
        
        <div id="links" class="window" style="top: 150px; left: 450px;">
            <div class="window-header">
                <div class="window-title">ğŸ”— Quick Links Directory</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('links')">_</button>
                    <button class="window-button" onclick="maximizeWindow('links')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('links')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>INTERNAL TOOLS</h3>
                    <button class="pixel-button">TIMESHEET SYSTEM</button>
                    <button class="pixel-button">PROJECT TRACKER</button>
                    <button class="pixel-button">EXPENSE REPORTS</button>
                    <button class="pixel-button">IT HELPDESK</button>
                </div>
                <div class="module-item">
                    <h3>EXTERNAL RESOURCES</h3>
                    <button class="pixel-button">CLIENT PORTAL</button>
                    <button class="pixel-button">VENDOR DATABASE</button>
                    <button class="pixel-button">STOCK FOOTAGE</button>
                </div>
            </div>
        </div>
        
        <div id="innovation" class="window" style="top: 50px; left: 500px;">
            <div class="window-header">
                <div class="window-title">ğŸ’¡ Innovation Lab Updates</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('innovation')">_</button>
                    <button class="window-button" onclick="maximizeWindow('innovation')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('innovation')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>CURRENT EXPERIMENTS</h3>
                    <p>ğŸ”¬ VR Production Pipeline - Phase 2</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 60%;"></div>
                    </div>
                    <p>ğŸ”¬ AI-Assisted Editing Tools</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 40%;"></div>
                    </div>
                    <p>ğŸ”¬ Real-time Rendering System</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 80%;"></div>
                    </div>
                </div>
                <div class="module-item">
                    <h3>INNOVATION FRIDAYS</h3>
                    <p>Next Session: "Future of Motion Graphics"</p>
                    <p>Speaker: Guest from Pixar</p>
                    <button class="pixel-button" onclick="showNotification('RSVP Confirmed!')">RSVP</button>
                </div>
            </div>
        </div>
        
        <div id="resources" class="window" style="top: 100px; left: 550px;">
            <div class="window-header">
                <div class="window-title">ğŸ“ Resource Center</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('resources')">_</button>
                    <button class="window-button" onclick="maximizeWindow('resources')">â–¡</button>
                    <button class="window-button" onclick="closeWindow('resources')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="module-item">
                    <h3>DOCUMENTS</h3>
                    <p>ğŸ“„ Brand Guidelines v3.2</p>
                    <p>ğŸ“„ Employee Handbook 2024</p>
                    <p>ğŸ“„ Creative Best Practices</p>
                    <p>ğŸ“„ Client Onboarding Guide</p>
                    <button class="pixel-button">DOWNLOAD ALL</button>
                </div>
                <div class="module-item">
                    <h3>TEMPLATES</h3>
                    <p>ğŸ“‹ Presentation Template</p>
                    <p>ğŸ“‹ Project Brief Template</p>
                    <p>ğŸ“‹ Invoice Template</p>
                    <button class="pixel-button">ACCESS TEMPLATES</button>
                </div>
                <div class="module-item">
                    <h3>TRAINING MATERIALS</h3>
                    <p>ğŸ“ New Software Tutorials</p>
                    <p>ğŸ“ Client Communication 101</p>
                    <p>ğŸ“ Project Management Basics</p>
                </div>
            </div>
        </div>
        
        <div class="taskbar">
            <button class="start-button" onclick="handleStartButton()">
                <span class="ralph-logo"></span>
                START
            </button>
            <div class="clock" id="clock">12:00 PM</div>
        </div>
        
        <div class="notification" id="notification">
            <span id="notificationText">System Alert!</span>
        </div>
    </div>
    
    <script>
        'use strict';
        
        // Global state management
        const AppState = {
            windows: {},
            activeWindow: null,
            zIndex: 100,
            isMobile: false,
            touchDevice: false,
            config: null,
            apiIntegration: null,
            chatbotAI: null
        };
        
        // Utility functions
        const Utils = {
            isMobileDevice: () => {
                return window.innerWidth <= 768 || 
                       ('ontouchstart' in window) || 
                       (navigator.maxTouchPoints > 0);
            },
            
            debounce: (func, wait) => {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        };
        
        // Window management
        function openWindow(windowId) {
            const windowEl = document.getElementById(windowId);
            if (!windowEl) return;
            
            // Close other windows on mobile
            if (AppState.isMobile) {
                document.querySelectorAll('.window.active').forEach(w => {
                    if (w.id !== windowId) {
                        w.classList.remove('active');
                    }
                });
            }
            
            windowEl.classList.add('active');
            windowEl.style.zIndex = ++AppState.zIndex;
            AppState.activeWindow = windowId;
            
            if (!AppState.windows[windowId]) {
                AppState.windows[windowId] = { draggable: null };
                makeDraggable(windowEl);
            }
            
            beep();
        }
        
        function closeWindow(windowId) {
            const windowEl = document.getElementById(windowId);
            if (!windowEl) return;
            
            windowEl.classList.remove('active');
            if (AppState.activeWindow === windowId) {
                AppState.activeWindow = null;
            }
            beep();
        }
        
        function minimizeWindow(windowId) {
            const windowEl = document.getElementById(windowId);
            if (!windowEl) return;
            
            windowEl.style.display = 'none';
            setTimeout(() => {
                windowEl.style.display = '';
            }, 100);
            beep();
        }
        
        function maximizeWindow(windowId) {
            const windowEl = document.getElementById(windowId);
            if (!windowEl) return;
            
            if (AppState.isMobile) {
                // On mobile, maximizing fills the available space
                windowEl.style.cssText = `
                    position: fixed !important;
                    top: 10px !important;
                    left: 10px !important;
                    right: 10px !important;
                    bottom: 50px !important;
                    width: auto !important;
                    height: auto !important;
                `;
            } else {
                if (windowEl.dataset.maximized === 'true') {
                    // Restore
                    windowEl.style.width = windowEl.dataset.originalWidth || '';
                    windowEl.style.height = windowEl.dataset.originalHeight || '';
                    windowEl.style.top = windowEl.dataset.originalTop || '100px';
                    windowEl.style.left = windowEl.dataset.originalLeft || '100px';
                    windowEl.dataset.maximized = 'false';
                } else {
                    // Maximize
                    windowEl.dataset.originalWidth = windowEl.style.width;
                    windowEl.dataset.originalHeight = windowEl.style.height;
                    windowEl.dataset.originalTop = windowEl.style.top;
                    windowEl.dataset.originalLeft = windowEl.style.left;
                    
                    windowEl.style.width = '90vw';
                    windowEl.style.height = '80vh';
                    windowEl.style.top = '20px';
                    windowEl.style.left = '5vw';
                    windowEl.dataset.maximized = 'true';
                }
            }
            beep();
        }
        
        function makeDraggable(element) {
            if (AppState.isMobile) return; // Disable dragging on mobile
            
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            const header = element.querySelector('.window-header');
            if (!header) return;
            
            const dragMouseDown = (e) => {
                e = e || window.event;
                e.preventDefault();
                
                if (e.type === 'touchstart') {
                    pos3 = e.touches[0].clientX;
                    pos4 = e.touches[0].clientY;
                } else {
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                }
                
                document.onmouseup = closeDragElement;
                document.ontouchend = closeDragElement;
                document.onmousemove = elementDrag;
                document.ontouchmove = elementDrag;
                element.style.zIndex = ++AppState.zIndex;
            };
            
            const elementDrag = (e) => {
                e = e || window.event;
                e.preventDefault();
                
                let clientX, clientY;
                if (e.type === 'touchmove') {
                    clientX = e.touches[0].clientX;
                    clientY = e.touches[0].clientY;
                } else {
                    clientX = e.clientX;
                    clientY = e.clientY;
                }
                
                pos1 = pos3 - clientX;
                pos2 = pos4 - clientY;
                pos3 = clientX;
                pos4 = clientY;
                
                const newTop = element.offsetTop - pos2;
                const newLeft = element.offsetLeft - pos1;
                
                // Boundary checking
                const maxTop = window.innerHeight - element.offsetHeight;
                const maxLeft = window.innerWidth - element.offsetWidth;
                
                element.style.top = Math.max(0, Math.min(newTop, maxTop)) + "px";
                element.style.left = Math.max(0, Math.min(newLeft, maxLeft)) + "px";
            };
            
            const closeDragElement = () => {
                document.onmouseup = null;
                document.ontouchend = null;
                document.onmousemove = null;
                document.ontouchmove = null;
            };
            
            header.onmousedown = dragMouseDown;
            header.ontouchstart = dragMouseDown;
        }
        
        // Clock update
        function updateClock() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            const clockEl = document.getElementById('clock');
            if (clockEl) {
                clockEl.textContent = `${displayHours}:${minutes} ${ampm}`;
            }
        }
        
        // Sound effect
        function beep() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'square';
                gainNode.gain.value = 0.1;
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.05);
            } catch (e) {
                // Silently fail if audio is not supported
            }
        }
        
        // Notification system
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            if (!notification || !notificationText) return;
            
            notificationText.textContent = message;
            notification.classList.add('show');
            beep();
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // START button functionality
        function handleStartButton() {
            const chatbotWindow = document.getElementById('chatbot');
            if (chatbotWindow && !chatbotWindow.classList.contains('active')) {
                openWindow('chatbot');
                showNotification('RALPH Assistant activated!');
            } else {
                showNotification('Assistant already running!');
            }
            beep();
        }

        // Enhanced chatbot functionality with AI integration
        async function sendChat() {
            const input = document.getElementById('chatInput');
            const display = document.getElementById('chatDisplay');
            if (!input || !display) return;
            
            const message = input.value.trim();
            if (message === '') return;
            
            // Remove blinking cursor
            const cursor = display.querySelector('.blink');
            if (cursor) cursor.remove();
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.style.marginTop = '10px';
            userMsg.style.color = '#00ff00';
            userMsg.innerHTML = `<span style="color: #ffffff;">USER:</span> ${message}`;
            display.appendChild(userMsg);
            
            // Add loading indicator
            const loadingMsg = document.createElement('div');
            loadingMsg.style.marginTop = '10px';
            loadingMsg.style.color = '#00ff00';
            loadingMsg.innerHTML = `<span style="color: #ffff00;">ASSISTANT:</span> <span class="blink">Processing...</span>`;
            display.appendChild(loadingMsg);
            display.scrollTop = display.scrollHeight;
            
            // Process bot response
            let response = '';
            const lowerMsg = message.toLowerCase();
            
            // Handle built-in commands first
            if (lowerMsg.includes('help')) {
                response = `Available commands:
â–º 'status' - Check system status
â–º 'time' - Get current time
â–º 'clear' - Clear chat history
â–º 'modules' - List all modules
â–º 'tips' - Show productivity tips
â–º 'refresh' - Update all module content`;
            } else if (lowerMsg.includes('status')) {
                response = 'All systems operational. Network: ONLINE. Projects: 47 active.';
            } else if (lowerMsg.includes('time')) {
                const now = new Date();
                response = `Current time: ${now.toLocaleTimeString()}`;
            } else if (lowerMsg.includes('clear')) {
                display.innerHTML = `<div style="color: #EB008B;">Chat cleared.</div>`;
                if (AppState.chatbotAI) {
                    AppState.chatbotAI.clearHistory();
                }
                input.value = '';
                return;
            } else if (lowerMsg.includes('modules')) {
                const enabledModules = Object.entries(AppState.config?.modules || {})
                    .filter(([id, config]) => config.enabled)
                    .map(([id, config]) => config.title)
                    .join(', ');
                response = `Available modules: ${enabledModules}`;
            } else if (lowerMsg.includes('tips')) {
                response = AppState.isMobile ? 
                    'Pro tip: Tap any icon to open its module!' : 
                    'Pro tip: Hold SHIFT while clicking to open multiple windows at once!';
            } else if (lowerMsg.includes('refresh')) {
                refreshAllModules();
                response = 'Refreshing all module content from APIs...';
            } else if (AppState.chatbotAI) {
                // Use AI chatbot if available
                try {
                    response = await AppState.chatbotAI.sendMessage(message);
                } catch (error) {
                    console.error('Chatbot AI error:', error);
                    response = 'I apologize, but I\'m having trouble processing your request right now.';
                }
            } else {
                // Fallback responses
                const responses = AppState.config?.chatbot?.openai?.fallbackResponses || [
                    'Processing request...',
                    'That\'s interesting! Tell me more.',
                    'System acknowledged.',
                    'Roger that!',
                    'Command received.',
                    'Affirmative!'
                ];
                response = responses[Math.floor(Math.random() * responses.length)];
            }
            
            // Remove loading indicator and add actual response
            display.removeChild(loadingMsg);
            
            const botMsg = document.createElement('div');
            botMsg.style.marginTop = '10px';
            botMsg.style.color = '#00ff00';
            botMsg.innerHTML = `<span style="color: #ffff00;">ASSISTANT:</span> ${response}`;
            display.appendChild(botMsg);
            
            // Add new cursor
            const newCursor = document.createElement('div');
            newCursor.style.marginTop = '10px';
            newCursor.style.color = '#00ff00';
            newCursor.className = 'blink';
            newCursor.textContent = '> _';
            display.appendChild(newCursor);
            
            // Clear input and scroll to bottom
            input.value = '';
            display.scrollTop = display.scrollHeight;
            beep();
        }

        // CMS Functions
        function loadContentFromCMS() {
            if (!AppState.config) return;
            
            // Update chatbot welcome message
            const welcomeArea = document.querySelector('#chatDisplay');
            if (welcomeArea && AppState.config.chatbot) {
                const chatConfig = AppState.config.chatbot;
                welcomeArea.innerHTML = `
                    <div style="color: #EB008B;">=======================================</div>
                    <div style="color: #EB008B;">${chatConfig.title.toUpperCase()} - INITIALIZED</div>
                    <div style="color: #EB008B;">=======================================</div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ffff00;">ASSISTANT:</span> ${chatConfig.welcomeMessage}
                    </div>
                    <div style="margin-top: 10px;">
                        ${chatConfig.helpText}
                    </div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ffff00;">TIP:</span> Press ESC to close all windows
                    </div>
                    <div style="margin-top: 10px;">
                        Type 'help' for more commands or ask me anything!
                    </div>
                    <div style="margin-top: 10px; color: #00ff00;" class="blink">
                        > _
                    </div>
                `;
            }
            
            // Update module icons and titles
            Object.entries(AppState.config.modules).forEach(([moduleId, moduleConfig]) => {
                if (!moduleConfig.enabled) {
                    const icon = document.querySelector(`[onclick="openWindow('${moduleId}')"]`);
                    if (icon) icon.style.display = 'none';
                    return;
                }
                
                const windowElement = document.getElementById(moduleId);
                if (windowElement) {
                    const title = windowElement.querySelector('.window-title');
                    if (title) {
                        title.textContent = `${moduleConfig.icon} ${moduleConfig.title}`;
                    }
                }
            });
        }

        function refreshAllModules() {
            if (!AppState.apiIntegration || !AppState.config) return;
            
            Object.entries(AppState.config.modules).forEach(([moduleId, moduleConfig]) => {
                if (moduleConfig.enabled && moduleConfig.apiEndpoint) {
                    AppState.apiIntegration.updateModuleContent(moduleId, moduleConfig);
                    AppState.apiIntegration.startAutoRefresh(moduleId, moduleConfig);
                }
            });
        }

        // Form submission handler
        async function submitSuggestion() {
            const nameInput = document.querySelector('#suggestions input[type="text"]');
            const ideaInput = document.querySelector('#suggestions textarea');
            
            if (!nameInput || !ideaInput) return;
            
            const data = {
                name: nameInput.value.trim(),
                idea: ideaInput.value.trim(),
                timestamp: new Date().toISOString()
            };
            
            if (!data.name || !data.idea) {
                showNotification('Please fill in all fields!');
                return;
            }
            
            if (AppState.config?.modules?.suggestions?.submitEndpoint) {
                const result = await AppState.apiIntegration.submitData(
                    AppState.config.modules.suggestions.submitEndpoint,
                    data
                );
                
                if (result.success) {
                    nameInput.value = '';
                    ideaInput.value = '';
                    showNotification('Suggestion submitted successfully!');
                } else {
                    showNotification('Failed to submit suggestion. Please try again.');
                }
            } else {
                // Simulate success if no API endpoint
                nameInput.value = '';
                ideaInput.value = '';
                showNotification('Suggestion submitted!');
            }
        }
        
        // Responsive handling
        function handleResize() {
            const wasMobile = AppState.isMobile;
            AppState.isMobile = Utils.isMobileDevice();
            
            if (wasMobile !== AppState.isMobile) {
                // Reset window positions when switching between mobile and desktop
                document.querySelectorAll('.window').forEach(windowEl => {
                    if (AppState.isMobile) {
                        windowEl.style.cssText = '';
                    } else {
                        windowEl.dataset.maximized = 'false';
                    }
                });
            }
        }
        
        // Boot sequence
        function bootSequence() {
            const bootScreen = document.getElementById('bootScreen');
            const desktop = document.getElementById('desktop');
            const loadingBar = document.getElementById('loadingBar');
            const loadingPercentage = document.getElementById('loadingPercentage');
            const bootMessages = document.getElementById('bootMessages');
            
            if (!bootScreen || !desktop) return;
            
            const messages = [
                'Loading system kernel...',
                'Initializing RALPH protocols...',
                'Checking security clearance...',
                'Loading user preferences...',
                'Mounting network drives...',
                'Starting creative services...',
                'Loading project database...',
                'Initializing communication modules...',
                'Checking for updates...',
                'Loading desktop environment...',
                'Starting RALPH SUPER-INTRANET...',
                'System ready!'
            ];
            
            let progress = 0;
            let messageIndex = 0;
            
            const bootInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                if (loadingBar) loadingBar.style.width = progress + '%';
                if (loadingPercentage) loadingPercentage.textContent = Math.floor(progress) + '%';
                
                if (bootMessages && messageIndex < messages.length && 
                    progress > (messageIndex / messages.length) * 100) {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'boot-message';
                    messageDiv.textContent = '> ' + messages[messageIndex];
                    bootMessages.appendChild(messageDiv);
                    bootMessages.scrollTop = bootMessages.scrollHeight;
                    beep();
                    messageIndex++;
                }
                
                if (progress >= 100) {
                    clearInterval(bootInterval);
                    setTimeout(() => {
                        bootScreen.classList.add('hide');
                        desktop.style.display = 'block';
                        
                        // Make chatbot window draggable
                        const chatbotWindow = document.getElementById('chatbot');
                        if (chatbotWindow && !AppState.isMobile) {
                            makeDraggable(chatbotWindow);
                        }
                        
                        setTimeout(() => {
                            showNotification('RALPH INTRANET SYSTEM 1.0 - READY');
                        }, 500);
                    }, 1000);
                }
            }, 300);
        }
        
        // Initialize application
        async function init() {
            // Detect device type
            AppState.isMobile = Utils.isMobileDevice();
            AppState.touchDevice = 'ontouchstart' in window;
            
            // Load CMS configuration
            if (typeof CMS_CONFIG !== 'undefined') {
                AppState.config = CMS_CONFIG;
                
                // Initialize API integration
                if (typeof APIIntegration !== 'undefined') {
                    AppState.apiIntegration = new APIIntegration(AppState.config);
                }
                
                // Initialize ChatbotAI if configured
                if (typeof ChatbotAI !== 'undefined' && AppState.config.chatbot?.openai) {
                    AppState.chatbotAI = new ChatbotAI(AppState.config.chatbot.openai);
                    
                    // Load custom prompt if file exists
                    try {
                        await AppState.chatbotAI.initialize('custom-prompt.txt');
                    } catch (error) {
                        console.log('No custom prompt file found, using default');
                    }
                }
                
                // Load content from CMS
                loadContentFromCMS();
            }
            
            // Start boot sequence
            bootSequence();
            
            // Start clock
            setInterval(updateClock, 1000);
            updateClock();
            
            // Handle responsive design
            window.addEventListener('resize', Utils.debounce(handleResize, 250));
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.window.active').forEach(w => {
                        w.classList.remove('active');
                    });
                }
            });
            
            // Chat input handler
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendChat();
                    }
                });
            }
            
            // Prevent zoom on double tap for mobile
            if (AppState.touchDevice) {
                let lastTouchEnd = 0;
                document.addEventListener('touchend', (e) => {
                    const now = Date.now();
                    if (now - lastTouchEnd <= 300) {
                        e.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
            
            // Start auto-refresh for modules with API endpoints
            setTimeout(() => {
                refreshAllModules();
            }, 2000); // Delay to ensure all elements are loaded
        }
        
        // Start application when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>