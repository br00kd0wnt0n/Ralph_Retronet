<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="RALPH's Super-Intranet - Retro 90s Company Dashboard">
    <meta name="theme-color" content="#EB008B">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' *; frame-src *;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <!-- X-Frame-Options should be set via HTTP header, not meta tag -->
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ•Ô∏è</text></svg>")
    <title></title>
    <script>
        // Fallback CMS config if external file fails to load
        if (typeof CMS_CONFIG === 'undefined') {
            // Fallback CMS config loaded
        }
    </script>
    <script src="./cms-config-production.js?v=2" onerror="console.warn('‚ö†Ô∏è Failed to load cms-config-production.js, falling back to cms-config.js'); var fallbackScript = document.createElement('script'); fallbackScript.src = './cms-config.js?v=2'; fallbackScript.onerror = function() { console.error('‚ùå Failed to load cms-config.js fallback'); }; document.head.appendChild(fallbackScript);"></script>
    <script src="./api-integration.js" onerror="console.error('Failed to load api-integration.js')"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap');
        
        :root {
            --ralph-pink: #EB008B;
            --ralph-pink-light: #ff1493;
            --ralph-blue: #31BDBF;
            --ralph-orange: #F16524;
            --ralph-green: #44B658;
            --ralph-yellow: #FBC000;
            --ralph-brown: #301609;
            --terminal-green: #00ff00;
            --terminal-cyan: #00ffff;
            --terminal-yellow: #ffff00;
            --gray-light: #c0c0c0;
            --gray-dark: #808080;
            --window-bg: #c0c0c0;
            --black: #000000;
            --white: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        body {
            font-family: 'Space Mono', 'Courier Prime', monospace;
            font-size: 14px;
            background: var(--ralph-pink);
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    rgba(255,255,255,.2) 0px,
                    transparent 1px,
                    transparent 2px,
                    rgba(255,255,255,.2) 3px
                );
            color: var(--black);
            cursor: auto;
            position: fixed;
            touch-action: manipulation;
        }
        
        .desktop {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .desktop-ascii {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 12px;
            line-height: 1.0;
            color: rgba(255, 255, 255, 0.3);
            white-space: pre;
            font-family: 'Courier Prime', monospace;
            pointer-events: none;
            text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.2);
            z-index: 0;
            overflow: hidden;
            max-width: calc(100vw - 40px);
            opacity: 0;
        }
        
        .desktop-ascii.animating {
            opacity: 1;
        }
        
        .ascii-char {
            opacity: 0;
            transition: opacity 0.15s ease-in;
        }
        
        .ascii-char.visible {
            opacity: 1;
        }
        
        
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: var(--gray-light);
            border-top: 2px solid var(--white);
            display: none; /* Hidden initially during login/boot */
            align-items: center;
            padding: 0 4px;
            z-index: 25000; /* Same level as start menu to allow proper layering */
            box-shadow: inset -1px -1px var(--black), inset 1px 1px #dfdfdf;
        }
        
        /* Start Menu Styles */
        .start-menu {
            position: absolute;
            bottom: 42px;
            left: 0;
            width: 250px;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--black) var(--black) var(--white);
            box-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 25000; /* Well above all windows */
        }
        
        .start-menu-header {
            background: linear-gradient(90deg, var(--ralph-pink) 0%, #ff1493 100%);
            color: white;
            padding: 10px;
            font-size: 14px;
            font-family: 'Space Mono', monospace;
            font-weight: bold;
            border-bottom: 2px solid var(--black);
        }
        
        .start-menu-items {
            background: white;
        }
        
        .start-menu-item {
            padding: 8px 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 13px;
            font-family: 'Space Mono', monospace;
            transition: background 0.2s;
        }
        
        .start-menu-item:hover {
            background: var(--ralph-pink);
            color: white;
        }
        
        .start-menu-icon {
            margin-right: 10px;
            font-size: 16px;
        }
        
        .start-menu-separator {
            height: 1px;
            background: var(--gray-dark);
            margin: 4px 10px;
        }
        
        .start-button {
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            padding: 4px 12px;
            font-family: 'VT323', monospace;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-right: 8px;
        }
        
        .start-button:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }

        .sound-button {
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            padding: 4px 8px;
            font-size: 16px;
            cursor: pointer;
            font-family: 'VT323', monospace;
            color: var(--black);
            transition: all 0.1s;
            min-width: 40px;
            position: absolute;
            right: 120px;
            top: 50%;
            transform: translateY(-50%);
        }

        .sound-button:hover {
            background: var(--white);
        }

        .sound-button:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }

        .sound-button.active {
            background: var(--ralph-pink);
            color: var(--white);
        }
        
        .ralph-logo {
            width: 16px;
            height: 16px;
            background: var(--ralph-pink);
            display: inline-block;
        }
        
        .clock {
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            padding: 4px 8px;
            font-size: 18px;
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clock:hover {
            background: var(--white);
            border-color: var(--black) var(--gray-light) var(--gray-light) var(--black);
        }

        .timezone-panel {
            position: absolute;
            bottom: 100%;
            right: 0;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            z-index: 20001; /* Above all windows */
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-size: 16px;
        }

        .clock:hover .timezone-panel {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .timezone-header {
            background: var(--ralph-pink);
            color: var(--white);
            text-align: center;
            padding: 6px;
            border-bottom: 1px solid var(--gray-dark);
            font-weight: bold;
            text-shadow: 1px 1px 0 var(--black);
        }

        .timezone-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 8px;
            border-bottom: 1px solid var(--gray-dark);
            transition: background-color 0.2s ease;
        }

        .timezone-item:last-child {
            border-bottom: none;
        }

        .timezone-item:hover {
            background: var(--ralph-pink);
            color: var(--white);
        }

        .timezone-label {
            font-weight: bold;
        }

        .timezone-city {
            font-size: 14px;
            color: var(--gray-dark);
        }

        .timezone-item:hover .timezone-city {
            color: rgba(255, 255, 255, 0.8);
        }

        .timezone-time {
            font-family: 'VT323', monospace;
            font-size: 16px;
            color: var(--black);
        }

        .timezone-item:hover .timezone-time {
            color: var(--white);
        }

        /* Iframe Window Styles */
        .iframe-window {
            position: absolute;
            background: var(--window-bg);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            min-width: 600px;
            min-height: 400px;
            z-index: 1000;
            display: none;
        }

        .iframe-window.active {
            display: block;
            z-index: 1001;
        }

        .iframe-header {
            background: var(--ralph-pink);
            color: var(--white);
            padding: 4px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            font-size: 16px;
            border-bottom: 1px solid var(--gray-dark);
        }

        .iframe-title {
            font-weight: bold;
            flex: 1;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

        .iframe-controls {
            display: flex;
            gap: 4px;
        }

        .iframe-control-btn {
            width: 20px;
            height: 20px;
            background: var(--gray-light);
            border: 1px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: var(--black);
        }

        .iframe-control-btn:hover {
            background: var(--white);
        }

        .iframe-control-btn:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }

        .iframe-content {
            width: 100%;
            height: calc(100% - 29px);
            border: none;
            background: var(--white);
        }

        .iframe-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: var(--white);
            font-family: 'VT323', monospace;
            font-size: 18px;
            color: var(--ralph-pink);
        }

        /* Music Player Styles */
        .music-player {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 280px;
            height: 120px;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            display: none;
            z-index: 20002; /* Above all windows */
            font-family: 'VT323', monospace;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .music-player.active {
            display: block;
        }
        
        .player-header {
            background: var(--ralph-pink);
            color: white;
            padding: 2px 8px;
            font-size: 14px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--gray-dark);
        }
        
        .player-close {
            background: var(--gray-light);
            border: 1px solid var(--gray-dark);
            color: var(--black);
            padding: 2px 6px;
            font-size: 12px;
            cursor: pointer;
        }
        .player-close:hover {
            background: var(--white);
        }
        
        .volume-section {
            display: flex;
            align-items: center;
            padding: 4px 8px;
            gap: 8px;
        }
        
        .volume-label {
            font-size: 12px;
            color: var(--black);
            font-family: 'VT323', monospace;
        }
        
        .volume-slider {
            width: 60px;
            height: 15px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--gray-dark);
            border: 1px solid var(--black);
            outline: none;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--ralph-pink);
            border: 1px solid var(--black);
            cursor: pointer;
        }
        
        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--ralph-pink);
            border: 1px solid var(--black);
            cursor: pointer;
            border-radius: 0;
        }


        .player-display {
            background: #0a0a0a;
            color: var(--terminal-green);
            padding: 4px 8px;
            font-size: 11px;
            height: 32px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-bottom: 1px solid #333;
        }

        .track-info {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .track-time {
            font-size: 10px;
            color: var(--terminal-cyan);
        }

        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 8px;
            gap: 4px;
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
        }

        .control-btn {
            width: 24px;
            height: 20px;
            background: var(--gray-light);
            border: 1px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--black);
            font-family: 'VT323', monospace;
        }

        .control-btn:hover {
            background: var(--white);
        }

        .control-btn:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }

        .control-btn.play {
            background: var(--ralph-pink);
            color: var(--white);
            width: 32px;
        }

        .volume-section {
            display: flex;
            align-items: center;
            padding: 4px 8px;
            background: #2a2a2a;
            border-top: 1px solid #333;
            gap: 4px;
        }

        .volume-label {
            color: var(--gray-light);
            font-size: 10px;
        }

        .volume-slider {
            flex: 1;
            height: 4px;
            background: #0a0a0a;
            border: 1px inset #333;
            position: relative;
        }

        .volume-fill {
            height: 100%;
            background: var(--ralph-pink);
            width: 70%;
            transition: width 0.1s;
        }

        .playlist-btn {
            background: var(--gray-dark);
            border: 1px solid #555;
            color: var(--white);
            padding: 2px 6px;
            cursor: pointer;
            font-size: 10px;
        }
        
        .desktop-icons {
            position: absolute;
            right: 16px;
            top: 20px;
            display: grid;
            grid-template-columns: repeat(2, 120px);
            grid-auto-rows: 100px;
            gap: 16px;
            height: calc(100vh - 80px);
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            text-align: center;
            padding: 8px;
            border: 2px solid transparent;
            touch-action: manipulation;
            width: 120px;
        }
        
        .icon:hover, .icon:active {
            background: rgba(235, 0, 139, 0.2);
            border: 2px dotted var(--ralph-pink);
        }
        
        .icon-image {
            width: 48px;
            height: 48px;
            margin-bottom: 4px;
            position: relative;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .icon-label {
            font-size: 12px;
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            color: var(--white);
            text-shadow: 1px 1px 2px var(--black);
            white-space: nowrap;
            line-height: 1.3;
            text-align: center;
            width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* New content indicator */
        .icon-new-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 16px;
            height: 16px;
            background: var(--terminal-yellow);
            border: 2px solid var(--black);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: var(--black);
            animation: pulse 2s infinite;
            z-index: 10;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        /* ASCII Art Animation Styles */
        .ascii-intro {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20vw;
            height: auto;
            z-index: 10;
            background: transparent;
            color: #ffffff;
            font-family: 'Courier New', monospace;
            font-size: 6px;
            line-height: 1;
            white-space: pre;
            text-align: left;
            pointer-events: none;
            opacity: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            image-rendering: pixelated;
            text-rendering: optimizeSpeed;
        }

        .ascii-intro.show {
            opacity: 1;
        }

        /* RNN Logo Styling */
        .rnn-logo {
            font-family: 'Space Mono', monospace;
            font-weight: 900;
            font-size: 18px;
            color: var(--ralph-pink);
            text-shadow: 1px 1px 0px rgba(0,0,0,0.3);
            letter-spacing: -1px;
            display: inline-block;
        }

        /* Module Description Styling */
        .module-description {
            background: #f8f8f8;
            border: 1px solid var(--gray-dark);
            border-radius: 4px;
            padding: 12px;
            margin: 10px;
            font-size: 13px;
            line-height: 1.4;
            color: #555;
            font-style: italic;
            border-left: 3px solid var(--ralph-pink);
        }

        /* What's New Dashboard Styles */
        /* Z-index is now managed dynamically by JavaScript for proper layering */
        
        .articles-content {
            height: calc(100% - 80px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .articles-layout {
            display: flex;
            flex: 1;
            min-height: 400px;
            overflow: hidden;
        }
        
        .articles-list {
            width: 40%;
            background-color: var(--black);
            border-right: 2px solid var(--ralph-pink);
            overflow-y: auto;
            padding: 20px;
        }
        
        .articles-section {
            margin-bottom: 30px;
        }
        
        .articles-section h3 {
            color: var(--ralph-yellow);
            font-size: 14px;
            margin-bottom: 15px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .article-items {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .article-card {
            cursor: pointer;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 6px;
            background-color: #1a1a1a;
            transition: all 0.2s ease;
        }
        
        .article-card:hover {
            background-color: #222;
            border-color: var(--ralph-pink);
            transform: translateY(-2px);
        }
        
        .article-card.selected {
            background-color: rgba(235, 0, 139, 0.1);
            border-color: var(--ralph-pink);
            box-shadow: 0 0 10px rgba(235, 0, 139, 0.3);
        }
        
        .article-card-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--white);
            line-height: 1.3;
        }
        
        .article-card-metadata {
            font-size: 12px;
            color: #888;
            margin-bottom: 6px;
        }
        
        .article-card-source {
            font-size: 12px;
            color: var(--ralph-yellow);
            font-weight: bold;
        }
        
        .articles-viewer {
            width: 60%;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
        }
        
        .articles-placeholder {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-style: italic;
            text-align: center;
        }
        
        .placeholder-content h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--ralph-yellow);
        }
        
        .placeholder-content p {
            font-size: 14px;
            color: #888;
        }
        
        .article-iframe {
            flex: 1;
            border: none;
            background: white;
            width: 100%;
            height: 100%;
        }
        
        .articles-add-section {
            background: #222;
            border-top: 2px solid var(--ralph-yellow);
            padding: 15px;
            flex-shrink: 0;
        }
        
        .articles-add-section h3 {
            color: var(--ralph-yellow);
            font-size: 14px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .articles-form {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .articles-form input {
            background: #333;
            border: 1px solid #555;
            color: white;
            padding: 6px 8px;
            border-radius: 3px;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            flex: 1;
            min-width: 100px;
        }
        
        .articles-form input:focus {
            outline: none;
            border-color: var(--ralph-pink);
            box-shadow: 0 0 5px rgba(235, 0, 139, 0.3);
        }
        
        .articles-btn {
            background: var(--ralph-yellow);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            font-weight: bold;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .articles-btn:hover {
            background: var(--ralph-pink-light);
        }
        
        /* Ralph News Network Styles */
        .rnn-logo {
            font-family: 'Space Mono', monospace;
            font-weight: 900;
            font-size: 14px;
            background: var(--ralph-pink);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            margin: 0 5px;
        }
        
        /* News Ticker */
        .news-ticker-container {
            background: #1a1a1a;
            border-bottom: 2px solid var(--ralph-pink);
            display: flex;
            align-items: center;
            height: 40px;
            overflow: hidden;
        }
        
        .news-ticker-label {
            background: var(--ralph-pink);
            color: white;
            padding: 0 15px;
            font-weight: bold;
            font-size: 12px;
            height: 100%;
            display: flex;
            align-items: center;
            animation: pulse 2s infinite;
        }
        
        .news-ticker {
            flex: 1;
            height: 100%;
            overflow: hidden;
            position: relative;
        }
        
        .news-ticker-content {
            position: absolute;
            white-space: nowrap;
            animation: scroll-left 30s linear infinite;
            display: flex;
            align-items: center;
            height: 100%;
            padding-left: 100%;
        }
        
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
        
        @keyframes pulse {
            0%, 50% { opacity: 1; }
            25%, 75% { opacity: 0.7; }
        }
        
        /* News Layout */
        .news-layout {
            display: flex;
            min-height: 500px;
            gap: 20px;
            padding: 20px;
        }
        
        /* News Presenter Section */
        .news-presenter-section {
            width: 200px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .presenter-screen {
            background: #222;
            border: 3px solid #444;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            position: relative;
        }
        
        .live-indicator {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: #ff0000;
            color: white;
            padding: 2px 6px;
            font-size: 8px;
            font-weight: bold;
            border-radius: 2px;
            display: flex;
            align-items: center;
            gap: 2px;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .live-dot {
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .presenter-image-container {
            position: relative;
            margin: 10px 12px;
        }
        
        .presenter-image {
            width: 100%;
            height: 140px;
            image-rendering: pixelated;
            border-radius: 6px;
            background: #333;
            transition: none;
            display: block;
            cursor: pointer;
        }
        
        .presenter-image:hover {
            filter: brightness(1.1);
        }
        
        .presenter-image::before {
            content: "üì∫";
            font-size: 60px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: block;
        }
        
        .presenter-name {
            color: var(--ralph-pink);
            font-weight: bold;
            font-size: 12px;
            letter-spacing: 1px;
            margin-top: 10px;
        }
        
        .presenter-title {
            color: #ccc;
            font-size: 10px;
            letter-spacing: 1px;
            margin-top: 5px;
        }
        
        /* Additional Articles Below Presenter */
        .additional-articles {
            background: #1a1a1a;
            border: 2px solid #444;
            border-radius: 6px;
            padding: 10px;
        }
        
        .additional-articles h3 {
            color: var(--ralph-pink);
            font-size: 12px;
            margin: 0 0 10px 0;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .additional-article-item {
            padding: 8px 0;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .additional-article-item:last-child {
            border-bottom: none;
        }
        
        .additional-article-item:hover {
            background: rgba(235, 0, 139, 0.1);
        }
        
        .additional-article-title {
            font-size: 11px;
            font-weight: bold;
            color: #fff;
            line-height: 1.3;
            margin-bottom: 2px;
        }
        
        .additional-article-meta {
            font-size: 9px;
            color: #888;
        }
        
        /* News Content */
        .news-content {
            flex: 1;
            display: grid;
            grid-template-columns: 2fr 1fr;
            grid-template-rows: auto 1fr;
            gap: 20px;
            min-height: 400px;
        }
        
        /* Main Headline */
        .main-headline {
            grid-column: 1 / 2;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .headline-story {
            position: relative;
        }
        
        .headline-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 2px solid var(--ralph-pink);
        }
        
        .headline-content {
            padding: 20px;
        }
        
        .headline-title {
            font-size: 24px;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
            line-height: 1.3;
        }
        
        .headline-excerpt {
            color: #ccc;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .headline-meta {
            font-size: 12px;
            color: var(--ralph-pink);
            border-top: 1px solid #333;
            padding-top: 15px;
        }
        
        /* Secondary Stories */
        .secondary-stories {
            grid-column: 1 / 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .story-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .story-card:hover {
            border-color: var(--ralph-pink);
            transform: translateY(-2px);
        }
        
        .story-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }
        
        .story-content {
            padding: 15px;
        }
        
        .story-title {
            font-size: 16px;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .story-excerpt {
            color: #ccc;
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .story-meta {
            font-size: 11px;
            color: var(--ralph-pink);
        }
        
        /* Sidebar Stories */
        .sidebar-stories {
            grid-column: 2 / 3;
            grid-row: 1 / 3;
        }
        
        .sidebar-title {
            color: var(--ralph-pink);
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--ralph-pink);
        }
        
        .sidebar-story {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .sidebar-story:hover {
            border-color: var(--ralph-pink);
        }
        
        .sidebar-story-title {
            font-size: 14px;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .sidebar-story-excerpt {
            color: #ccc;
            font-size: 12px;
            line-height: 1.4;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .sidebar-story-meta {
            font-size: 10px;
            color: var(--ralph-pink);
        }
        
        /* Expanded Story Modal */
        .story-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 19000; /* Above all windows, below UI controls */
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .story-modal-content {
            background: #1a1a1a;
            border: 2px solid var(--ralph-pink);
            border-radius: 8px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .story-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--ralph-pink);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
        }
        
        .story-modal-header {
            padding: 20px;
            border-bottom: 1px solid #333;
        }
        
        .story-modal-title {
            font-size: 28px;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
        }
        
        .story-modal-body {
            padding: 20px;
            color: #ccc;
            line-height: 1.6;
        }
        
        .whats-new-dashboard .window-content,
        .new-biz-dashboard .window-content,
        .premieres-dashboard .window-content,
        .challenges-dashboard .window-content,
        .shoutouts-dashboard .window-content,
        .articles-dashboard .window-content,
        .ralph-news-dashboard .window-content,
        .suggestions-dashboard .window-content,
        .announcements-dashboard .window-content,
        .links-dashboard .window-content,
        .innovation-dashboard .window-content,
        .pitch-please-dashboard .window-content,
        .resources-dashboard .window-content {
            background: #000000 !important;
            color: #ffffff !important;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
            padding: 0 !important;
            overflow-y: auto;
        }

        .whats-new-dashboard .window-content::before,
        .new-biz-dashboard .window-content::before,
        .premieres-dashboard .window-content::before,
        .challenges-dashboard .window-content::before,
        .shoutouts-dashboard .window-content::before,
        .articles-dashboard .window-content::before,
        .ralph-news-dashboard .window-content::before,
        .suggestions-dashboard .window-content::before,
        .announcements-dashboard .window-content::before,
        .links-dashboard .window-content::before,
        .innovation-dashboard .window-content::before,
        .pitch-please-dashboard .window-content::before,
        .resources-dashboard .window-content::before {
            display: none !important; /* Remove scan lines */
        }

        .new-biz-dashboard .module-description,
        .premieres-dashboard .module-description,
        .challenges-dashboard .module-description,
        .shoutouts-dashboard .module-description,
        .articles-dashboard .module-description,
        .ralph-news-dashboard .module-description,
        .suggestions-dashboard .module-description,
        .announcements-dashboard .module-description,
        .links-dashboard .module-description,
        .innovation-dashboard .module-description,
        .pitch-please-dashboard .module-description,
        .resources-dashboard .module-description {
            display: none !important; /* Hide duplicate description */
        }

        .whats-new-header,
        .new-biz-header,
        .premieres-header,
        .challenges-header,
        .shoutouts-header,
        .articles-header,
        .ralph-news-header {
            color: white;
            padding: 20px;
            text-align: left;
            position: relative;
        }
        
        /* What's New - Ralph Pink (Homer's donut) */
        .whats-new-header {
            background: linear-gradient(135deg, var(--ralph-pink) 0%, #ff1493 100%);
            padding-left: 110px; /* Make room for headshot on left */
        }
        
        /* New Biz - Ralph Green (Peas to Meet You) - Growth & Money */
        .new-biz-header {
            background: linear-gradient(135deg, var(--ralph-green) 0%, #55c669 100%);
        }
        
        /* Premieres - Ralph Yellow (Spotlight & Shows) */
        .premieres-header {
            background: linear-gradient(135deg, var(--ralph-yellow) 0%, #ffcc11 100%);
            color: #333 !important; /* Dark text for better contrast on yellow */
        }
        
        /* Challenges - Ralph Orange (Carrot Cake Mistake) - Energy & Creativity */
        .challenges-header {
            background: linear-gradient(135deg, var(--ralph-orange) 0%, #ff7635 100%);
        }
        
        /* Shoutouts - Ralph Blue (Me want cookie) - Social & People */
        .shoutouts-header {
            background: linear-gradient(135deg, var(--ralph-blue) 0%, #42cdcf 100%);
        }
        
        /* Articles - Ralph Yellow (Dippy Egg) - Knowledge & Reading */
        .articles-header {
            background: linear-gradient(135deg, var(--ralph-yellow) 0%, #ffcc11 100%);
            color: #333; /* Dark text for better contrast on yellow */
        }
        
        /* Ralph News Network - Ralph Pink (Homer's donut) */
        .ralph-news-header {
            background: linear-gradient(135deg, var(--ralph-pink) 0%, #ff1493 100%);
        }
        
        .header-headshot {
            position: absolute;
            top: 20px;
            left: 20px;
            bottom: 20px;
            width: 70px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            image-rendering: pixelated;
            background: rgba(0, 0, 0, 0.2);
        }

        .challenges-header {
            position: relative;
        }

        .challenges-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .challenges-header-text {
            flex: 1;
        }

        .winners-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.2s;
            white-space: nowrap;
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .winners-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .whats-new-title,
        .new-biz-title,
        .premieres-title,
        .challenges-title,
        .shoutouts-title,
        .ralph-news-title {
            font-size: 26px;
            font-weight: 600;
            margin: 0;
            font-family: 'Space Mono', monospace;
            text-transform: none;
            letter-spacing: 0.5px;
        }

        .whats-new-subtitle,
        .new-biz-subtitle,
        .premieres-subtitle,
        .challenges-subtitle,
        .shoutouts-subtitle,
        .ralph-news-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 6px;
            font-weight: 400;
            font-family: 'Courier Prime', monospace;
        }
        
        .whats-new-dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: auto auto;
            gap: 16px;
            padding: 16px;
            height: calc(100% - 120px);
            background: #000000;
        }

        .dashboard-card-wide {
            grid-column: span 2;
        }

        .dashboard-card {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            transition: all 0.3s ease;
        }

        .dashboard-card:hover {
            border-color: var(--ralph-pink);
        }

        .dashboard-card h3 {
            color: var(--ralph-pink);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 14px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .dashboard-card-content {
            color: #e0e0e0;
            line-height: 1.5;
            font-size: 13px;
        }

        .dashboard-item {
            padding: 12px 0;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: all 0.2s;
        }

        .dashboard-item:last-child {
            border-bottom: none;
        }

        .dashboard-item:hover {
            color: var(--ralph-pink);
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .stat-item {
            text-align: center;
            padding: 16px;
            background: #2a2a2a;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 28px;
            font-weight: 700;
            color: var(--ralph-pink);
            display: block;
        }

        .stat-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 4px;
        }

        .pipeline-progress {
            width: 100%;
            height: 6px;
            background: #333;
            border-radius: 3px;
            margin: 8px 0;
            overflow: hidden;
        }

        .pipeline-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ralph-green), #55c669);
            transition: width 0.3s ease;
        }

        .badge-new {
            background: var(--terminal-yellow);
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-active {
            background: var(--ralph-green);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 6px;
        }

        .badge-dev {
            background: var(--ralph-yellow);
            color: #333;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 6px;
        }

        .badge-beta {
            background: var(--ralph-orange);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 6px;
        }

        .badge-urgent {
            background: #ff4444;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        /* New Biz Dashboard Specific Styles */
        .new-biz-horizontal-layout {
            display: flex;
            flex-direction: column;
            height: calc(100% - 120px);
            background: #000000;
            padding: 16px;
            gap: 16px;
        }

        .pipeline-columns {
            display: flex;
            gap: 12px;
            flex: 1;
            overflow-x: auto;
            min-height: 0;
        }

        .pipeline-stage-column {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            transition: all 0.3s ease;
            min-width: 200px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .pipeline-stage-column:hover {
            border-color: var(--ralph-green);
        }

        .pipeline-stage-column h3 {
            color: var(--ralph-green);
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 14px 0;
            display: flex;
            align-items: center;
            gap: 6px;
            text-align: center;
            justify-content: center;
        }

        .pipeline-stage-items {
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }

        .pipeline-expanded-item {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            border: 1px solid #444;
            transition: all 0.2s ease;
        }

        .pipeline-expanded-item:hover {
            border-color: var(--ralph-pink);
            background: #333;
        }

        .pipeline-expanded-item .project-name {
            color: #ffffff;
            font-weight: 600;
            font-size: 13px;
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .pipeline-expanded-item .project-office {
            display: inline-block;
            background: var(--ralph-green);
            color: white;
            padding: 2px 5px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            margin-bottom: 6px;
        }

        .pipeline-expanded-item .project-due {
            color: #aaa;
            font-size: 11px;
            margin-bottom: 8px;
        }

        .pipeline-expanded-item .project-links {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .pipeline-expanded-item .project-link {
            background: #444;
            color: white;
            padding: 3px 6px;
            border-radius: 3px;
            text-decoration: none;
            font-size: 10px;
            transition: background 0.2s;
        }

        .pipeline-expanded-item .project-link:hover {
            background: var(--ralph-pink);
        }

        .pipeline-contact-section,
        .innovation-contact-section {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            flex-shrink: 0;
            display: flex;
            gap: 16px;
            align-items: stretch;
        }
        
        .contact-headshot {
            width: 100px;
            height: 100px;
            border-radius: 8px;
            border: 2px solid var(--ralph-green);
            image-rendering: pixelated;
            background: #333;
            flex-shrink: 0;
            align-self: center;
        }
        
        .contact-content {
            flex: 1;
        }

        .pipeline-contact-section h3,
        .innovation-contact-section h3 {
            color: var(--ralph-green);
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 12px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .innovation-experiments-section h3,
        .innovation-events-section h3 {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            margin: 0 0 16px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .contact-form-horizontal {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .contact-form-horizontal textarea {
            flex: 1;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 12px;
            color: white;
            font-family: inherit;
            resize: none;
            min-height: 60px;
        }

        .contact-form-horizontal textarea:focus {
            outline: none;
            border-color: var(--ralph-pink);
        }

        .contact-btn {
            background: var(--ralph-green);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
            white-space: nowrap;
        }

        .contact-btn:hover {
            background: #ff1493;
        }

        /* Premiere Calendar Specific Styles */
        .premieres-content {
            display: flex;
            flex-direction: column;
            height: calc(100% - 120px);
            background: #000000;
            padding: 16px;
            gap: 16px;
        }

        .premieres-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            flex: 1;
        }

        .premiere-card {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .premiere-card:hover {
            border-color: var(--ralph-pink);
        }

        .premiere-card h3 {
            color: var(--ralph-yellow);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 14px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .premiere-items {
            flex: 1;
            overflow-y: auto;
        }

        .premiere-item {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid #444;
            transition: all 0.2s ease;
        }

        .premiere-item:hover {
            border-color: var(--ralph-pink);
            background: #333;
        }

        .premiere-date {
            color: var(--ralph-yellow);
            font-weight: 600;
            font-size: 12px;
            margin-bottom: 4px;
        }

        .premiere-title {
            color: #ffffff;
            font-size: 14px;
            line-height: 1.3;
        }

        .premiere-add-section {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            flex-shrink: 0;
        }

        .premiere-add-section h3 {
            color: var(--ralph-yellow);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 12px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .premiere-form {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .premiere-form input {
            background: #2a2a2a !important;
            border: 1px solid #444 !important;
            border-radius: 6px;
            padding: 8px 12px;
            color: white !important;
            font-family: inherit;
            font-size: 13px;
        }

        .premiere-form input[type="date"] {
            flex: 0 0 150px;
        }

        .premiere-form input[type="text"] {
            flex: 1;
        }

        .premiere-form input[type="url"] {
            flex: 0 0 200px;
        }

        .premiere-form input:focus {
            outline: none;
            border-color: var(--ralph-pink);
        }

        .premiere-form input::placeholder {
            color: #888 !important;
            opacity: 1;
        }

        .premiere-btn {
            background: var(--ralph-yellow);
            color: #333;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
            white-space: nowrap;
        }

        .premiere-btn:hover {
            background: #ff1493;
        }

        /* Challenges Dashboard Specific Styles */
        .challenges-content {
            display: flex;
            flex-direction: column;
            height: calc(100% - 120px);
            background: #000000;
            padding: 16px;
        }

        .challenge-tabs {
            display: flex;
            gap: 2px;
            margin-bottom: 16px;
            flex-shrink: 0;
        }

        .challenge-tab {
            background: #333;
            color: #ccc;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
            border-radius: 8px 8px 0 0;
        }

        .challenge-tab:hover {
            background: #444;
            color: white;
        }

        .challenge-tab.active {
            background: var(--ralph-orange);
            color: white;
        }

        .challenge-tab-content {
            flex: 1;
            background: #1a1a1a;
            border-radius: 0 0 12px 12px;
            padding: 20px;
            border: 1px solid #333;
            overflow-y: auto;
        }

        .challenge-panel {
            display: none;
            height: 100%;
        }

        .challenge-panel.active {
            display: block;
        }

        .current-challenge-card {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #444;
            margin-bottom: 16px;
        }

        .challenge-month {
            color: var(--ralph-orange);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            text-align: center;
        }

        .challenge-theme {
            color: #ffffff;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 16px;
        }

        .challenge-description {
            color: #ccc;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 16px;
            text-align: center;
        }

        .challenge-prize {
            background: #333;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            color: var(--ralph-orange);
            font-weight: 600;
        }

        .winners-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .winner-card {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 16px;
            border: 1px solid #444;
        }

        .winner-name {
            color: var(--ralph-orange);
            font-weight: 600;
            margin-bottom: 4px;
        }

        .winner-concept {
            color: #ccc;
            font-size: 14px;
        }

        .submit-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-width: 500px;
            margin: 0 auto;
        }

        .submit-form input,
        .submit-form textarea {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 12px;
            color: white;
            font-family: inherit;
        }

        .submit-form input:focus,
        .submit-form textarea:focus {
            outline: none;
            border-color: var(--ralph-pink);
        }

        .submit-form textarea {
            resize: vertical;
            min-height: 80px;
        }

        .submit-btn {
            background: var(--ralph-orange);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }

        .submit-btn:hover {
            background: #ff1493;
        }

        .accept-challenge-btn {
            background: var(--ralph-orange);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
            margin-top: 16px;
            width: 100%;
        }

        .accept-challenge-btn:hover {
            background: #ff1493;
        }

        /* Shoutouts Dashboard Specific Styles */
        .shoutouts-content {
            display: flex;
            flex-direction: column;
            height: calc(100% - 120px);
            background: #000000;
            padding: 16px;
            gap: 16px;
        }

        .shoutouts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            flex: 1;
        }

        .shoutout-card {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .shoutout-card:hover {
            border-color: var(--ralph-pink);
        }

        .shoutout-card h3 {
            color: var(--ralph-blue);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 14px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .shoutout-items {
            flex: 1;
            overflow-y: auto;
        }

        .shoutout-item {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid #444;
            transition: all 0.2s ease;
        }

        .shoutout-item:hover {
            border-color: var(--ralph-pink);
            background: #333;
        }

        .shoutout-item.highlight {
            border-color: var(--ralph-pink);
            background: #2a1a1a;
        }

        .birthday-item,
        .anniversary-item {
            color: #ffffff;
            font-size: 14px;
            line-height: 1.3;
        }

        .shoutout-message {
            color: #ccc;
            font-size: 13px;
            line-height: 1.4;
            font-style: italic;
            margin-bottom: 6px;
        }

        .shoutout-author {
            color: var(--ralph-blue);
            font-size: 12px;
            font-weight: 600;
        }

        .shoutout-send-section {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            border: 1px solid #333;
            flex-shrink: 0;
        }

        .shoutout-send-section h3 {
            color: var(--ralph-blue);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 12px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .shoutout-form {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .shoutout-form input {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 8px 12px;
            color: white;
            font-family: inherit;
            font-size: 13px;
            flex: 0 0 150px;
        }

        .shoutout-form textarea {
            flex: 1;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 8px 12px;
            color: white;
            font-family: inherit;
            resize: none;
            min-height: 40px;
        }

        .shoutout-form input:focus,
        .shoutout-form textarea:focus {
            outline: none;
            border-color: var(--ralph-pink);
        }

        .shoutout-btn {
            background: var(--ralph-blue);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
            white-space: nowrap;
        }

        .shoutout-btn:hover {
            background: #ff1493;
        }
        
        .window {
            position: absolute;
            background: var(--window-bg);
            border: 2px solid;
            border-color: var(--white) var(--black) var(--black) var(--white);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
            display: none;
            min-width: 300px;
            min-height: 200px;
            max-width: 90vw;
            max-height: 85vh;
        }
        
        .window.active {
            display: block;
        }
        
        .window-header {
            background: linear-gradient(90deg, #000080, var(--ralph-pink));
            color: white;
            padding: 3px;
            display: flex;
            align-items: center;
            font-size: 16px;
            cursor: move;
            touch-action: none;
            position: relative;
        }
        
        
        .window-title {
            flex: 1;
            padding: 0 8px;
            font-family: 'Space Mono', monospace;
            font-weight: 700;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            line-height: 1.2;
        }
        
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .window-button {
            width: 20px;
            height: 20px;
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--black) var(--black) var(--white);
            font-family: 'VT323', monospace;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .window-button:active {
            border-color: var(--black) var(--white) var(--white) var(--black);
        }
        
        .window-content {
            padding: 12px;
            background: var(--white);
            margin: 4px;
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            height: calc(100% - 40px);
            overflow-y: auto;
            overflow-x: hidden;
            font-size: 14px;
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            line-height: 1.5;
        }
        
        /* Pipeline Layout Styles */
        .pipeline-container {
            display: flex;
            height: 100%;
            min-width: 800px;
            padding: 15px;
            gap: 2px;
            background: var(--gray-dark);
        }
        
        .pipeline-column {
            flex: 1;
            min-width: 180px;
            display: flex;
            flex-direction: column;
            border: 2px inset var(--gray-light);
            background: var(--window-bg);
        }
        
        .pipeline-header {
            padding: 8px 10px;
            text-align: center;
            font-weight: bold;
            font-size: 11px;
            letter-spacing: 0.5px;
            border-bottom: 2px inset var(--gray-dark);
        }
        
        .pipeline-header h3 {
            margin: 0;
            color: var(--black);
        }
        
        .pipeline-header .count {
            color: var(--gray-dark);
            font-weight: normal;
        }
        
        .pipeline-items {
            flex: 1;
            padding: 8px;
            overflow-y: auto;
        }
        
        .pipeline-item {
            background: var(--white);
            border: 1px outset var(--gray-light);
            margin-bottom: 8px;
            padding: 8px;
            font-size: 11px;
            line-height: 1.3;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .pipeline-item:hover {
            border: 1px inset var(--gray-dark);
            background: #f5f5f5;
        }
        
        .pipeline-item .client-name {
            font-weight: bold;
            margin-bottom: 4px;
            color: var(--black);
        }
        
        .pipeline-item .due-date {
            color: var(--gray-dark);
            font-size: 10px;
            margin-bottom: 4px;
        }
        
        .pipeline-item .office {
            display: inline-block;
            background: var(--gray-dark);
            color: var(--white);
            padding: 1px 4px;
            font-size: 9px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .pipeline-item .links {
            display: flex;
            gap: 4px;
            margin-top: 4px;
        }
        
        .pipeline-item .link-btn {
            background: var(--ralph-pink);
            color: var(--white);
            border: 1px outset var(--ralph-pink);
            padding: 2px 6px;
            font-size: 9px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        
        .pipeline-item .link-btn:hover {
            border: 1px inset var(--ralph-pink);
        }
        
        /* Column-specific colors */
        .warm-leads .pipeline-header { background: #ff6b6b; color: white; }
        .pitches-happening .pipeline-header { background: #ff9f43; color: white; }
        .pitch-submitted .pipeline-header { background: #feca57; color: black; }
        .pitch-presented .pipeline-header { background: #48ca9c; color: white; }
        .pitch-won .pipeline-header { background: #54a0ff; color: white; }
        
        .module-item {
            background: #f0f0f0;
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            padding: 8px;
            margin-bottom: 8px;
        }
        
        .module-item h3 {
            color: var(--ralph-pink);
            font-size: 16px;
            font-family: 'Space Mono', monospace;
            font-weight: 700;
            margin-bottom: 8px;
            border-bottom: 2px dotted var(--ralph-pink);
            padding-bottom: 4px;
            line-height: 1.3;
        }
        
        .progress-bar {
            background: var(--gray-dark);
            border: 2px solid;
            border-color: var(--black) var(--white) var(--white) var(--black);
            height: 20px;
            position: relative;
            margin: 8px 0;
        }
        
        .progress-fill {
            background: repeating-linear-gradient(
                90deg,
                var(--ralph-pink),
                var(--ralph-pink) 10px,
                var(--ralph-pink-light) 10px,
                var(--ralph-pink-light) 20px
            );
            height: 100%;
            transition: width 0.3s;
        }
        
        .pixel-button {
            background: var(--gray-light);
            border: 2px solid;
            border-color: var(--white) var(--gray-dark) var(--gray-dark) var(--white);
            padding: 6px 12px;
            font-family: 'Space Mono', monospace;
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
            margin: 4px;
            touch-action: manipulation;
            line-height: 1.2;
        }
        
        .pixel-button:hover, .pixel-button:active {
            background: var(--ralph-pink);
            color: white;
        }
        
        .pixel-button:active {
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
        }
        
        .blink {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .ascii-art {
            font-size: 12px;
            line-height: 1;
            font-family: 'Courier Prime', monospace;
            color: var(--ralph-pink);
            white-space: pre;
            margin: 8px 0;
        }
        
        input[type="text"], textarea {
            background: var(--white);
            border: 2px solid;
            border-color: var(--gray-dark) var(--white) var(--white) var(--gray-dark);
            padding: 6px;
            font-family: 'Space Mono', monospace;
            font-size: 14px;
            font-weight: 400;
            width: 100%;
            margin: 4px 0;
            line-height: 1.4;
        }
        
        .scanlines::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                transparent 50%,
                rgba(0, 0, 0, 0.1) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
        }
        
        .crt-flicker {
            animation: none;
        }
        
        .boot-screen.login-mode .boot-logo {
            animation: flicker 0.1s infinite !important;
        }
        
        .boot-screen.login-mode .login-prompt.typed-complete,
        .boot-screen.login-mode .login-input.revealed,
        .boot-screen.login-mode .login-btn.revealed {
            animation: green-flicker 0.2s infinite;
        }
        
        @keyframes green-flicker {
            0% { opacity: 0.9; }
            33% { opacity: 1; }
            66% { opacity: 0.95; }
            100% { opacity: 0.92; }
        }
        
        @keyframes flicker {
            0% { opacity: 0.9; }
            10% { opacity: 1; }
            20% { opacity: 0.88; }
            30% { opacity: 1; }
            40% { opacity: 0.92; }
            50% { opacity: 1; }
            60% { opacity: 0.85; }
            70% { opacity: 1; }
            80% { opacity: 0.93; }
            90% { opacity: 1; }
            100% { opacity: 0.87; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--terminal-yellow);
            border: 2px solid var(--black);
            padding: 12px;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
            font-size: 14px;
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            z-index: 20003; /* Above all windows and UI elements */
            display: none;
            max-width: 300px;
            line-height: 1.4;
        }
        
        .notification.show {
            display: block;
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--black);
            color: var(--terminal-green);
            font-family: 'VT323', monospace;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s;
            padding: 20px;
        }
        
        .boot-screen.hide {
            opacity: 0;
            pointer-events: none;
        }
        
        .login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            justify-content: center; /* Center vertically in viewport */
            height: 100vh; /* Full viewport height */
            padding: 0; /* Remove top padding, let flexbox center it */
        }
        
        .boot-sequence {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 20px; /* Match login-screen gap to prevent jump */
            justify-content: center; /* Center vertically */
            height: 100vh; /* Full viewport height */
            position: absolute; /* Position relative to boot-screen */
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 10px; /* Reduced vertical spacing */
            align-items: flex-start; /* Left align everything */
            margin-top: 20px; /* Match ASCII spacing */
            width: 400px; /* Fixed width for consistent alignment */
        }
        
        .login-input {
            background: black !important;
            border: 2px solid var(--terminal-green) !important;
            color: var(--terminal-green) !important;
            opacity: 0 !important; /* Force hidden initially */
            display: none !important; /* Double protection - completely hidden */
            font-family: 'Courier New', 'Courier', monospace !important;
            font-size: 18px !important;
            padding: 8px 12px !important;
            min-width: 300px;
            text-align: left;
            outline: none !important;
            border-radius: 0 !important;
            -webkit-box-shadow: 0 0 0px 1000px black inset !important;
            box-shadow: 0 0 0px 1000px black inset !important;
            -webkit-text-fill-color: var(--terminal-green) !important;
        }
        
        .login-input:-webkit-autofill,
        .login-input:-webkit-autofill:hover,
        .login-input:-webkit-autofill:focus,
        .login-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0px 1000px black inset !important;
            box-shadow: 0 0 0px 1000px black inset !important;
            -webkit-text-fill-color: var(--terminal-green) !important;
            background-color: black !important;
            color: var(--terminal-green) !important;
        }
        
        .login-input::placeholder {
            color: rgba(0, 255, 0, 0.5) !important;
        }
        
        .login-input:focus {
            border-color: #00ff00;
            box-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }
        
        .login-prompt {
            color: var(--terminal-green);
            font-size: 18px;
            text-align: left;
            margin-bottom: 5px;
            font-family: 'Courier New', 'Courier', monospace;
        }
        
        .login-btn {
            background: transparent;
            border: 1px solid var(--terminal-green);
            color: var(--terminal-green);
            opacity: 0 !important; /* Force hidden initially */
            display: none !important; /* Double protection - completely hidden */
            font-family: 'Courier New', 'Courier', monospace;
            font-size: 16px;
            padding: 8px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 20px;
        }
        
        .login-btn:hover {
            background: var(--terminal-green);
            color: black;
        }

        /* Show inputs and button only when revealed with blink effect */
        .login-input.revealed {
            display: block !important;
            opacity: 1 !important;
            animation: terminalBlink 0.6s ease-out !important;
        }

        .login-btn.revealed {
            display: block !important;
            opacity: 1 !important;
            animation: terminalBlink 0.6s ease-out !important;
        }

        @keyframes terminalBlink {
            0% { 
                opacity: 0;
                filter: brightness(0);
            }
            15% {
                opacity: 0.3;
                filter: brightness(0.5);
            }
            30% {
                opacity: 0;
                filter: brightness(0);
            }
            45% {
                opacity: 0.7;
                filter: brightness(1.2);
            }
            60% {
                opacity: 0.2;
                filter: brightness(0.3);
            }
            75% {
                opacity: 1;
                filter: brightness(1);
            }
            90% {
                opacity: 0.9;
                filter: brightness(0.95);
            }
            100% { 
                opacity: 1;
                filter: brightness(1);
            }
        }
        
        .login-field {
            margin-bottom: 5px; /* Reduced spacing between label and input */
            text-align: left;
        }
        
        .login-spinner {
            display: inline-block;
            color: var(--terminal-green);
            font-family: 'Courier New', 'Courier', monospace;
            font-size: 16px;
            margin-left: 10px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { content: '|'; }
            25% { content: '/'; }
            50% { content: '-'; }
            75% { content: '\\'; }
            100% { content: '|'; }
        }
        
        .login-spinner::before {
            content: '|';
            animation: spinner-chars 1s linear infinite;
        }
        
        @keyframes spinner-chars {
            0% { content: '|'; }
            25% { content: '/'; }
            50% { content: '-'; }
            75% { content: '\\'; }
            100% { content: '|'; }
        }
        
        .typing-text {
            overflow: hidden;
            white-space: nowrap;
            width: 0;
            opacity: 0;
            text-align: left;
        }
        
        .typing-text.active {
            animation: typing 0.4s steps(30, end) forwards;
        }
        
        @keyframes typing {
            0% { 
                width: 0; 
                opacity: 1;
            }
            100% { 
                width: 100%; 
                opacity: 1;
            }
        }
        
        .boot-logo {
            font-size: 8px;
            line-height: 0.5;
            color: var(--ralph-pink);
            white-space: pre;
            margin-bottom: 20px; /* Reduced gap */
            text-shadow: 0 0 10px var(--ralph-pink);
            overflow: hidden;
            max-width: 100%;
            opacity: 0; /* Start hidden for login fade-in effect */
            font-family: 'Courier New', monospace;
            image-rendering: pixelated;
            text-rendering: optimizeSpeed;
        }
        
        
        .boot-text {
            color: var(--terminal-green);
            font-size: 16px;
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.4;
        }
        
        .loading-bar-container {
            width: 90%;
            max-width: 400px;
            height: 30px;
            border: 2px solid var(--terminal-green);
            background: var(--black);
            position: relative;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }
        
        .loading-bar {
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                var(--ralph-pink),
                var(--ralph-pink) 10px,
                var(--ralph-pink-light) 10px,
                var(--ralph-pink-light) 20px
            );
            width: 0%;
            transition: width 0.3s;
        }
        
        .loading-percentage {
            position: absolute;
            right: -50px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--terminal-green);
            font-size: 18px;
        }
        
        .boot-messages {
            margin-top: 30px;
            height: 100px;
            overflow: hidden;
            font-size: 13px;
            font-family: 'Space Mono', monospace;
            font-weight: 400;
            color: var(--terminal-green);
            text-align: left;
            width: 90%;
            max-width: 500px;
            line-height: 1.4;
        }
        
        .boot-message {
            margin: 2px 0;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        /* Mobile Responsive Styles */
        @media screen and (max-width: 768px) {
            body {
                overflow-y: auto;
                overflow-x: hidden;
                position: relative;
            }
            
            .desktop {
                min-height: 100vh;
                height: auto;
                overflow-y: auto;
                overflow-x: hidden;
            }
            
            .desktop-ascii {
                font-size: 8px;
                line-height: 0.54;
                top: 10px;
                left: 10px;
            }
            
            .desktop-icons {
                position: relative;
                right: auto;
                top: auto;
                padding: 120px 20px 60px 20px;
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                grid-auto-rows: 90px;
                gap: 10px;
                height: auto;
                width: 100%;
                overflow: visible;
            }
            
            .icon {
                padding: 4px;
            }
            
            .icon-image {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .icon-label {
                font-size: 12px;
            }
            
            .window {
                position: fixed !important;
                top: 10px !important;
                left: 10px !important;
                right: 10px !important;
                bottom: 50px !important;
                width: auto !important;
                height: auto !important;
                max-width: none;
                max-height: none;
                z-index: 900;
            }
            
            .window-header {
                touch-action: none;
                padding: 5px;
            }
            
            .window-title {
                font-size: 14px;
            }
            
            .window-button {
                width: 30px;
                height: 30px;
                font-size: 18px;
            }
            
            .window-content {
                font-size: 13px;
                padding: 8px;
            }
            
            .module-item h3 {
                font-size: 15px;
            }
            
            .pixel-button {
                font-size: 13px;
                padding: 10px 12px;
            }
            
            .notification {
                left: 10px;
                top: 10px;
                font-size: 14px;
                max-width: calc(100vw - 40px);
            }
            
            .boot-logo {
                font-size: 4px;
                line-height: 0.6;
            }
            
            .boot-text {
                font-size: 14px;
            }
            
            .loading-percentage {
                right: -40px;
                font-size: 14px;
            }
            
            .boot-messages {
                font-size: 12px;
            }
            
            input[type="text"], textarea {
                font-size: 14px;
                padding: 8px;
            }
            
            /* Hide scanlines on mobile for performance */
            .scanlines::before {
                display: none;
            }
            
            /* Simplify animations on mobile */
            .crt-flicker {
                animation: none;
            }
        }
        
        /* Small mobile devices */
        @media screen and (max-width: 480px) {
            .desktop-ascii {
                font-size: 6px;
                line-height: 0.48;
            }
            
            .desktop-icons {
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
                grid-auto-rows: 80px;
                padding: 100px 10px 60px 10px;
            }
            
            .icon-image {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }
            
            .icon-label {
                font-size: 11px;
            }
            
            .boot-logo {
                font-size: 3px;
                line-height: 0.45;
            }
        }
        
        /* Landscape mobile */
        @media screen and (max-width: 768px) and (orientation: landscape) {
            .desktop-icons {
                padding: 80px 20px 60px 20px;
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
                grid-auto-rows: 70px;
            }
            
            .desktop-ascii {
                font-size: 6px;
                line-height: 0.36;
            }
            
            .window {
                top: 5px !important;
                bottom: 45px !important;
            }
        }
        
        /* Banner popup styles - 8-bit style */
        .banner-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 480px;
            max-width: 90vw;
            background: 
                repeating-linear-gradient(
                    0deg,
                    #ff00ff 0px,
                    #ff00ff 4px,
                    #00ffff 4px,
                    #00ffff 8px,
                    #ffff00 8px,
                    #ffff00 12px,
                    #ff0000 12px,
                    #ff0000 16px
                );
            border: 4px solid var(--black);
            box-shadow: 
                0 0 0 2px var(--white),
                0 0 0 6px var(--black),
                8px 8px 0 var(--black);
            z-index: 9999;
            font-family: 'VT323', monospace;
            animation: pixelBounce 0.6s steps(4, end);
            display: none;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        .banner-popup.show {
            display: block;
        }
        
        @keyframes pixelBounce {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }
            25% {
                transform: translate(-50%, -50%) scale(0.5);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
            }
            75% {
                transform: translate(-50%, -50%) scale(0.8);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        .banner-header {
            background: 
                repeating-linear-gradient(
                    90deg,
                    var(--black) 0px,
                    var(--black) 2px,
                    var(--ralph-pink) 2px,
                    var(--ralph-pink) 4px
                );
            color: var(--white);
            padding: 12px 16px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            text-shadow: 2px 2px 0 var(--black);
            position: relative;
            border-bottom: 4px solid var(--black);
        }
        
        .banner-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--terminal-green);
            animation: scanline 1s linear infinite;
        }
        
        @keyframes scanline {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        .banner-content {
            padding: 20px;
            background: var(--white);
            color: var(--black);
            font-size: 16px;
            line-height: 1.2;
            text-align: center;
            border: 2px inset var(--gray-light);
        }
        
        .banner-text {
            margin-bottom: 16px;
            font-weight: bold;
            text-shadow: 1px 1px 0 var(--gray-light);
        }
        
        .banner-highlight {
            color: var(--ralph-pink);
            font-weight: bold;
            text-shadow: 1px 1px 0 var(--black);
            background: var(--terminal-yellow);
            padding: 2px 4px;
            border: 1px solid var(--black);
        }
        
        .banner-close {
            background: var(--ralph-pink);
            color: var(--white);
            border: 4px outset var(--ralph-pink);
            padding: 12px 20px;
            font-family: 'VT323', monospace;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            text-shadow: 1px 1px 0 var(--black);
            box-shadow: 4px 4px 0 var(--black);
            transition: none;
        }
        
        .banner-close:hover {
            background: var(--terminal-green);
            border-color: var(--terminal-green);
        }
        
        .banner-close:active {
            border: 4px inset var(--ralph-pink);
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 var(--black);
        }
        
        /* Suggestion Box Module Styles */
        .suggestions-header,
        .announcements-header,
        .links-header,
        .innovation-header,
        .resources-header {
            color: white;
            padding: 20px;
            text-align: left;
            position: relative;
        }
        
        /* Dashboard content styling for new modules */
        .suggestions-dashboard .dashboard-content,
        .announcements-dashboard .dashboard-content,
        .links-dashboard .dashboard-content,
        .innovation-dashboard .dashboard-content,
        .resources-dashboard .dashboard-content {
            padding: 16px;
            background: #000000;
            color: #ffffff;
            overflow-y: auto;
            height: calc(100% - 120px);
        }
        
        /* Suggestion Box - Ralph Pink */
        .suggestions-header {
            background: linear-gradient(135deg, var(--ralph-pink) 0%, #ff1493 100%);
        }
        
        /* Announcements - Ralph Orange (Alert/Notice theme) */
        .announcements-header {
            background: linear-gradient(135deg, var(--ralph-orange) 0%, #ff7635 100%);
        }
        
        /* Quick Links - Ralph Blue (Connection theme) */
        .links-header {
            background: linear-gradient(135deg, var(--ralph-blue) 0%, #42cdcf 100%);
        }
        
        /* Innovation - Ralph Green (Growth/Future theme) */
        .innovation-header {
            background: linear-gradient(135deg, var(--ralph-green) 0%, #55c669 100%);
            position: relative;
        }
        
        /* Pitch Please - Ralph Pink (Creative/Competition theme) */
        .pitch-please-header {
            background: linear-gradient(135deg, var(--ralph-pink) 0%, #ff1493 100%);
            position: relative;
            color: white;
            padding: 20px;
            text-align: left;
        }

        .pitch-please-title {
            font-size: 26px;
            font-weight: bold;
            margin: 0;
            font-family: 'Space Mono', monospace;
            font-style: italic;
            text-transform: none;
            letter-spacing: 0.5px;
            color: var(--ralph-yellow);
        }

        .pitch-please-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 6px;
            font-weight: 400;
            font-family: 'Courier Prime', monospace;
            color: white;
        }

        .pitch-please-overview {
            padding: 20px;
            background: #1a1a1a;
            margin: 20px;
            border-radius: 8px;
        }

        .pitch-types-intro {
            text-align: center;
            margin-bottom: 25px;
        }

        .pitch-types-intro p {
            font-size: 15px;
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .pitch-types-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .pitch-type {
            color: var(--ralph-yellow);
            font-size: 14px;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
            position: relative;
        }

        .pitch-type::after {
            content: "‚Ä¢";
            color: var(--ralph-pink);
            margin-left: 8px;
        }

        .pitch-type:last-child::after {
            display: none;
        }

        .pitch-type-highlight {
            background: linear-gradient(135deg, var(--ralph-pink), #ff1493);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            font-style: italic;
            margin-top: 15px;
            box-shadow: 0 4px 15px rgba(235, 0, 139, 0.3);
        }

        .pitch-please-sections {
            padding: 0 20px 20px;
        }

        .pitch-section {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .pitch-section h3 {
            color: var(--ralph-pink);
            font-family: 'Space Mono', monospace;
            font-size: 18px;
            margin: 0 0 15px 0;
            font-weight: 600;
        }

        .pitch-benefits {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .benefit-group h4 {
            color: white;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            font-family: 'Inter', sans-serif;
        }

        .benefit-group ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .benefit-group li {
            color: #ccc;
            font-size: 13px;
            margin-bottom: 6px;
            padding-left: 15px;
            position: relative;
        }

        .benefit-group li::before {
            content: "‚Üí";
            color: var(--ralph-pink);
            position: absolute;
            left: 0;
        }

        .pitch-form {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
        }

        .form-section {
            margin-bottom: 25px;
        }

        .form-section h4 {
            color: var(--ralph-pink);
            font-family: 'Space Mono', monospace;
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            color: white;
            font-size: 13px;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #444;
            border-radius: 6px;
            background: #2a2a2a;
            color: white;
            font-size: 13px;
            font-family: 'Inter', sans-serif;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: var(--ralph-pink);
            outline: none;
            box-shadow: 0 0 0 2px rgba(235, 0, 139, 0.2);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            justify-content: flex-end;
        }

        .btn-pitch-submit,
        .btn-pitch-draft {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-pitch-submit {
            background: var(--ralph-pink);
            color: white;
        }

        .btn-pitch-submit:hover {
            background: #d6007a;
            transform: translateY(-1px);
        }

        .btn-pitch-draft {
            background: #444;
            color: white;
        }

        .btn-pitch-draft:hover {
            background: #555;
        }

        /* Competition Status Styling */
        .current-competition {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .competition-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .status-badge {
            background: var(--ralph-green);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .deadline {
            color: var(--ralph-yellow);
            font-weight: 600;
            font-size: 14px;
        }

        .competition-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .stat {
            text-align: center;
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: var(--ralph-pink);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #ccc;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Fix checkbox styling */
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 15px;
            background: #2a2a2a;
            padding: 12px;
            border-radius: 6px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            margin: 0;
        }

        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin-right: 10px;
            accent-color: var(--ralph-pink);
        }

        /* HOW IT WORKS styling */
        .pitch-process {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .pitch-process li {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
            counter-increment: step-counter;
        }

        .pitch-process li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            color: var(--ralph-pink);
            font-weight: bold;
            background: var(--ralph-pink);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .pitch-process {
            counter-reset: step-counter;
        }

        /* Ralph Greenlight Gauntlet styling */
        .gauntlet-intro {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 15px;
            font-style: italic;
        }

        .gauntlet-criteria {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .criteria-item {
            color: #ccc;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 8px;
            padding-left: 5px;
        }

        .criteria-item::first-letter {
            color: var(--ralph-green);
            font-weight: bold;
            font-size: 14px;
        }

        /* Resources - Ralph Orange (Knowledge/Foundation theme) */
        .resources-header {
            background: linear-gradient(135deg, var(--ralph-orange) 0%, #ff7635 100%);
        }
        
        .suggestions-title,
        .announcements-title,
        .links-title,
        .innovation-title,
        .resources-title {
            font-size: 26px;
            font-weight: 600;
            margin: 0;
            font-family: 'Space Mono', monospace;
            text-transform: none;
            letter-spacing: 0.5px;
        }
        
        .suggestions-subtitle,
        .announcements-subtitle,
        .links-subtitle,
        .innovation-subtitle,
        .resources-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 6px;
            font-weight: 400;
            font-family: 'Courier Prime', monospace;
        }
        
        /* Suggestion Form */
        .suggestion-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .suggestion-input,
        .suggestion-select,
        .suggestion-textarea {
            background: #2a2a2a;
            border: 1px solid #444;
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-family: inherit;
        }
        
        .suggestion-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .suggestion-btn {
            background: var(--ralph-pink);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .suggestion-btn:hover {
            background: #ff1493;
        }
        
        /* Suggestions List */
        .suggestions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .suggestion-item {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .suggestion-content h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-pink);
            font-size: 16px;
        }
        
        .suggestion-content p {
            margin: 0 0 10px 0;
            color: #ccc;
            line-height: 1.4;
        }
        
        .suggestion-meta {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #888;
        }
        
        .suggestion-status {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .suggestion-status.approved {
            background: #2d5a3d;
            color: #4ade80;
        }
        
        .suggestion-status.reviewing {
            background: #4a3c1d;
            color: #fbbf24;
        }
        
        .suggestion-status.considering {
            background: #3c4a5d;
            color: #60a5fa;
        }
        
        /* Announcements */
        .announcements-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .announcement-item {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .announcement-item.urgent {
            border-color: var(--ralph-orange);
            background: rgba(241, 101, 36, 0.1);
        }
        
        .announcement-badge {
            background: var(--ralph-orange);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .announcement-content h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-orange);
            font-size: 16px;
        }
        
        .announcement-content p {
            margin: 0 0 10px 0;
            color: #ccc;
            line-height: 1.4;
        }
        
        .announcement-meta {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #888;
        }
        
        /* Links */
        .link-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .link-input,
        .link-select,
        .link-textarea {
            background: #2a2a2a;
            border: 1px solid #444;
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-family: inherit;
        }
        
        .link-textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .link-btn {
            background: var(--ralph-blue);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .link-btn:hover {
            background: #42cdcf;
        }
        
        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .link-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .link-card:hover {
            border-color: var(--ralph-blue);
            transform: translateY(-2px);
        }
        
        .link-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .link-card h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-blue);
            font-size: 16px;
        }
        
        .link-card p {
            margin: 0 0 15px 0;
            color: #ccc;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .link-card-btn {
            background: var(--ralph-blue);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .link-card-btn:hover {
            background: #42cdcf;
        }
        
        /* Innovation */
        .experiments-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .experiment-item {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .experiment-content h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-green);
            font-size: 16px;
        }
        
        .experiment-content p {
            margin: 0 0 12px 0;
            color: #ccc;
            line-height: 1.4;
        }
        
        .experiment-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .experiment-progress-bar {
            flex: 1;
            height: 8px;
            background: #333;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .experiment-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ralph-green), #55c669);
            transition: width 0.3s ease;
        }
        
        .experiment-percentage {
            font-size: 12px;
            color: #888;
            white-space: nowrap;
        }
        
        .experiment-status {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .experiment-status.active {
            background: #2d5a3d;
            color: #4ade80;
        }
        
        .experiment-status.testing {
            background: #4a3c1d;
            color: #fbbf24;
        }
        
        .experiment-status.launching {
            background: #3c4a5d;
            color: #60a5fa;
        }
        
        .innovation-event {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        
        .event-date {
            background: var(--ralph-green);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .event-content h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-green);
            font-size: 18px;
        }
        
        .event-content p {
            margin: 0 0 12px 0;
            color: #ccc;
            line-height: 1.4;
        }
        
        .event-details {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #888;
        }
        
        .innovation-btn {
            background: var(--ralph-green);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .innovation-btn:hover {
            background: #55c669;
        }
        
        /* Resources - Leadership Org Chart */
        .leadership-org-chart {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
        }
        
        .leadership-row {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .leadership-member {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            min-width: 200px;
            transition: all 0.2s ease;
        }
        
        .leadership-member:hover {
            border-color: var(--ralph-brown);
            transform: translateY(-2px);
        }
        
        .leadership-headshot {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid var(--ralph-brown);
            margin-bottom: 15px;
            image-rendering: pixelated;
        }
        
        .leadership-info h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-brown);
            font-size: 16px;
            font-weight: 600;
        }
        
        .leadership-info p {
            margin: 0;
            color: #ccc;
            font-size: 14px;
            line-height: 1.3;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .resource-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .resource-card:hover {
            border-color: var(--ralph-orange);
            transform: translateY(-2px);
        }
        
        .resource-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .resource-card h4 {
            margin: 0 0 8px 0;
            color: var(--ralph-orange);
            font-size: 16px;
        }
        
        .resource-card p {
            margin: 0 0 15px 0;
            color: #ccc;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .resource-btn {
            background: var(--ralph-orange);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .resource-btn:hover {
            background: #e5581e;
        }
        
        /* Module tabs for Quick Links and Resources */
        .module-tabs {
            display: flex;
            gap: 0;
            padding: 0 20px 0;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid #333;
        }
        
        .module-tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid #555;
            border-bottom: 1px solid #333;
            color: #fff;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            border-radius: 8px 8px 0 0;
            margin-bottom: -1px;
        }
        
        .module-tab:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border-color: #666;
        }
        
        .module-tab.active {
            background: rgba(255, 255, 255, 0.35);
            color: white;
            border-color: #777;
            border-bottom: 1px solid rgba(0, 0, 0, 0.3);
            font-weight: 600;
        }
        
        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--ralph-pink);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }
        
        .back-to-top:hover {
            background: #ff1493;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
        }
        
        /* Announcement Links */
        .announcement-link {
            color: var(--ralph-orange);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }
        
        .announcement-link:hover {
            color: #ff7635;
            text-decoration: underline;
        }
        
        /* Mobile banner adjustments */
        @media screen and (max-width: 600px) {
            .banner-popup {
                width: 300px;
                font-size: 12px;
            }
            
            .banner-header {
                font-size: 14px;
                padding: 8px 12px;
            }
            
            .banner-content {
                padding: 16px;
                font-size: 14px;
            }
            
            .banner-close {
                padding: 8px 16px;
                font-size: 14px;
            }
        }

        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            .icon:hover {
                background: transparent;
                border-color: transparent;
            }
            
            .pixel-button:hover {
                background: var(--gray-light);
                color: inherit;
            }
        }
        
        /* Continuous Matrix Background for Innovation Module */
        .matrix-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000000;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }
        
        .matrix-column {
            position: absolute;
            top: -50%;
            width: 20px;
            text-align: center;
            font-family: 'Space Mono', monospace;
            font-size: 14px;
            font-weight: bold;
            /* Much brighter matrix characters */
            color: #00ff41;
            text-shadow: 0 0 15px #00ff41, 0 0 25px #00ff00, 0 0 35px #00ff00;
            animation: matrix-fall-continuous 8s linear infinite;
        }
        
        @keyframes matrix-fall-continuous {
            0% {
                top: -50%;
                opacity: 1;
            }
            100% {
                top: 120%;
                opacity: 0;
            }
        }
        
        .matrix-char {
            display: block;
            margin-bottom: 3px;
            opacity: 1.0;
            animation: matrix-fade 2s ease-in-out infinite;
        }
        
        @keyframes matrix-fade {
            0%, 100% { 
                opacity: 0.7;
                color: #00ff00;
                text-shadow: 0 0 10px #00ff00;
            }
            50% { 
                opacity: 1.0;
                color: #00ff41;
                text-shadow: 0 0 20px #00ff41, 0 0 30px #00ff00;
            }
        }
        
        /* Make Innovation content appear above matrix background */
        .innovation-dashboard .window-content {
            position: relative;
            z-index: 1;
        }
        
        .innovation-dashboard .dashboard-content {
            position: relative;
            z-index: 2;
            background: rgba(0, 0, 0, 0.65); /* Lighter opacity to show matrix better */
            margin: 0 -16px -32px -16px; /* Extend beyond bottom edge */
            padding: 20px 24px 48px 24px; /* More padding on all sides for better spacing */
            min-height: calc(100% + 32px); /* Ensure full height coverage */
        }
        
        /* Enhanced Innovation Project Cards */
        .innovation-project {
            background: linear-gradient(135deg, #001100 0%, #003300 100%);
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 4px 8px rgba(0, 255, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .innovation-project:hover {
            border-color: #00ff41;
            box-shadow: 0 6px 20px rgba(0, 255, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .innovation-thumbnail {
            width: 140px;
            height: 120px;
            border-radius: 6px;
            border: 1px solid #00ff00;
            object-fit: cover;
            flex-shrink: 0;
            background: #000;
        }
        
        .innovation-main-content {
            display: flex;
            gap: 16px;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .innovation-content {
            flex: 1;
            min-width: 0;
        }
        
        .innovation-project h4 {
            color: #00ff00;
            font-size: 18px;
            font-weight: bold;
            margin: 0 0 8px 0;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .innovation-project-description {
            color: #ffffff;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 12px;
            opacity: 0.9;
        }
        
        .innovation-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-start;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .innovation-status {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            z-index: 10;
        }
        
        .innovation-status.active {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            border: 1px solid #00ff00;
        }
        
        .innovation-status.complete {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
            border: 1px solid #00ffff;
        }
        
        .innovation-status.dev {
            background: rgba(255, 255, 0, 0.2);
            color: #ffff00;
            border: 1px solid #ffff00;
        }
        
        .innovation-status.beta {
            background: rgba(0, 255, 255, 0.2);
            color: #00ffff;
            border: 1px solid #00ffff;
        }
        
        .innovation-status.coming-soon {
            background: rgba(150, 150, 150, 0.2);
            color: #999999;
            border: 1px solid #666666;
        }
        
        .innovation-progress-wrapper {
            width: 100%;
            margin-top: auto;
        }
        
        .innovation-progress-bar {
            background: #002200;
            border: 1px solid #00ff00;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .innovation-progress-fill {
            background: linear-gradient(90deg, #00ff00 0%, #00ff41 100%);
            height: 100%;
            border-radius: 9px;
            width: 0%;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
        }
        
        .innovation-progress-fill.animate {
            transition-delay: 0.5s;
        }
        
        .innovation-progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffffff;
            font-size: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            z-index: 2;
        }
        
        .innovation-project-btn {
            background: linear-gradient(135deg, #00ff00 0%, #00ff41 100%);
            color: #000000;
            border: none;
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            border: 1px solid transparent;
            box-shadow: 0 2px 4px rgba(0, 255, 0, 0.2);
        }
        
        .innovation-project-btn:hover {
            background: linear-gradient(135deg, #00ff41 0%, #00ff82 100%);
            box-shadow: 0 4px 12px rgba(0, 255, 0, 0.4);
            transform: translateY(-1px);
        }
        
        .innovation-project-btn:disabled {
            background: #666666;
            color: #999999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .innovation-project-btn.copy-btn {
            background: linear-gradient(135deg, #004400 0%, #006600 100%);
            color: #00ff00;
            border: 1px solid #006600;
            box-shadow: 0 2px 4px rgba(0, 100, 0, 0.3);
        }
        
        .innovation-project-btn.copy-btn:hover {
            background: linear-gradient(135deg, #006600 0%, #008800 100%);
            border-color: #00ff00;
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 150, 0, 0.4);
        }
        
        /* Innovation Sessions/Events Styling */
        .innovation-upcoming .upcoming-session {
            background: linear-gradient(135deg, #001100 0%, #003300 100%);
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }
        
        .innovation-upcoming .upcoming-session:hover {
            border-color: #00ff41;
            box-shadow: 0 6px 20px rgba(0, 255, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .upcoming-session .session-date {
            color: #00ff00;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 8px;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .upcoming-session .session-details h4 {
            color: #00ff41;
            font-size: 18px;
            margin: 0 0 8px 0;
            text-shadow: 0 0 3px #00ff41;
        }
        
        .upcoming-session .session-details p {
            color: #ffffff;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 8px;
            opacity: 0.9;
        }
        
        .upcoming-session .session-presenter {
            color: #00ff82;
            font-size: 13px;
            font-weight: bold;
            display: block;
            margin-top: 8px;
        }
        
        /* Weekly Share Challenge Styles */
        .weekly-share-pane {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            border-radius: 16px;
            margin: 20px 20px 0 20px;
            padding: 20px;
            border: 1px solid #333;
        }
        
        .weekly-share-header {
            margin-bottom: 20px;
        }
        
        .weekly-share-header h3 {
            color: var(--ralph-pink);
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 14px 0;
            display: flex;
            align-items: center;
            gap: 6px;
            font-family: 'Space Mono', monospace;
        }
        
        .weekly-share-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        @media (max-width: 1200px) {
            .weekly-share-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }
        
        .share-item {
            background: #0f0f0f;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #333;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .share-item:hover {
            border-color: var(--ralph-pink);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(235, 0, 139, 0.15);
        }
        
        .share-thumbnail {
            position: relative;
            width: 100%;
            height: 180px;
            overflow: hidden;
        }
        
        .share-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .share-item:hover .share-thumbnail img {
            transform: scale(1.05);
        }
        
        
        .share-content {
            padding: 16px;
        }
        
        .share-title {
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 8px 0;
            line-height: 1.3;
            font-family: 'Space Mono', monospace;
        }
        
        .share-description {
            color: #cccccc;
            font-size: 14px;
            line-height: 1.4;
            margin: 0 0 16px 0;
            opacity: 0.9;
        }
        
        .share-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .share-button {
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Space Mono', monospace;
        }
        
        
        .share-button.share-btn {
            background: linear-gradient(135deg, var(--ralph-pink) 0%, #ff1493 100%);
            color: white;
            flex: 1;
        }
        
        .share-button.share-btn:hover {
            background: linear-gradient(135deg, #ff1493 0%, #e6007a 100%);
            transform: translateY(-1px);
        }
        
        /* Trendspotting Styles */
        .trendspotting-dashboard .window-content {
            background: #000000 !important;
            color: #ffffff !important;
            font-family: 'Space Mono', monospace !important;
            padding: 0 !important;
            overflow: hidden;
        }
        
        .trendspotting-dashboard .window-content::before {
            display: none !important;
        }
        
        .trendspotting-container {
            width: 100%;
            height: 100%;
            background: #000;
            position: relative;
            overflow: hidden;
        }
        
        .trendspotting-main-layout {
            display: flex;
            height: calc(100% - 100px);
            position: relative;
        }
        
        .trendspotting-office-section {
            flex: 1;
            position: relative;
            overflow: hidden;
            border-right: 2px solid var(--ralph-orange);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .trendspotting-office-section:last-child {
            border-right: none;
        }
        
        .trendspotting-office-section:hover {
            flex: 1.2;
            background: rgba(241, 101, 36, 0.1);
        }
        
        .trendspotting-office-label {
            position: absolute;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            left: 10px;
            top: 10px;
            font-size: 18px;
            font-weight: bold;
            color: var(--ralph-orange);
            letter-spacing: 8px;
            text-transform: uppercase;
            z-index: 10;
        }
        
        .trendspotting-office-content {
            padding: 20px;
            padding-left: 50px;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: thin;
            scrollbar-color: var(--ralph-orange) transparent;
            display: flex;
            flex-direction: column;
        }
        
        .trendspotting-office-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .trendspotting-office-content::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .trendspotting-office-content::-webkit-scrollbar-thumb {
            background: var(--ralph-orange);
            border-radius: 3px;
        }
        
        .trendspotting-playlist-section {
            margin-bottom: 30px;
            flex-shrink: 0;
        }
        
        .trendspotting-playlist-title {
            font-size: 14px;
            color: var(--ralph-pink);
            margin-bottom: 10px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .trendspotting-playlist-item {
            margin-bottom: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid var(--ralph-blue);
            transition: all 0.2s ease;
            font-size: 12px;
        }
        
        .trendspotting-playlist-item:hover {
            background: rgba(49, 189, 191, 0.2);
            border-left-color: var(--ralph-pink);
            padding-left: 15px;
        }
        
        .trendspotting-song-title {
            color: #fff;
            margin-bottom: 2px;
        }
        
        .trendspotting-song-artist {
            color: rgba(255, 255, 255, 0.6);
            font-size: 11px;
        }
        
        .trendspotting-trends-section {
            margin-top: 0;
            flex-shrink: 0;
        }
        
        .trendspotting-trends-title {
            font-size: 14px;
            color: var(--ralph-green);
            margin-bottom: 10px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .trendspotting-trend-item {
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(68, 182, 88, 0.1);
            border: 1px solid var(--ralph-green);
            font-size: 12px;
            line-height: 1.4;
            transition: all 0.2s ease;
        }
        
        .trendspotting-trend-item:hover {
            background: rgba(68, 182, 88, 0.2);
            transform: translateX(5px);
        }
        
        .trendspotting-trend-category {
            color: var(--ralph-yellow);
            font-weight: bold;
            display: inline-block;
            margin-right: 5px;
        }
        
        .trendspotting-trend-description {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .trendspotting-title-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: var(--ralph-orange);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
        }
        
        .trendspotting-main-title {
            font-size: 72px;
            font-weight: bold;
            color: #fff;
            letter-spacing: 2px;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }
        
        .trendspotting-description-box {
            background: var(--ralph-orange);
            color: #000;
            padding: 10px 15px;
            border: 1px solid #000;
            border-radius: 0;
            font-size: 12px;
            line-height: 1.4;
            max-width: 200px;
            font-family: 'Space Mono', monospace;
            font-weight: 500;
        }
        
        .trendspotting-last-updated {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            margin-left: auto;
            margin-right: 20px;
        }
        
        /* Windows 95 style button effects */
        .win95-button:active {
            border-color: #808080 #ffffff #ffffff #808080 !important;
        }
        
        .win95-button:hover {
            background: var(--ralph-pink) !important;
            color: white !important;
        }
        
        /* Profile panel specific styles */
        #userProfile {
            /* z-index managed by JavaScript */
        }
        
        #userProfile .window-content {
            background: #c0c0c0 !important;
            padding: 15px !important;
            overflow: visible !important;
            height: calc(100% - 30px);
        }
        
        #userProfile .profile-section {
            height: 100%;
            overflow: visible;
        }
        
        #userProfile input[type="checkbox"] {
            width: 13px;
            height: 13px;
            cursor: pointer;
        }
        
        #userProfile .win95-checkbox-label {
            margin-bottom: 8px !important;
        }
        
        #userProfile .win95-checkbox-label:hover {
            background: rgba(0, 0, 128, 0.1);
        }
        
        .win95-select:focus {
            outline: 1px dotted #000;
            outline-offset: -1px;
        }
    </style>
</head>
<body>
    <div class="boot-screen" id="bootScreen">
        <!-- Login Screen -->
        <div class="login-screen" id="loginScreen">
            <div class="boot-logo" id="bootLogo">
                                                                                                    
                                                                                                    
                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                           ‚ñà‚ñà‚ñà                 
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà                
                  ‚ñà‚ñà‚ñà‚ñà‚ñà                  ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà                
               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                    ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà                
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà                
            ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà                
   ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     
     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà     
     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà     
      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà      
      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà      
       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà       
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà       
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       
         ‚ñà‚ñà‚ñà‚ñà‚ñà          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà‚ñà‚ñà               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                       ‚ñà‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà       
          ‚ñà‚ñà‚ñà‚ñà‚ñà                                       ‚ñà‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      
           ‚ñà‚ñà‚ñà‚ñà‚ñà                                      ‚ñà‚ñà‚ñà‚ñà‚ñà                               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    
            ‚ñà‚ñà‚ñà‚ñà                                      ‚ñà‚ñà‚ñà‚ñà‚ñà                                  ‚ñà‚ñà‚ñà‚ñà   
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                         
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                      ‚ñà‚ñà‚ñà‚ñà                                          
                                                                                                    
                                                                                                    
            </div>
            <div class="login-form">
                <div class="login-prompt typing-text" style="opacity: 0;">INTRANET AUTHENTICATION REQUIRED</div>
                <div class="login-field">
                    <div class="login-prompt typing-text" style="opacity: 0;">USERNAME:</div>
                    <input type="text" class="login-input" id="username" autocomplete="off" style="opacity: 0;">
                </div>
                <div class="login-field">
                    <div class="login-prompt typing-text" style="opacity: 0;">PASSWORD:</div>
                    <input type="password" class="login-input" id="password" autocomplete="off" style="opacity: 0;">
                </div>
                <div class="login-prompt typing-text" style="opacity: 0;">Authenticate to proceed<span class="login-spinner"></span></div>
                <button class="login-btn" onclick="handleLogin()" style="opacity: 0;">Submit</button>
            </div>
            
            <!-- Boot sequence elements (hidden initially) -->
            <div class="boot-text" style="display: none;">INITIALIZING SUPER-INTRANET SYSTEM v1.0</div>
            <div class="loading-bar-container" style="display: none;">
                <div class="loading-bar" id="loadingBar"></div>
                <div class="loading-percentage" id="loadingPercentage">0%</div>
            </div>
            <div class="boot-messages" id="bootMessages" style="display: none;"></div>
        </div>
        
        <!-- Boot Sequence (hidden initially) -->
        <div class="boot-sequence" id="bootSequence">
            <div class="boot-text">INITIALIZING SUPER-INTRANET SYSTEM v1.0</div>
            <div class="loading-bar-container">
                <div class="loading-bar" id="loadingBar"></div>
                <div class="loading-percentage" id="loadingPercentage">0%</div>
            </div>
            <div class="boot-messages" id="bootMessages"></div>
        </div>
    </div>
    
    <div class="desktop scanlines crt-flicker" style="display: none;" id="desktop">
        <!-- ASCII art removed for cleaner interface -->
        <div class="desktop-ascii" id="desktopAscii" style="display: none;">
############################################################################################                       
############################################################################################                       
############################################################################################                       
########################################      ##############################################                       
#######################################         ############################################                       
######################################          ############################################                       
######################################    ##    ############################################                       
#####################################     ##    ############################################                       
#####################################     ##    ############################################                       
#####################################     ##    ############################################                       
#####################################     ##    ##########################   ###############                       
#####################################     ##    ##########################    ##############                       
#####################################     #     ##########################    ##############                       
#####################################     #     ##########################    ##############                       
#####################################     #    ###########################    ##############                       
#####################################     #    ###########################    ##############                       
##############      #################     #    ###############  ##########    ##############                       
############     ####################     #    ####    ####        #######    ##############                       
##########     #######         #######    #   #####     ##    #     #####     ############## #####   ##########    
##   ####     ######     #############        ### #     #   ####     ####     ####    ###### ##  #   ##########    
##    ##     ######    #####    ######        ### #        #####     ####    ##         #### #####   ####          
##          ######    ######    ######       #### #        #####     ###     #           ### #####   ##########    
###        #######    ######    #######      ######       ######     ###         ###     ###             #######   
###        ######     ######     ######     #######       #####     ###         ###     ####                ####   
####       #######    ######     ######      #####       ## ##      ###       #####    #####         ##########    
#####      #######    #####        ###        ###         ####     ####      #####     #####         #             
#####      #######            #                                   ####       #####    ######                       
######     ########           ##        ##                      ######      #####     ######                       
######     #########        #######   ######    ##     ###   ########      ######     ######                       
#######     ############ #########################     ###############     ######      #####                       
########     #####################################     #################  ########     #####                       
########     ####################################     ##############################     ###                       
##########    ###################################     #################################   ##                       
#################################################     ######################################                       
#################################################     ######################################                       
#################################################     ######################################                       
################################################      ######################################                       
################################################      ######################################                       
################################################     #######################################                       
##################################################   #######################################                       
############################################################################################                       
############################################################################################                       
                                                                                                                     
                                                                                                                     
 ####  ##  #  ##### #####  ####      ##### ##  ## ###### #####   ###   ##  #  ###########                          
##     ##  #  ## ##  #     #  #   ##   #   ######   ##   #  ##  #  ##  #####  ##      #                            
   ##  ##  #  ####   #     #####  ##   #   ## ###   ##   #####  #####  #  ##  ##     ##                            
#####  #####  ##     ####  #   #     ##### ##  ##   ##   #   #  #   #  #   #  #####   #                            

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                  [ SYSTEM v1.0 ONLINE ]
        </div>
        <div class="desktop-icons" id="desktop-icons">
            <!-- Desktop icons will be loaded dynamically from CMS configuration -->
            <div class="icon" onclick="openRalphWorld()">
                <div class="icon-image">üåç</div>
                <div class="icon-label">Ralph.World</div>
            </div>
        </div>
        
        <!-- Windows -->
        <!-- What's New Window -->
        <div id="whatsNew" class="window whats-new-dashboard" style="width: calc(100vw - 40px); height: calc(100vh - 60px); top: 20px !important; left: 20px !important;">
            <div class="window-header">
                <div class="window-title">Hey Brook! Here's what's new at RALPH</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('whatsNew')">_</button>
                    <button class="window-button" onclick="maximizeWindow('whatsNew')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('whatsNew')">X</button>
                </div>
            </div>
            <div class="window-content" id="whatsNewContent" style="padding: 0; background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%); overflow-y: auto;">
                <!-- Content will be dynamically loaded here -->
            </div>
        </div>
        
        <div id="chatbot" class="window" style="bottom: 60px; left: 45%; top: auto; width: 450px; height: 400px;">
            <div class="window-header">
                <div class="window-title">üí¨ RALPH Assistant v1.0</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('chatbot')">_</button>
                    <button class="window-button" onclick="maximizeWindow('chatbot')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('chatbot')">X</button>
                </div>
            </div>
            <div class="window-content" style="display: flex; flex-direction: column; padding: 8px;">
                <div id="chatDisplay" style="flex: 1; background: #000; color: #00ff00; padding: 10px; font-family: 'Space Mono', monospace; font-size: 14px; line-height: 1.5; overflow-y: auto; margin-bottom: 8px; border: 2px solid; border-color: #808080 #ffffff #ffffff #808080;">
                    <!-- Chatbot content will be loaded dynamically from CMS -->
                </div>
                <div style="display: flex; gap: 4px;">
                    <input type="text" id="chatInput" placeholder="Type your message here..." style="flex: 1; background: #000; color: #00ff00; border: 2px solid #00ff00; font-family: 'Space Mono', monospace; font-size: 14px; padding: 6px; line-height: 1.4;">
                    <button class="pixel-button" onclick="sendChat()" style="margin: 0; padding: 6px 12px;">SEND</button>
                </div>
            </div>
        </div>
        
        <div id="newBiz" class="window new-biz-dashboard" style="top: 50px; left: 50px;">
            <div class="window-header">
                <div class="window-title">üìä New Business Pipeline</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('newBiz')">_</button>
                    <button class="window-button" onclick="maximizeWindow('newBiz')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('newBiz')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="new-biz-header">
                    <h2 class="new-biz-title">New Business Pipeline</h2>
                    <div class="new-biz-subtitle">Track opportunities from leads to wins ‚Ä¢ Contact Gareth Jones for project details</div>
                </div>
                <div class="new-biz-horizontal-layout">
                    <div class="pipeline-columns">
                        <div class="pipeline-stage-column">
                            <h3>üî• Warm Leads</h3>
                            <div class="pipeline-stage-items" id="warmLeadsExpanded">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="pipeline-stage-column">
                            <h3>üíº Pitches Happening</h3>
                            <div class="pipeline-stage-items" id="pitchesHappeningExpanded">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="pipeline-stage-column">
                            <h3>üì© Pitch Submitted</h3>
                            <div class="pipeline-stage-items" id="pitchSubmittedExpanded">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="pipeline-stage-column">
                            <h3>üéØ Pitch Presented</h3>
                            <div class="pipeline-stage-items" id="pitchPresentedExpanded">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="pipeline-stage-column">
                            <h3>üèÜ Pitch Won</h3>
                            <div class="pipeline-stage-items" id="pitchWonExpanded">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                    </div>
                    <div class="pipeline-contact-section">
                        <img src="headshots/8bit_Gareth.png" alt="Gareth Jones" class="contact-headshot">
                        <div class="contact-content">
                            <h3>üìû Contact Gareth (Head of Growth)</h3>
                            <div class="contact-form-horizontal">
                                <textarea id="garethMessage" placeholder="Enter your message to Gareth about new business opportunities..." rows="2"></textarea>
                                <button class="contact-btn" onclick="sendMessageToGareth()">Send Message</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="premieres" class="window premieres-dashboard" style="top: 100px; left: 100px;">
            <div class="window-header">
                <div class="window-title">üé¨ Premiere Calendar</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('premieres')">_</button>
                    <button class="window-button" onclick="maximizeWindow('premieres')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('premieres')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="premieres-header">
                    <h2 class="premieres-title">Premiere Calendar</h2>
                    <div class="premieres-subtitle">Track project launches and debut dates ‚Ä¢ Add upcoming premieres</div>
                </div>
                <div class="premieres-content">
                    <div class="premieres-grid">
                        <div class="premiere-card">
                            <h3>üìÖ This Month</h3>
                            <div class="premiere-items" id="thisMonthPremieres">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="premiere-card">
                            <h3>üìÖ Next Month</h3>
                            <div class="premiere-items" id="nextMonthPremieres">
                                <!-- Items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                    </div>
                    <div class="premiere-add-section">
                        <h3>üé¨ Add New Premiere</h3>
                        <div class="premiere-form">
                            <input type="date" id="premiereDate" placeholder="Premiere Date">
                            <input type="text" id="premiereTitle" placeholder="Show/Project Title">
                            <input type="url" id="premiereLiveLink" placeholder="Live Link (Optional)">
                            <button class="premiere-btn" onclick="addNewPremiere()">Add Premiere</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        
        <div id="shoutouts" class="window shoutouts-dashboard" style="top: 50px; left: 200px;">
            <div class="window-header">
                <div class="window-title">üéâ Shoutouts & Celebrations</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('shoutouts')">_</button>
                    <button class="window-button" onclick="maximizeWindow('shoutouts')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('shoutouts')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="shoutouts-header">
                    <h2 class="shoutouts-title">Shoutouts & Celebrations</h2>
                    <div class="shoutouts-subtitle">Celebrate team milestones and achievements ‚Ä¢ Share appreciation for great work</div>
                </div>
                <div class="shoutouts-content">
                    <div class="shoutouts-grid">
                        <div class="shoutout-card">
                            <h3>üéÇ Birthdays This Month</h3>
                            <div class="shoutout-items" id="birthdayItems">
                                <!-- Birthday items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="shoutout-card">
                            <h3>üéä Work Anniversaries</h3>
                            <div class="shoutout-items" id="anniversaryItems">
                                <!-- Anniversary items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                        <div class="shoutout-card">
                            <h3>üì¢ Team Shoutouts</h3>
                            <div class="shoutout-items" id="shoutoutItems">
                                <!-- Shoutout items will be populated by loadContentFromCMS -->
                            </div>
                        </div>
                    </div>
                    <div class="shoutout-send-section">
                        <h3>‚ú® Send a Shoutout</h3>
                        <div class="shoutout-form">
                            <input type="text" id="shoutoutName" placeholder="Your name">
                            <textarea id="shoutoutMessage" placeholder="Write your shoutout message..." rows="2"></textarea>
                            <button class="shoutout-btn" onclick="sendShoutout()">Send Shoutout</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="articles" class="window articles-dashboard" style="top: 50px; left: 200px; width: 900px; height: calc(100vh - 90px);">
            <div class="window-header">
                <div class="window-title">üì∞ Industry Articles</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('articles')">_</button>
                    <button class="window-button" onclick="maximizeWindow('articles')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('articles')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="articles-header">
                    <h2 class="articles-title">Industry Articles</h2>
                    <div class="articles-subtitle">Stay informed with curated industry news and trends ‚Ä¢ Read and share must-have articles</div>
                </div>
                <div class="articles-content">
                    <div class="articles-layout">
                        <div class="articles-list">
                            <div class="articles-section">
                                <h3>üìà Trending Articles</h3>
                                <div class="article-items" id="trendingArticles">
                                    <!-- Trending articles will be populated by loadContentFromCMS -->
                                </div>
                            </div>
                            <div class="articles-section">
                                <h3>üìö Must Reads</h3>
                                <div class="article-items" id="mustReadArticles">
                                    <!-- Must read articles will be populated by loadContentFromCMS -->
                                </div>
                            </div>
                        </div>
                        <div class="articles-viewer">
                            <div class="articles-placeholder" id="articlesPlaceholder">
                                <div class="placeholder-content">
                                    <h3>üì∞ Select an Article</h3>
                                    <p>Click on any article from the list to read it here</p>
                                </div>
                            </div>
                            <iframe id="articleFrame" class="article-iframe" style="display: none;"></iframe>
                        </div>
                    </div>
                    <div class="articles-add-section">
                        <h3>üìù Add New Article</h3>
                        <div class="articles-form">
                            <input type="text" id="articleTitle" placeholder="Article Title">
                            <input type="url" id="articleUrl" placeholder="Article URL">
                            <input type="text" id="articleSource" placeholder="Publication (e.g., Campaign UK, Adweek)">
                            <input type="text" id="articleSubmitter" placeholder="Your Name">
                            <button class="articles-btn" onclick="addNewArticle()">Add Article</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="ralphNews" class="window ralph-news-dashboard" style="top: 50px; left: 50px; width: 950px; height: calc(100vh - 90px);">
            <div class="window-header">
                <div class="window-title">üì¢ <span class="rnn-logo">RNN</span> RALPH News Network</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('ralphNews')">_</button>
                    <button class="window-button" onclick="maximizeWindow('ralphNews')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('ralphNews')">X</button>
                </div>
            </div>
            
            <div class="window-content">
                <!-- Ralph News Header -->
                <div class="ralph-news-header">
                    <h2 class="ralph-news-title">Ralph News Network</h2>
                    <p class="ralph-news-subtitle">Breaking news and updates from across the RALPH network</p>
                </div>
                
                <!-- News Ticker -->
                <div class="news-ticker-container">
                    <div class="news-ticker-label">BREAKING</div>
                    <div class="news-ticker">
                        <div class="news-ticker-content" id="newsTicker">
                            BREAKING: RALPH wins Agency of the Year at Cannes Lions ‚Ä¢ New Tokyo office expansion planned for Q2 2025 ‚Ä¢ Record-breaking Q4 client acquisition numbers announced ‚Ä¢ Partnership with major streaming platform confirmed ‚Ä¢ Holiday party Dec 20th - all offices invited
                        </div>
                    </div>
                </div>
                
                <div class="news-layout">
                    <!-- News Presenter Section -->
                    <div class="news-presenter-section">
                        <div class="presenter-screen">
                            <div class="presenter-image-container">
                                <img id="presenterImage" class="presenter-image" src="headshots/8bit_Hassell-open.png" alt="Hassell - News Presenter">
                                <div class="live-indicator">
                                    <span class="live-dot"></span>
                                    LIVE
                                </div>
                            </div>
                            <div class="presenter-name">CHRIS HASSELL</div>
                            <div class="presenter-title">CHIEF CORRESPONDENT</div>
                        </div>
                        
                        <!-- Additional Articles -->
                        <div class="additional-articles" id="additionalArticles">
                            <h3>More Stories</h3>
                            <div class="additional-article-item" onclick="expandStory('additional', 'additional-1')">
                                <div class="additional-article-title">Studio Equipment Upgrade Complete</div>
                                <div class="additional-article-meta">Production Team ‚Ä¢ Dec 14</div>
                            </div>
                            <div class="additional-article-item" onclick="expandStory('additional', 'additional-2')">
                                <div class="additional-article-title">New Health Benefits Announced</div>
                                <div class="additional-article-meta">HR Team ‚Ä¢ Dec 12</div>
                            </div>
                            <div class="additional-article-item" onclick="expandStory('additional', 'additional-3')">
                                <div class="additional-article-title">Sustainability Initiative Launch</div>
                                <div class="additional-article-meta">Green Team ‚Ä¢ Dec 10</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Main News Content -->
                    <div class="news-content">
                        <!-- Main Headline -->
                        <div class="main-headline" id="mainHeadline">
                            <div class="headline-story" onclick="expandStory('main', 'main-1')">
                                <div class="placeholder-image headline-image" style="background: #EB008B; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; width: 600px; height: 300px;">RALPH Tokyo Expansion</div>
                                <div class="headline-content">
                                    <h1 class="headline-title">RALPH Announces Major Expansion with New Tokyo Office</h1>
                                    <p class="headline-excerpt">The creative powerhouse reveals plans for a significant expansion of their Tokyo operations, adding 50 new positions across creative, strategy, and production teams as they prepare for increased Asian market focus.</p>
                                    <div class="headline-meta">
                                        RALPH Communications Team ‚Ä¢ December 24, 2024 ‚Ä¢ Company News
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Secondary Stories Grid -->
                        <div class="secondary-stories" id="secondaryStories">
                            <div class="story-card" onclick="expandStory('secondary', 'secondary-1')">
                                <div class="placeholder-image story-image" style="background: #31BDBF; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; width: 400px; height: 200px;">Award Win</div>
                                <div class="story-content">
                                    <h3 class="story-title">Award Win: Best Digital Campaign</h3>
                                    <p class="story-excerpt">RALPH's groundbreaking campaign for BeReal takes home top honors at the Digital Marketing Excellence Awards.</p>
                                    <div class="story-meta">Awards Team ‚Ä¢ December 22, 2024</div>
                                </div>
                            </div>
                            
                            <div class="story-card" onclick="expandStory('secondary', 'secondary-2')">
                                <div class="placeholder-image story-image" style="background: #F16524; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; width: 400px; height: 200px;">Streaming Partnership</div>
                                <div class="story-content">
                                    <h3 class="story-title">New Partnership with Streaming Giant</h3>
                                    <p class="story-excerpt">RALPH secures major deal to create original content series for leading streaming platform, marking entry into entertainment production.</p>
                                    <div class="story-meta">Business Development ‚Ä¢ December 20, 2024</div>
                                </div>
                            </div>
                            
                            <div class="story-card" onclick="expandStory('secondary', 'secondary-3')">
                                <div class="placeholder-image story-image" style="background: #44B658; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; width: 400px; height: 200px;">Record Q4</div>
                                <div class="story-content">
                                    <h3 class="story-title">Q4 Client Acquisition Breaks Records</h3>
                                    <p class="story-excerpt">RALPH closes 2024 with the highest quarterly client acquisition in company history, adding 15 new accounts globally.</p>
                                    <div class="story-meta">New Business Team ‚Ä¢ December 18, 2024</div>
                                </div>
                            </div>
                            
                            <div class="story-card" onclick="expandStory('secondary', 'secondary-4')">
                                <div class="placeholder-image story-image" style="background: #FBC000; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; width: 400px; height: 200px;">AI Tools</div>
                                <div class="story-content">
                                    <h3 class="story-title">Innovation Lab Launches AI-Powered Tools</h3>
                                    <p class="story-excerpt">RALPH's innovation team unveils new AI-assisted creative workflow tools designed to enhance, not replace, human creativity.</p>
                                    <div class="story-meta">Innovation Lab ‚Ä¢ December 16, 2024</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Sidebar Stories -->
                        <div class="sidebar-stories" id="sidebarStories">
                            <h3 class="sidebar-title">More News</h3>
                            
                            <div class="sidebar-story" onclick="expandStory('sidebar', 'sidebar-1')">
                                <h4 class="sidebar-story-title">Holiday Party Details Announced</h4>
                                <p class="sidebar-story-excerpt">All offices invited to virtual celebration Dec 20th with special appearances and prizes.</p>
                                <div class="sidebar-story-meta">People & Culture ‚Ä¢ December 15, 2024</div>
                            </div>
                            
                            <div class="sidebar-story" onclick="expandStory('sidebar', 'sidebar-2')">
                                <h4 class="sidebar-story-title">New Studio Equipment Arrives</h4>
                                <p class="sidebar-story-excerpt">State-of-the-art cameras and lighting equipment installed in Studio B for enhanced production capabilities.</p>
                                <div class="sidebar-story-meta">Production Team ‚Ä¢ December 14, 2024</div>
                            </div>
                            
                            <div class="sidebar-story" onclick="expandStory('sidebar', 'sidebar-3')">
                                <h4 class="sidebar-story-title">Health Benefits Update</h4>
                                <p class="sidebar-story-excerpt">Enhanced mental health support and wellness programs added to employee benefits package.</p>
                                <div class="sidebar-story-meta">HR Team ‚Ä¢ December 12, 2024</div>
                            </div>
                            
                            <div class="sidebar-story" onclick="expandStory('sidebar', 'sidebar-4')">
                                <h4 class="sidebar-story-title">Sustainability Initiative Launch</h4>
                                <p class="sidebar-story-excerpt">RALPH commits to carbon neutrality by 2026 with new environmental programs across all offices.</p>
                                <div class="sidebar-story-meta">Sustainability Team ‚Ä¢ December 10, 2024</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Story Modal (will be populated dynamically) -->
        <div id="storyModal" class="story-modal" style="display: none;">
            <!-- Modal content will be inserted dynamically -->
        </div>
        
        <div id="suggestions" class="window suggestions-dashboard" style="top: 50px; left: 350px; width: 800px; height: 600px;">
            <div class="window-header">
                <div class="window-title">üí≠ Suggestions</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('suggestions')">_</button>
                    <button class="window-button" onclick="maximizeWindow('suggestions')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('suggestions')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="suggestions-header">
                    <h2 class="suggestions-title">Suggestions</h2>
                    <div class="suggestions-subtitle">The best way to get your voice heard and make positive changes at RALPH</div>
                </div>
                <div class="dashboard-content">
                <div class="suggestions-list-section">
                    <h3>Recent Suggestions & Status</h3>
                    <div class="suggestions-list">
                        <div class="suggestion-item">
                            <div class="suggestion-content">
                                <h4>Coffee Machine Upgrade</h4>
                                <p>Install premium espresso machines in all break rooms</p>
                                <div class="suggestion-meta">
                                    <span class="suggestion-author">Anonymous</span>
                                    <span class="suggestion-category">Workplace</span>
                                </div>
                            </div>
                            <div class="suggestion-status approved">APPROVED ‚úì</div>
                        </div>
                        <div class="suggestion-item">
                            <div class="suggestion-content">
                                <h4>Flexible Friday Hours</h4>
                                <p>Allow flexible start/end times on Fridays for better work-life balance</p>
                                <div class="suggestion-meta">
                                    <span class="suggestion-author">Team Lead</span>
                                    <span class="suggestion-category">Culture</span>
                                </div>
                            </div>
                            <div class="suggestion-status reviewing">IN REVIEW</div>
                        </div>
                        <div class="suggestion-item">
                            <div class="suggestion-content">
                                <h4>Pet-Friendly Office Days</h4>
                                <p>Designate certain days where employees can bring well-behaved pets</p>
                                <div class="suggestion-meta">
                                    <span class="suggestion-author">Sarah M.</span>
                                    <span class="suggestion-category">Benefits</span>
                                </div>
                            </div>
                            <div class="suggestion-status considering">CONSIDERING</div>
                        </div>
                    </div>
                </div>
                <div class="suggestions-section">
                    <h3>Submit Your Idea</h3>
                    <div class="suggestion-form">
                        <input type="text" class="suggestion-input" id="suggesterName" placeholder="Your name (optional)">
                        <select class="suggestion-select" id="suggestionCategory">
                            <option value="general">General Improvement</option>
                            <option value="workplace">Workplace Environment</option>
                            <option value="process">Process Enhancement</option>
                            <option value="technology">Technology & Tools</option>
                            <option value="culture">Company Culture</option>
                            <option value="benefits">Benefits & Perks</option>
                        </select>
                        <textarea class="suggestion-textarea" id="suggestionText" placeholder="Describe your brilliant idea here..."></textarea>
                        <button class="suggestion-btn" onclick="submitSuggestion()">Submit Suggestion</button>
                    </div>
            </div>
        </div>
            </div>
        </div>
        
        <!-- Announcements Window -->
        <div id="announcements" class="window announcements-dashboard" style="top: 100px; left: 400px; width: 800px; height: 600px;">
            <div class="window-header">
                <div class="window-title">üì£ Announcements</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('announcements')">_</button>
                    <button class="window-button" onclick="maximizeWindow('announcements')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('announcements')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="announcements-header">
                    <h2 class="announcements-title">Announcements</h2>
                    <div class="announcements-subtitle">Important updates, policy changes, and company news you need to know</div>
                </div>
                <div class="dashboard-content">
                <div class="announcements-urgent-section">
                    <h3>‚ö†Ô∏è Important Notices</h3>
                    <div class="announcements-list">
                        <div class="announcement-item urgent">
                            <div class="announcement-badge">URGENT</div>
                            <div class="announcement-content">
                                <h4>System Maintenance Scheduled</h4>
                                <p>Scheduled for Saturday 2:00 AM - Please save all work before Friday EOD</p>
                                <div class="announcement-meta">
                                    <span class="announcement-date">Posted: Today</span>
                                    <span class="announcement-dept">IT Department</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="announcements-general-section">
                    <h3>üì¢ General Announcements</h3>
                    <div class="announcements-list">
                        <div class="announcement-item">
                            <div class="announcement-content">
                                <h4>Parking Lot B Closure</h4>
                                <p>Parking lot B closed for repairs this week - please use alternative parking areas</p>
                                <div class="announcement-meta">
                                    <span class="announcement-date">Posted: 2 days ago</span>
                                    <span class="announcement-dept">Facilities</span>
                                </div>
                            </div>
                        </div>
                        <div class="announcement-item">
                            <div class="announcement-content">
                                <h4>Health Benefits Info Session</h4>
                                <p>Join us Thursday at 2 PM in Conference Room A for important benefits updates</p>
                                <div class="announcement-meta">
                                    <span class="announcement-date">Posted: 1 day ago</span>
                                    <span class="announcement-dept">HR</span>
                                </div>
                            </div>
                        </div>
                        <div class="announcement-item">
                            <div class="announcement-content">
                                <h4>Kitchen Renovation Complete</h4>
                                <p>Our newly renovated kitchen is ready! Enjoy the upgraded appliances and seating area</p>
                                <div class="announcement-meta">
                                    <span class="announcement-date">Posted: 3 days ago</span>
                                    <span class="announcement-dept">Facilities</span>
                                    <a href="https://facilities.ralph.com/kitchen" class="announcement-link" target="_blank">View Photos</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        
        <!-- Quick Links Window -->
        <div id="links" class="window links-dashboard" style="top: 150px; left: 450px; width: 900px; height: 700px;">
            <div class="window-header">
                <div class="window-title">üîó Quick Links</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('links')">_</button>
                    <button class="window-button" onclick="maximizeWindow('links')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('links')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="links-header">
                    <h2 class="links-title">Quick Links</h2>
                    <div class="links-subtitle">Quick access to essential tools, internal systems, and external resources</div>
                </div>
                <div class="module-tabs">
                <button class="module-tab active" onclick="scrollToSection('links-internal-section')">Internal Tools</button>
                <button class="module-tab" onclick="scrollToSection('links-external-section')">External Resources</button>
                <button class="module-tab" onclick="scrollToSection('links-add-section')">Submit Link</button>
            </div>
            <div class="dashboard-content" onscroll="checkScrollPosition(this)">
                <button class="back-to-top" id="links-back-to-top" onclick="scrollToTop('links')" style="display: none;">‚Üë Back to Top</button>
                <div class="links-internal-section" id="links-internal-section">
                    <h3>üè¢ Internal Tools</h3>
                    <div class="links-grid">
                        <div class="link-card">
                            <div class="link-icon">‚è∞</div>
                            <h4>Timesheet System</h4>
                            <p>Track your hours and submit timesheets</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://timesheet.ralph.com')">Open</button>
                        </div>
                        <div class="link-card">
                            <div class="link-icon"></div>
                            <h4>Project Tracker</h4>
                            <p>Monitor project progress and milestones</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://projects.ralph.com')">Open</button>
                        </div>
                        <div class="link-card">
                            <div class="link-icon"></div>
                            <h4>Expense Reports</h4>
                            <p>Submit and track expense reimbursements</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://expenses.ralph.com')">Open</button>
                        </div>
                        <div class="link-card">
                            <div class="link-icon"></div>
                            <h4>IT Helpdesk</h4>
                            <p>Submit IT tickets and check status</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://helpdesk.ralph.com')">Open</button>
                        </div>
                    </div>
                </div>
                <div class="links-external-section" id="links-external-section">
                    <h3>üåç External Resources</h3>
                    <div class="links-grid">
                        <div class="link-card">
                            <div class="link-icon">üë•</div>
                            <h4>Client Portal</h4>
                            <p>Client project access and communication</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://client.ralph.com')">Open</button>
                        </div>
                        <div class="link-card">
                            <div class="link-icon"></div>
                            <h4>Vendor Database</h4>
                            <p>Approved vendor contacts and services</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://vendors.ralph.com')">Open</button>
                        </div>
                        <div class="link-card">
                            <div class="link-icon"></div>
                            <h4>Stock Footage Library</h4>
                            <p>Licensed footage and media assets</p>
                            <button class="link-card-btn" onclick="openExternalLink('https://footage.ralph.com')">Open</button>
                        </div>
                    </div>
                </div>
                <div class="links-add-section" id="links-add-section">
                    <h3>Submit a Useful Link</h3>
                    <div class="link-form">
                        <input type="text" class="link-input" id="linkTitle" placeholder="Link title">
                        <input type="url" class="link-input" id="linkUrl" placeholder="https://example.com">
                        <select class="link-select" id="linkCategory">
                            <option value="internal">Internal Tool</option>
                            <option value="external">External Resource</option>
                            <option value="reference">Reference Material</option>
                            <option value="software">Software/Apps</option>
                            <option value="training">Training Resources</option>
                            <option value="partner">Partner Sites</option>
                            <option value="industry">Industry Resources</option>
                        </select>
                        <textarea class="link-textarea" id="linkDescription" placeholder="Brief description of what this link provides..."></textarea>
                        <button class="link-btn" onclick="submitLink()">Submit Link</button>
                    </div>
                </div>
                </div>
                </div>
            </div>
        </div>
        
        <!-- Innovation Window -->
        <div id="innovation" class="window innovation-dashboard" style="top: 50px; left: 500px; width: 800px; height: 650px;">
            <div class="window-header">
                <div class="window-title">üöÄ Innovation @ Ralph</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('innovation')">_</button>
                    <button class="window-button" onclick="maximizeWindow('innovation')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('innovation')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="innovation-header">
                    <h2 class="innovation-title">Innovation @ Ralph</h2>
                    <div class="innovation-subtitle">Cutting-edge projects, emerging technologies, and creative experiments</div>
                </div>
                <div class="dashboard-content">
                <div class="innovation-experiments-section">
                    <h3>Current Experiments</h3>
                    <div class="innovation-experiments">
                        <!-- Experiments will be loaded dynamically from CMS -->
                    </div>
                </div>
                <div class="innovation-events-section">
                    <h3>Innovation Sessions</h3>
                    <div class="innovation-upcoming">
                        <!-- Upcoming sessions will be loaded dynamically from CMS -->
                    </div>
                </div>
                <div class="innovation-contact-section">
                    <img src="headshots/8bit_Brook-closed.png" alt="Brook Downtom" class="contact-headshot">
                    <div class="contact-content">
                        <h3>üöÄ Connect with Brook (Innovation Lead)</h3>
                        <p>Have an innovative idea or want to collaborate on emerging tech projects? Reach out directly!</p>
                        <div class="contact-form-horizontal">
                            <textarea id="brookMessage" placeholder="Share your innovation ideas, technology suggestions, or collaboration proposals..."></textarea>
                            <button class="contact-btn" onclick="sendMessageToBrook()">Send Message</button>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        
        <!-- Pitch Please Window -->
        <div id="pitchPlease" class="window pitch-please-dashboard" style="top: 80px; left: 120px; width: 900px; height: 700px;">
            <div class="window-header">
                <div class="window-title">üí° Pitch, Please!</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('pitchPlease')">_</button>
                    <button class="window-button" onclick="maximizeWindow('pitchPlease')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('pitchPlease')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="pitch-please-header">
                    <h1 class="pitch-please-title">Pitch, Please!</h1>
                    <div class="pitch-please-subtitle">A quarterly competition where you can pitch almost anything you think is a winner</div>
                </div>
                <div class="dashboard-content">
                    
                    <div class="pitch-please-overview">
                        <div class="pitch-types-intro">
                            <p>Submit your most creative ideas across any format:</p>
                            <div class="pitch-types-list">
                                <div class="pitch-type">Magazine article</div>
                                <div class="pitch-type">Social series</div>
                                <div class="pitch-type">Fundraising ad</div>
                                <div class="pitch-type">Animation series</div>
                                <div class="pitch-type">Live event</div>
                                <div class="pitch-type">Comedy web series</div>
                                <div class="pitch-type">Game</div>
                                <div class="pitch-type">Podcast format</div>
                            </div>
                            <div class="pitch-type-highlight">Or anything else you dream up - Submit below!</div>
                        </div>
                    </div>

                    <div class="pitch-please-sections">
                        <div class="pitch-section">
                            <h3>Current Competition</h3>
                            <div class="current-competition">
                                <div class="competition-status">
                                    <div class="status-badge">Submissions Open</div>
                                    <div class="deadline">Deadline: March 31, 2025</div>
                                </div>
                                <div class="competition-stats">
                                    <div class="stat">
                                        <div class="stat-number">12</div>
                                        <div class="stat-label">Submissions</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">$500</div>
                                        <div class="stat-label">Prize Pool</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">45</div>
                                        <div class="stat-label">Days Left</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="pitch-section">
                            <h3>Why Care?</h3>
                            <div class="pitch-benefits">
                                <div class="benefit-group">
                                    <h4>Big Wins</h4>
                                    <ul>
                                        <li>$500 cash prize for the top pitch</li>
                                        <li>Your idea could actually get made</li>
                                        <li>Build your skills and flex your creativity</li>
                                        <li>Full credit and joint ownership with Ralph</li>
                                    </ul>
                                </div>
                                <div class="benefit-group">
                                    <h4>Fair & Simple</h4>
                                    <ul>
                                        <li>Anonymous submissions</li>
                                        <li>Blind judging process</li>
                                        <li>Feedback for every entry</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="pitch-section">
                            <h3>How It Works</h3>
                            <ol class="pitch-process">
                                <li>Have a great concept, solo or as a team</li>
                                <li>Submit it anonymously</li>
                                <li>Ralph panel + guest judges pick the best</li>
                                <li>We toast every idea at a global Pitch, Please! Zoom meetup</li>
                                <li>Winner gets ¬£¬£¬£ and the project moves forward</li>
                            </ol>
                        </div>

                        <div class="pitch-section">
                            <h3>Ralph Greenlight Gauntlet</h3>
                            <div class="gauntlet-intro">Every winning idea must pass these criteria:</div>
                            <div class="gauntlet-criteria">
                                <div class="criteria-item">‚úì Who's it for?</div>
                                <div class="criteria-item">‚úì Would you send it to a mate?</div>
                                <div class="criteria-item">‚úì Does it smell like Ralph?</div>
                                <div class="criteria-item">‚úì What's the twist?</div>
                                <div class="criteria-item">‚úì One-breath pitch?</div>
                                <div class="criteria-item">‚úì What's the win?</div>
                                <div class="criteria-item">‚úì Scalable?</div>
                            </div>
                        </div>

                        <div class="pitch-section pitch-submit-section">
                            <h3>Submit Your Pitch</h3>
                            <div class="pitch-form">
                                <div class="form-group">
                                    <label for="pitchTitle">Project Title</label>
                                    <input type="text" id="pitchTitle" placeholder="What's your project called?">
                                </div>
                                
                                <div class="form-group">
                                    <label for="pitchType">Project Type</label>
                                    <select id="pitchType">
                                        <option value="">Select type...</option>
                                        <option value="magazine-article">Magazine Article</option>
                                        <option value="social-series">Social Series</option>
                                        <option value="fundraising-ad">Fundraising Ad</option>
                                        <option value="animation-series">Animation Series</option>
                                        <option value="live-event">Live Event</option>
                                        <option value="comedy-web-series">Comedy Web Series</option>
                                        <option value="game">Game</option>
                                        <option value="podcast-format">Podcast Format</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>

                                <div class="gauntlet-questions">
                                    <div class="form-group">
                                        <label for="pitchAudience">Who's it for?</label>
                                        <textarea id="pitchAudience" rows="2" placeholder="Describe your target audience..."></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pitchShareable">Would you send it to a mate?</label>
                                        <textarea id="pitchShareable" rows="2" placeholder="Why would people want to share this?"></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pitchRalph">Does it smell like Ralph?</label>
                                        <textarea id="pitchRalph" rows="2" placeholder="How does this fit Ralph's brand and values?"></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pitchTwist">What's the twist?</label>
                                        <textarea id="pitchTwist" rows="2" placeholder="What makes this unique or unexpected?"></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pitchOneBreath">One-breath pitch?</label>
                                        <textarea id="pitchOneBreath" rows="3" placeholder="Explain your concept in one clear, compelling sentence..."></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pitchWin">What's the win?</label>
                                        <textarea id="pitchWin" rows="2" placeholder="What success looks like and why it matters..."></textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pitchScalable">Scalable?</label>
                                        <textarea id="pitchScalable" rows="2" placeholder="How could this grow or be replicated?"></textarea>
                                    </div>
                                </div>

                                <div class="checkbox-group">
                                    <label>
                                        <input type="checkbox" id="pitchAnonymous" checked>
                                        Submit anonymously (recommended)
                                    </label>
                                </div>

                                <div class="form-actions">
                                    <button class="btn-pitch-submit" onclick="submitPitch()">Submit Pitch</button>
                                    <button class="btn-pitch-draft" onclick="saveDraft()">Save Draft</button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resources Window -->
        <div id="resources" class="window resources-dashboard" style="top: 100px; left: 550px; width: 900px; height: 700px;">
            <div class="window-header">
                <div class="window-title">üìÅ Resource Center</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('resources')">_</button>
                    <button class="window-button" onclick="maximizeWindow('resources')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('resources')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="resources-header">
                    <h2 class="resources-title">Resource Center</h2>
                    <div class="resources-subtitle">Documents, templates, training materials, and organizational resources</div>
                </div>
                <div class="module-tabs">
                <button class="module-tab active" onclick="scrollToSection('resources-documents-section')">Documents</button>
                <button class="module-tab" onclick="scrollToSection('resources-templates-section')">Templates</button>
                <button class="module-tab" onclick="scrollToSection('resources-training-section')">Training</button>
                <button class="module-tab" onclick="showLeadershipWindow()">Leadership Team</button>
            </div>
            <div class="dashboard-content" onscroll="checkScrollPosition(this)">
                <button class="back-to-top" id="resources-back-to-top" onclick="scrollToTop('resources')" style="display: none;">‚Üë Back to Top</button>
                <div class="resources-documents-section" id="resources-documents-section">
                    <h3>üìÑ Documents & Guidelines</h3>
                    <div class="resources-grid">
                        <div class="resource-card">
                            <div class="resource-icon">üé®</div>
                            <h4>Brand Guidelines v3.2</h4>
                            <p>Complete brand identity standards and usage guidelines</p>
                            <button class="resource-btn" onclick="downloadResource('brand-guidelines')">Download</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon">üìö</div>
                            <h4>Employee Handbook 2024</h4>
                            <p>Company policies, procedures, and benefits information</p>
                            <button class="resource-btn" onclick="downloadResource('handbook')">Download</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon">‚ú®</div>
                            <h4>Creative Best Practices</h4>
                            <p>Standards for creative work and project delivery</p>
                            <button class="resource-btn" onclick="downloadResource('best-practices')">Download</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon">ü§ù</div>
                            <h4>Client Onboarding Guide</h4>
                            <p>Step-by-step process for new client relationships</p>
                            <button class="resource-btn" onclick="downloadResource('onboarding')">Download</button>
                        </div>
                    </div>
                </div>
                <div class="resources-templates-section" id="resources-templates-section">
                    <h3>Templates & Tools</h3>
                    <div class="resources-grid">
                        <div class="resource-card">
                            <div class="resource-icon"></div>
                            <h4>Presentation Template</h4>
                            <p>Standard RALPH presentation format and layouts</p>
                            <button class="resource-btn" onclick="accessTemplate('presentation')">Access</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon"></div>
                            <h4>Project Brief Template</h4>
                            <p>Structured template for project requirements</p>
                            <button class="resource-btn" onclick="accessTemplate('project-brief')">Access</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon">üí≥</div>
                            <h4>Invoice Template</h4>
                            <p>Professional invoice format with company branding</p>
                            <button class="resource-btn" onclick="accessTemplate('invoice')">Access</button>
                        </div>
                    </div>
                </div>
                <div class="resources-training-section" id="resources-training-section">
                    <h3>Training Materials</h3>
                    <div class="resources-grid">
                        <div class="resource-card">
                            <div class="resource-icon"></div>
                            <h4>New Software Tutorials</h4>
                            <p>Step-by-step guides for our latest tools</p>
                            <button class="resource-btn" onclick="accessTemplate('tutorials')">View</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon"></div>
                            <h4>Client Communication 101</h4>
                            <p>Best practices for client interactions</p>
                            <button class="resource-btn" onclick="accessTemplate('communication')">View</button>
                        </div>
                        <div class="resource-card">
                            <div class="resource-icon">üìÖ</div>
                            <h4>Project Management Basics</h4>
                            <p>Essential PM skills and methodologies</p>
                            <button class="resource-btn" onclick="accessTemplate('pm-basics')">View</button>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        
        
        <div class="taskbar">
            <button class="start-button" onclick="toggleStartMenu()">
                <span class="ralph-logo"></span>
                START
            </button>
            <!-- Start Menu -->
            <div id="startMenu" class="start-menu" style="display: none;">
                <div class="start-menu-header">
                    <span style="font-weight: bold; color: var(--ralph-pink);">üè¢ RALPH INTRANET</span>
                </div>
                <div class="start-menu-items">
                    <div class="start-menu-item" onclick="showWhatsNew(); toggleStartMenu();">
                        <span class="start-menu-icon">üéâ</span>
                        <span>What's New</span>
                    </div>
                    <div class="start-menu-item" onclick="openWindow('chatbot'); toggleStartMenu();">
                        <span class="start-menu-icon">üí¨</span>
                        <span>RALPH Assistant</span>
                    </div>
                    <div class="start-menu-separator"></div>
                    <div class="start-menu-item" onclick="openUserProfile(); toggleStartMenu();">
                        <span class="start-menu-icon">üë§</span>
                        <span>User Profile</span>
                    </div>
                    <div class="start-menu-item" onclick="openAdminLogin(); toggleStartMenu();">
                        <span class="start-menu-icon">‚öôÔ∏è</span>
                        <span>Admin Panel</span>
                    </div>
                    <div class="start-menu-item" onclick="openWindow('info'); toggleStartMenu();">
                        <span class="start-menu-icon">üìä</span>
                        <span>Info</span>
                    </div>
                    <div class="start-menu-item" onclick="location.reload();">
                        <span class="start-menu-icon">üîÑ</span>
                        <span>Restart</span>
                    </div>
                </div>
            </div>
            <div class="clock" id="clock">
                12:00 PM
                <div class="timezone-panel">
                    <div class="timezone-header">WORLD CLOCKS</div>
                    <div class="timezone-item">
                        <div>
                            <div class="timezone-label">LA</div>
                            <div class="timezone-city">Los Angeles</div>
                        </div>
                        <div class="timezone-time" id="timezone-la">12:00 PM</div>
                    </div>
                    <div class="timezone-item">
                        <div>
                            <div class="timezone-label">NY</div>
                            <div class="timezone-city">New York</div>
                        </div>
                        <div class="timezone-time" id="timezone-ny">3:00 PM</div>
                    </div>
                    <div class="timezone-item">
                        <div>
                            <div class="timezone-label">LDN</div>
                            <div class="timezone-city">London</div>
                        </div>
                        <div class="timezone-time" id="timezone-ldn">8:00 PM</div>
                    </div>
                    <div class="timezone-item">
                        <div>
                            <div class="timezone-label">TYO</div>
                            <div class="timezone-city">Tokyo</div>
                        </div>
                        <div class="timezone-time" id="timezone-tyo">5:00 AM</div>
                    </div>
                    <div class="timezone-item">
                        <div>
                            <div class="timezone-label">MUM</div>
                            <div class="timezone-city">Mumbai</div>
                        </div>
                        <div class="timezone-time" id="timezone-mum">1:30 AM</div>
                    </div>
                </div>
            </div>
            <button class="sound-button" onclick="toggleMusicPlayer()" title="Music Player">
                üéµ
            </button>
        </div>
        
        <div class="notification" id="notification">
            <span id="notificationText">System Alert!</span>
        </div>

        <!-- Music Player -->
        <div class="music-player" id="musicPlayer">
            <div class="player-header">
                <span>RALPH PLAYER v1.0</span>
                <button class="player-close" onclick="toggleMusicPlayer()">‚úï</button>
            </div>
            <div class="player-display">
                <div class="track-info" id="trackInfo">No track loaded</div>
                <div class="track-time" id="trackTime">00:00 / 00:00</div>
            </div>
            <div class="player-controls">
                <button class="control-btn" onclick="previousTrack()" title="Previous">‚èÆ</button>
                <button class="control-btn play" onclick="togglePlayPause()" id="playBtn" title="Play/Pause">‚ñ∂</button>
                <button class="control-btn" onclick="nextTrack()" title="Next">‚è≠</button>
                <button class="control-btn" onclick="stopTrack()" title="Stop">‚èπ</button>
            </div>
            <div class="volume-section">
                <span class="volume-label">VOL</span>
                <input type="range" class="volume-slider" min="0" max="100" value="70" oninput="setVolume(this.value)" id="volumeSlider">
            </div>
        </div>
        
        <!-- Trendspotting Window -->
        <div id="trendspotting" class="window trendspotting-dashboard" style="top: 70px; left: 150px; width: 1000px; height: 700px;">
            <div class="window-header">
                <div class="window-title">üéµ Trendspotting</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('trendspotting')">_</button>
                    <button class="window-button" onclick="maximizeWindow('trendspotting')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('trendspotting')">X</button>
                </div>
            </div>
            <div class="window-content">
                <div class="trendspotting-container">
                    <div class="trendspotting-main-layout">
                        <!-- Los Angeles Office -->
                        <div class="trendspotting-office-section" data-office="la">
                            <div class="trendspotting-office-label">LOS ANGELES</div>
                            <div class="trendspotting-office-content">
                                <div class="trendspotting-playlist-section">
                                    <div class="trendspotting-playlist-title">Now Playing</div>
                                    <div id="trendspotting-la-playlist">
                                        <!-- Playlist items will be loaded from CMS -->
                                    </div>
                                </div>
                                
                                <div class="trendspotting-trends-section">
                                    <div class="trendspotting-trends-title">Office Trends</div>
                                    <div id="trendspotting-la-trends">
                                        <!-- Trend items will be loaded from CMS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- New York Office -->
                        <div class="trendspotting-office-section" data-office="ny">
                            <div class="trendspotting-office-label">NEW YORK</div>
                            <div class="trendspotting-office-content">
                                <div class="trendspotting-playlist-section">
                                    <div class="trendspotting-playlist-title">Now Playing</div>
                                    <div id="trendspotting-ny-playlist">
                                        <!-- Playlist items will be loaded from CMS -->
                                    </div>
                                </div>
                                
                                <div class="trendspotting-trends-section">
                                    <div class="trendspotting-trends-title">Office Trends</div>
                                    <div id="trendspotting-ny-trends">
                                        <!-- Trend items will be loaded from CMS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- London Office -->
                        <div class="trendspotting-office-section" data-office="lon">
                            <div class="trendspotting-office-label">LONDON</div>
                            <div class="trendspotting-office-content">
                                <div class="trendspotting-playlist-section">
                                    <div class="trendspotting-playlist-title">Now Playing</div>
                                    <div id="trendspotting-lon-playlist">
                                        <!-- Playlist items will be loaded from CMS -->
                                    </div>
                                </div>
                                
                                <div class="trendspotting-trends-section">
                                    <div class="trendspotting-trends-title">Office Trends</div>
                                    <div id="trendspotting-lon-trends">
                                        <!-- Trend items will be loaded from CMS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Mumbai Office -->
                        <div class="trendspotting-office-section" data-office="mum">
                            <div class="trendspotting-office-label">MUMBAI</div>
                            <div class="trendspotting-office-content">
                                <div class="trendspotting-playlist-section">
                                    <div class="trendspotting-playlist-title">Now Playing</div>
                                    <div id="trendspotting-mum-playlist">
                                        <!-- Playlist items will be loaded from CMS -->
                                    </div>
                                </div>
                                
                                <div class="trendspotting-trends-section">
                                    <div class="trendspotting-trends-title">Office Trends</div>
                                    <div id="trendspotting-mum-trends">
                                        <!-- Trend items will be loaded from CMS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tokyo Office -->
                        <div class="trendspotting-office-section" data-office="tok">
                            <div class="trendspotting-office-label">TOKYO</div>
                            <div class="trendspotting-office-content">
                                <div class="trendspotting-playlist-section">
                                    <div class="trendspotting-playlist-title">Now Playing</div>
                                    <div id="trendspotting-tok-playlist">
                                        <!-- Playlist items will be loaded from CMS -->
                                    </div>
                                </div>
                                
                                <div class="trendspotting-trends-section">
                                    <div class="trendspotting-trends-title">Office Trends</div>
                                    <div id="trendspotting-tok-trends">
                                        <!-- Trend items will be loaded from CMS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="trendspotting-title-bar">
                        <div class="trendspotting-main-title">Trendspotting</div>
                        <div class="trendspotting-description-box">What Ralphies<br>worldwide<br>love this week</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- User Profile Panel -->
        <div id="userProfile" class="window" style="top: 80px; left: 50%; transform: translateX(-50%); width: 500px; height: 680px;">
            <div class="window-header">
                <div class="window-title">üë§ User Profile Settings</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('userProfile')">_</button>
                    <button class="window-button" onclick="maximizeWindow('userProfile')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('userProfile')">X</button>
                </div>
            </div>
            <div class="window-content" style="padding: 20px; background: #c0c0c0;">
                <div class="profile-section">
                    <h3 style="font-family: 'Space Mono', monospace; font-size: 16px; margin-bottom: 15px; border-bottom: 2px solid #808080; padding-bottom: 8px;">
                        PROFILE PREFERENCES
                    </h3>
                    
                    <!-- User Info Display -->
                    <div class="profile-field-group" style="margin-bottom: 20px; padding: 10px; background: #ffffff; border: 2px solid; border-color: #808080 #ffffff #ffffff #808080; position: relative;">
                        <div style="font-size: 13px; font-weight: bold; margin-bottom: 10px;">USER INFO:</div>
                        <div id="officeFlag" style="position: absolute; top: 10px; right: 10px; font-size: 24px; display: none;"></div>
                        <div style="margin-bottom: 8px;">
                            <span style="font-size: 12px; color: #808080;">Email:</span>
                            <span style="font-size: 12px; margin-left: 10px;">brook@ralph.world</span>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="font-size: 12px; color: #808080;">Full Name:</span>
                            <span style="font-size: 12px; margin-left: 10px;">Brook Downton</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <span style="font-size: 12px; color: #808080; margin-right: 10px;">Preferred Name:</span>
                            <input type="text" id="preferredName" value="Brook" style="
                                flex: 1;
                                padding: 4px;
                                background: white;
                                border: 1px solid #808080;
                                font-family: 'Space Mono', monospace;
                                font-size: 12px;
                            " placeholder="Enter preferred name">
                        </div>
                    </div>
                    
                    <!-- Office Selection -->
                    <div class="profile-field-group" style="margin-bottom: 25px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 10px; font-size: 14px;">
                            SELECT YOUR OFFICE:
                        </label>
                        <div class="win95-select-wrapper" style="position: relative; display: inline-block;">
                            <select id="userOffice" class="win95-select" style="
                                padding: 6px 30px 6px 8px;
                                background: white;
                                border: 2px solid;
                                border-color: #808080 #ffffff #ffffff #808080;
                                font-family: 'Space Mono', monospace;
                                font-size: 13px;
                                min-width: 200px;
                                appearance: none;
                                cursor: pointer;
                            ">
                                <option value="">-- Select Office --</option>
                                <option value="la">Los Angeles</option>
                                <option value="ny">New York</option>
                                <option value="lon">London</option>
                                <option value="mum">Mumbai</option>
                                <option value="tok">Tokyo</option>
                            </select>
                            <div class="win95-select-arrow" style="
                                position: absolute;
                                right: 4px;
                                top: 50%;
                                transform: translateY(-50%);
                                width: 16px;
                                height: 16px;
                                background: #c0c0c0;
                                border: 2px solid;
                                border-color: #ffffff #808080 #808080 #ffffff;
                                pointer-events: none;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 10px;
                            ">‚ñº</div>
                        </div>
                    </div>
                    
                    <!-- Content Priorities -->
                    <div class="profile-field-group" style="margin-bottom: 25px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 10px; font-size: 14px;">
                            CONTENT PRIORITIES:
                        </label>
                        <div style="background: white; border: 2px solid; border-color: #808080 #ffffff #ffffff #808080; padding: 10px;">
                            <div class="win95-checkbox-group">
                                <label class="win95-checkbox-label" style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                                    <input type="checkbox" id="priority-studio" value="studio" style="margin-right: 8px;">
                                    <span style="font-size: 13px;">Studio/Design</span>
                                </label>
                                <label class="win95-checkbox-label" style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                                    <input type="checkbox" id="priority-strategy" value="strategy" style="margin-right: 8px;">
                                    <span style="font-size: 13px;">Strategy</span>
                                </label>
                                <label class="win95-checkbox-label" style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                                    <input type="checkbox" id="priority-creative" value="creative" style="margin-right: 8px;">
                                    <span style="font-size: 13px;">Creative</span>
                                </label>
                                <label class="win95-checkbox-label" style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                                    <input type="checkbox" id="priority-tech" value="tech" style="margin-right: 8px;">
                                    <span style="font-size: 13px;">Tech/Innovation</span>
                                </label>
                                <label class="win95-checkbox-label" style="display: flex; align-items: center; margin-bottom: 8px; cursor: pointer;">
                                    <input type="checkbox" id="priority-data" value="data" style="margin-right: 8px;">
                                    <span style="font-size: 13px;">Data</span>
                                </label>
                                <label class="win95-checkbox-label" style="display: flex; align-items: center; margin-bottom: 0; cursor: pointer;">
                                    <input type="checkbox" id="priority-social" value="social" style="margin-right: 8px;">
                                    <span style="font-size: 13px;">Social</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Button -->
                    <div style="display: flex; justify-content: center; margin-top: 25px;">
                        <button class="win95-button" onclick="saveUserProfile()" style="
                            padding: 10px 40px;
                            background: #c0c0c0;
                            border: 2px solid;
                            border-color: #ffffff #808080 #808080 #ffffff;
                            font-family: 'Space Mono', monospace;
                            font-size: 14px;
                            font-weight: bold;
                            cursor: pointer;
                        ">SAVE PREFERENCES</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Admin Login Window -->
        <div id="adminLogin" class="window" style="top: 50%; left: 50%; transform: translate(-50%, -50%); width: 400px; height: 300px;">
            <div class="window-header">
                <div class="window-title">‚öôÔ∏è Admin Access Required</div>
                <div class="window-controls">
                    <button class="window-button" onclick="closeWindow('adminLogin')">X</button>
                </div>
            </div>
            <div class="window-content" style="display: flex; flex-direction: column; justify-content: center; padding: 24px;">
                <div class="ascii-art" style="text-align: center; margin-bottom: 20px;">
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë      ADMIN ACCESS        ‚ïë
    ‚ïë    SECURITY REQUIRED     ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                </div>
                <form id="adminLoginForm" style="display: flex; flex-direction: column; gap: 16px;">
                    <div>
                        <label style="display: block; margin-bottom: 4px; font-weight: bold;">USERNAME:</label>
                        <input type="text" id="adminUsername" value="ralph" style="width: 100%; padding: 8px; background: #000; color: #00ff00; border: 2px solid #808080; font-family: 'Space Mono', monospace; font-size: 14px; line-height: 1.4;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 4px; font-weight: bold;">PASSWORD:</label>
                        <input type="password" id="adminPassword" placeholder="Password" style="width: 100%; padding: 8px; background: #000; color: #00ff00; border: 2px solid #808080; font-family: 'Space Mono', monospace; font-size: 14px; line-height: 1.4;">
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 16px;">
                        <button type="submit" class="pixel-button" style="flex: 1;">ACCESS CMS</button>
                        <button type="button" class="pixel-button" onclick="closeWindow('adminLogin')" style="flex: 1;">CANCEL</button>
                    </div>
                </form>
                <div id="adminLoginError" style="display: none; margin-top: 16px; color: #ff0000; text-align: center; font-weight: bold;">
                    ‚ö†Ô∏è ACCESS DENIED - Invalid credentials
                </div>
            </div>
        </div>
        
        <!-- Info Window -->
        <div id="info" class="window" style="top: 50px; left: 50px; width: 800px; height: 600px;">
            <div class="window-header">
                <div class="window-title">üìä RALPH Intranet Info</div>
                <div class="window-controls">
                    <button class="window-button" onclick="minimizeWindow('info')">_</button>
                    <button class="window-button" onclick="maximizeWindow('info')">‚ñ°</button>
                    <button class="window-button" onclick="closeWindow('info')">X</button>
                </div>
            </div>
            <div class="window-content" style="padding: 20px; background: var(--white); overflow-y: auto; font-family: 'Space Mono', monospace; font-size: 14px; line-height: 1.6;">
                <!-- Info Panel content will be loaded dynamically from CMS -->
            </div>
        </div>
    </div>
    
    <!-- Welcome Banner Popup -->
    <div id="welcomeBanner" class="banner-popup">
        <div class="banner-header">
            üéâ WELCOME TO THE RALPH HUB! üéâ
        </div>
        <div class="banner-content">
            <div class="banner-text">
                HEY, <span class="banner-highlight">RALPHIE!</span> This is our new information hub for all things Ralph. 
            </div>
            <div class="banner-text">
                Use the <span class="banner-highlight">Suggestion Box</span> for any ideas for things you'd like to see on here.
            </div>
            <button class="banner-close" onclick="closeBanner()">GOT IT!</button>
        </div>
    </div>
    
    <!-- Weekly Share Challenge Popup -->
    <div id="sharePopup" class="share-popup" style="display: none;">
        <div class="share-popup-content">
            <div class="share-header">
                <h2>üì≤ 3 RALPH THINGS TO SHARE THIS WEEK!</h2>
                <div class="share-week">Week of <span id="shareWeek">August 20, 2024</span></div>
                <button class="share-close" onclick="closeSharePopup()">√ó</button>
            </div>
            
            <div class="share-intro">
                <p>üéâ Help spread the RALPH love! Share these posts and you'll be entered to win a <strong id="giftCardAmount">$25 gift card</strong>!</p>
            </div>
            
            <div class="share-items" id="shareItems">
                <!-- Items will be populated dynamically -->
            </div>
            
            <div class="share-footer" id="shareFooter">
                <div class="share-progress">
                    <span id="shareProgress">0 of 3 shared</span>
                </div>
                <button class="share-submit-btn" id="shareSubmitBtn" onclick="submitShares()" disabled>
                    üéØ ENTER SWEEPSTAKES
                </button>
            </div>
            
            <div class="share-success" id="shareSuccess" style="display: none;">
                <div class="success-message">
                    <h3>üéâ Thank You!</h3>
                    <p>You've been entered into this week's sweepstakes!</p>
                    <p class="comeback-message">Come back next week for another chance to win!</p>
                </div>
            </div>
        </div>
    </div>
    
    <style>
        .share-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
        }
        
        .share-popup-content {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            border: 3px solid var(--ralph-pink);
            border-radius: 15px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(235, 0, 139, 0.3);
            animation: popupSlideIn 0.3s ease-out;
        }
        
        @keyframes popupSlideIn {
            from { transform: scale(0.8) translateY(-50px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }
        
        .share-header {
            background: var(--ralph-pink);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
            border-radius: 12px 12px 0 0;
        }
        
        .share-header h2 {
            margin: 0;
            font-size: 24px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.5);
        }
        
        .share-week {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        .share-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .share-close:hover {
            color: #ffccdd;
        }
        
        .share-intro {
            padding: 20px;
            text-align: center;
            color: #e0e0e0;
            background: rgba(235, 0, 139, 0.1);
        }
        
        .share-intro p {
            margin: 0;
            font-size: 16px;
            line-height: 1.5;
        }
        
        .share-items {
            padding: 0 20px;
        }
        
        .share-item {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #404040;
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .share-item:hover {
            border-color: var(--ralph-pink);
            box-shadow: 0 5px 15px rgba(235, 0, 139, 0.2);
        }
        
        .share-item.completed {
            border-color: #00ff41;
            background: rgba(0, 255, 65, 0.1);
        }
        
        .share-thumbnail {
            width: 120px;
            height: 90px;
            object-fit: cover;
            border-radius: 8px 0 0 8px;
        }
        
        .share-content {
            flex: 1;
            padding: 15px;
            color: white;
        }
        
        .share-content h4 {
            margin: 0 0 5px 0;
            color: var(--ralph-pink);
            font-size: 16px;
        }
        
        .share-type {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        
        .share-description {
            font-size: 13px;
            color: #ccc;
            line-height: 1.4;
            margin-bottom: 10px;
        }
        
        .share-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .share-link-btn {
            background: var(--ralph-pink);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            text-transform: uppercase;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        .share-link-btn:hover {
            background: #c7007a;
        }
        
        .share-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: #ccc;
        }
        
        .share-checkbox input {
            transform: scale(1.2);
        }
        
        .share-footer {
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            text-align: center;
            border-radius: 0 0 12px 12px;
        }
        
        .share-progress {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .share-submit-btn {
            background: linear-gradient(45deg, var(--ralph-pink), #ff1493);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(235, 0, 139, 0.3);
        }
        
        .share-submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(235, 0, 139, 0.4);
        }
        
        .share-submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .share-success {
            padding: 40px 20px;
            text-align: center;
            color: white;
        }
        
        .success-message h3 {
            color: var(--ralph-pink);
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .success-message p {
            margin: 10px 0;
            font-size: 16px;
        }
        
        .comeback-message {
            color: #00ff41;
            font-weight: bold;
            margin-top: 20px !important;
            text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
        }
        
        @media (max-width: 768px) {
            .share-popup-content {
                width: 95%;
                max-height: 95vh;
            }
            
            .share-item {
                flex-direction: column;
            }
            
            .share-thumbnail {
                width: 100%;
                height: 150px;
                border-radius: 8px 8px 0 0;
            }
            
            .share-header h2 {
                font-size: 20px;
            }
        }
    </style>
    
    <script>
        'use strict';
        
        // Force cache clear version
        const CACHE_VERSION = '2025-08-26-19-00';
        const storedVersion = localStorage.getItem('rnn_version');
        if (storedVersion !== CACHE_VERSION) {
            console.log('üîÑ Clearing cache due to version update');
            localStorage.setItem('rnn_version', CACHE_VERSION);
            if (storedVersion !== null) {
                location.reload(true);
            }
        }
        
        // Global state management
        const AppState = {
            windows: {},
            activeWindow: null,
            zIndex: 15000, // Start well above any CSS z-index values
            isMobile: false,
            touchDevice: false,
            config: null,
            apiIntegration: null,
            chatbotAI: null,
            intervals: [],  // Track all intervals for cleanup
            timeouts: [],   // Track all timeouts for cleanup
            rafIds: []      // Track animation frame IDs
        };
        
        // DOM element cache for better performance
        const DOMCache = {
            elements: {},
            get(id) {
                if (!this.elements[id]) {
                    this.elements[id] = document.getElementById(id);
                }
                return this.elements[id];
            },
            querySelector(selector) {
                if (!this.elements[selector]) {
                    this.elements[selector] = document.querySelector(selector);
                }
                return this.elements[selector];
            },
            clear() {
                this.elements = {};
            }
        };
        
        // Utility functions
        const Utils = {
            isMobileDevice: () => {
                return window.innerWidth <= 768 || 
                       ('ontouchstart' in window) || 
                       (navigator.maxTouchPoints > 0);
            },
            
            debounce: (func, wait) => {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        };
        
        // Window management
        // Constrain window within viewport
        function constrainWindowToViewport(windowElement) {
            if (!windowElement) return;
            
            const rect = windowElement.getBoundingClientRect();
            const viewportWidth = document.documentElement.clientWidth || document.body.clientWidth;
            const viewportHeight = document.documentElement.clientHeight || document.body.clientHeight;
            const taskbarHeight = 40;
            const availableHeight = viewportHeight - taskbarHeight;
            
            // Check if window has a transform (like the admin window)
            const hasTransform = windowElement.style.transform && windowElement.style.transform.includes('translate');
            
            if (hasTransform) {
                // For windows with transforms, we need to work with their actual position
                let left = rect.left;
                let top = rect.top;
                let width = rect.width;
                let height = rect.height;
                
                // Check if window is outside viewport and remove transform if needed
                if (left < 0 || top < 60 || left + width > viewportWidth || top + height > availableHeight) {
                    // Remove transform and position normally
                    windowElement.style.transform = 'none';
                    windowElement.style.left = Math.max(0, Math.min(viewportWidth - width, 100)) + 'px';
                    windowElement.style.top = Math.max(60, Math.min(availableHeight - height, 100)) + 'px';
                }
            } else {
                // Normal positioning for windows without transforms
                let left = parseInt(windowElement.style.left) || rect.left;
                let top = parseInt(windowElement.style.top) || rect.top;
                let width = rect.width;
                let height = rect.height;
                
                // Ensure window doesn't go outside right edge
                if (left + width > viewportWidth) {
                    left = Math.max(0, viewportWidth - width);
                }
                
                // Ensure window doesn't go outside left edge
                if (left < 0) {
                    left = 0;
                }
                
                // Ensure window doesn't go outside bottom edge (account for taskbar)
                if (top + height > availableHeight) {
                    top = Math.max(60, availableHeight - height - 20);
                }
                
                // Ensure window doesn't go outside top edge
                if (top < 60) {
                    top = 60;
                }
                
                // Apply constrained position
                windowElement.style.left = `${left}px`;
                windowElement.style.top = `${top}px`;
            }
        }
        
        // Open a window beside another window
        function openWindowBeside(windowId, referenceWindowId) {
            const referenceWindow = document.getElementById(referenceWindowId);
            if (referenceWindow) {
                const rect = referenceWindow.getBoundingClientRect();
                const newLeft = rect.right + 20; // Position 20px to the right
                const newTop = rect.top;
                
                // First open the window
                openWindow(windowId);
                
                // Then position it beside the reference window
                const targetWindow = document.getElementById(windowId);
                if (targetWindow) {
                    targetWindow.style.left = `${newLeft}px`;
                    targetWindow.style.top = `${newTop}px`;
                    
                    // Ensure it stays within viewport
                    constrainWindowToViewport(targetWindow);
                }
            } else {
                // Fallback to normal open if reference window not found
                openWindow(windowId);
            }
        }
        
        function openWindow(windowId) {
            const windowEl = document.getElementById(windowId);
            if (!windowEl) return;
            
            // Close other windows on mobile
            if (AppState.isMobile) {
                document.querySelectorAll('.window.active').forEach(w => {
                    if (w.id !== windowId) {
                        w.classList.remove('active');
                    }
                });
            }
            
            windowEl.classList.add('active');
            // Ensure newly opened window is always on top
            AppState.zIndex = Math.max(AppState.zIndex + 1, 15001);
            windowEl.style.zIndex = AppState.zIndex;
            AppState.activeWindow = windowId;
            
            // Ensure window stays within viewport
            constrainWindowToViewport(windowEl);
            
            // Ensure window is properly initialized and independent
            windowEl.style.position = 'absolute';
            
            if (!AppState.windows[windowId]) {
                AppState.windows[windowId] = { draggable: null };
                makeDraggable(windowEl);
            }
            
            // Load content for this specific module from CMS (skip for whatsNew)
            if (windowId !== 'whatsNew') {
                loadModuleContentFromCMS(windowId);
            }
            
            // Special initialization for Ralph News Network
            if (windowId === 'ralphNews') {
                setTimeout(() => {
                    initializeRalphNews();
                }, 100); // Small delay to ensure content is loaded
            }
            
            // Mark module as viewed (remove new indicator)
            markModuleViewed(windowId);
            
            // Ensure window stays within viewport
            setTimeout(() => constrainWindowToViewport(windowEl), 100);
        }
        
        function closeWindow(windowId) {
            const windowEl = DOMCache.get(windowId);
            if (!windowEl) return;
            
            // Clean up matrix animation for Innovation window
            if (windowId === 'innovation' && windowEl.matrixInterval) {
                clearInterval(windowEl.matrixInterval);
                windowEl.matrixInterval = null;
                console.log('üßπ Cleaned up matrix animation interval');
            }
            
            windowEl.classList.remove('active');
            if (AppState.activeWindow === windowId) {
                AppState.activeWindow = null;
            }
        }
        
        function minimizeWindow(windowId) {
            const windowEl = DOMCache.get(windowId);
            if (!windowEl) return;
            
            windowEl.style.display = 'none';
            setTimeout(() => {
                windowEl.style.display = '';
            }, 100);
        }
        
        function maximizeWindow(windowId) {
            const windowEl = DOMCache.get(windowId);
            if (!windowEl) return;
            
            if (AppState.isMobile) {
                // On mobile, maximizing fills the available space
                windowEl.style.cssText = `
                    position: fixed !important;
                    top: 10px !important;
                    left: 10px !important;
                    right: 10px !important;
                    bottom: 50px !important;
                    width: auto !important;
                    height: auto !important;
                `;
            } else {
                if (windowEl.dataset.maximized === 'true') {
                    // Restore
                    windowEl.style.width = windowEl.dataset.originalWidth || '';
                    windowEl.style.height = windowEl.dataset.originalHeight || '';
                    windowEl.style.top = windowEl.dataset.originalTop || '100px';
                    windowEl.style.left = windowEl.dataset.originalLeft || '100px';
                    windowEl.dataset.maximized = 'false';
                } else {
                    // Maximize
                    windowEl.dataset.originalWidth = windowEl.style.width;
                    windowEl.dataset.originalHeight = windowEl.style.height;
                    windowEl.dataset.originalTop = windowEl.style.top;
                    windowEl.dataset.originalLeft = windowEl.style.left;
                    
                    windowEl.style.width = '90vw';
                    windowEl.style.height = '80vh';
                    windowEl.style.top = '20px';
                    windowEl.style.left = '5vw';
                    windowEl.dataset.maximized = 'true';
                }
            }
        }
        
        function makeDraggable(element) {
            if (AppState.isMobile) return; // Disable dragging on mobile
            
            // Clear any existing drag handlers to prevent conflicts
            const header = element.querySelector('.window-header');
            if (!header) return;
            
            // Remove any existing handlers
            header.onmousedown = null;
            header.ontouchstart = null;
            
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            const dragMouseDown = (e) => {
                e = e || window.event;
                e.preventDefault();
                
                if (e.type === 'touchstart') {
                    pos3 = e.touches[0].clientX;
                    pos4 = e.touches[0].clientY;
                } else {
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                }
                
                document.onmouseup = closeDragElement;
                document.ontouchend = closeDragElement;
                document.onmousemove = elementDrag;
                document.ontouchmove = elementDrag;
                AppState.zIndex = Math.max(AppState.zIndex + 1, 15001);
                element.style.zIndex = AppState.zIndex;
            };
            
            const elementDrag = (e) => {
                e = e || window.event;
                e.preventDefault();
                
                let clientX, clientY;
                if (e.type === 'touchmove') {
                    clientX = e.touches[0].clientX;
                    clientY = e.touches[0].clientY;
                } else {
                    clientX = e.clientX;
                    clientY = e.clientY;
                }
                
                pos1 = pos3 - clientX;
                pos2 = pos4 - clientY;
                pos3 = clientX;
                pos4 = clientY;
                
                const newTop = element.offsetTop - pos2;
                const newLeft = element.offsetLeft - pos1;
                
                // Boundary checking - keep window within viewport (absolute edges)
                const containerWidth = document.documentElement.clientWidth || document.body.clientWidth;
                const containerHeight = document.documentElement.clientHeight || document.body.clientHeight;
                const maxTop = containerHeight - element.offsetHeight - 40; // Leave space for taskbar
                const maxLeft = containerWidth - element.offsetWidth; // Allow to absolute right edge
                const minLeft = 0; // Allow to absolute left edge
                
                element.style.top = Math.max(0, Math.min(newTop, maxTop)) + "px";
                element.style.left = Math.max(minLeft, Math.min(newLeft, maxLeft)) + "px";
            };
            
            const closeDragElement = () => {
                document.onmouseup = null;
                document.ontouchend = null;
                document.onmousemove = null;
                document.ontouchmove = null;
            };
            
            header.onmousedown = dragMouseDown;
            header.ontouchstart = dragMouseDown;
        }
        
        // Clock update
        function updateClock() {
            const now = new Date();
            
            // Local time (main clock)
            const hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            const clockEl = document.getElementById('clock');
            
            if (clockEl) {
                // Update main clock text (need to preserve the timezone panel HTML)
                const timezonePanel = clockEl.querySelector('.timezone-panel');
                clockEl.innerHTML = `${displayHours}:${minutes} ${ampm}`;
                if (timezonePanel) {
                    clockEl.appendChild(timezonePanel);
                }
            }
            
            // Update timezone clocks
            updateTimezoneClocks();
        }

        function updateTimezoneClocks() {
            const now = new Date();
            
            // Define timezones with their UTC offsets (considering DST is complex, using standard time)
            const timezones = [
                { id: 'timezone-la', offset: -8, dst: true },    // Los Angeles (PST/PDT)
                { id: 'timezone-ny', offset: -5, dst: true },    // New York (EST/EDT)  
                { id: 'timezone-ldn', offset: 0, dst: true },    // London (GMT/BST)
                { id: 'timezone-tyo', offset: 9, dst: false },   // Tokyo (JST)
                { id: 'timezone-mum', offset: 5.5, dst: false }  // Mumbai (IST)
            ];
            
            timezones.forEach(tz => {
                const element = document.getElementById(tz.id);
                if (element) {
                    // Get current month to determine DST (simplified - March to October)
                    const month = now.getMonth() + 1;
                    const isDSTActive = tz.dst && (month >= 3 && month <= 10);
                    const effectiveOffset = tz.offset + (isDSTActive ? 1 : 0);
                    
                    // Calculate timezone time
                    const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
                    const timezoneTime = new Date(utc + (effectiveOffset * 3600000));
                    
                    const tzHours = timezoneTime.getHours();
                    const tzMinutes = timezoneTime.getMinutes().toString().padStart(2, '0');
                    const tzAmpm = tzHours >= 12 ? 'PM' : 'AM';
                    const tzDisplayHours = tzHours % 12 || 12;
                    
                    element.textContent = `${tzDisplayHours}:${tzMinutes} ${tzAmpm}`;
                }
            });
        }
        
        // Iframe Window Management
        let iframeWindows = [];
        let iframeCounter = 0;

        function createIframeWindow(url, title) {
            const windowId = `iframe-${++iframeCounter}`;
            const windowElement = document.createElement('div');
            windowElement.id = windowId;
            windowElement.className = 'iframe-window active';
            windowElement.style.top = `${50 + (iframeCounter * 30)}px`;
            windowElement.style.left = `${50 + (iframeCounter * 30)}px`;
            windowElement.style.width = '800px';
            windowElement.style.height = '600px';

            windowElement.innerHTML = `
                <div class="iframe-header">
                    <div class="iframe-title">${title}</div>
                    <div class="iframe-controls">
                        <button class="iframe-control-btn" onclick="maximizeIframeWindow('${windowId}')" title="Maximize">üóñ</button>
                        <button class="iframe-control-btn" onclick="closeIframeWindow('${windowId}')" title="Close">‚úï</button>
                    </div>
                </div>
                <div class="iframe-loading">Loading...</div>
            `;

            document.body.appendChild(windowElement);
            iframeWindows.push({id: windowId, element: windowElement, url: url, title: title});
            
            // Make window draggable
            makeIframeDraggable(windowElement);
            
            // Load content after a brief delay
            setTimeout(() => {
                loadIframeContent(windowId, url);
            }, 500);

            return windowId;
        }

        function loadIframeContent(windowId, url) {
            const windowElement = document.getElementById(windowId);
            if (windowElement) {
                const loadingDiv = windowElement.querySelector('.iframe-loading');
                if (loadingDiv) {
                    const iframe = document.createElement('iframe');
                    iframe.className = 'iframe-content';
                    iframe.src = url;
                    iframe.onload = () => {
                        loadingDiv.style.display = 'none';
                    };
                    iframe.onerror = () => {
                        loadingDiv.textContent = 'Failed to load content';
                    };
                    loadingDiv.parentNode.replaceChild(iframe, loadingDiv);
                }
            }
        }

        function closeIframeWindow(windowId) {
            const windowElement = document.getElementById(windowId);
            if (windowElement) {
                windowElement.remove();
                iframeWindows = iframeWindows.filter(w => w.id !== windowId);
            }
        }

        function maximizeIframeWindow(windowId) {
            const windowData = iframeWindows.find(w => w.id === windowId);
            if (windowData) {
                // Open in new browser tab
                window.open(windowData.url, '_blank');
                // Optionally close the iframe window
                closeIframeWindow(windowId);
            }
        }

        function makeIframeDraggable(windowElement) {
            const header = windowElement.querySelector('.iframe-header');
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

            header.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
                
                // Bring to front with robust z-index
                AppState.zIndex = Math.max(AppState.zIndex + 1, 15001);
                windowElement.style.zIndex = AppState.zIndex;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                windowElement.style.top = (windowElement.offsetTop - pos2) + "px";
                windowElement.style.left = (windowElement.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        // Sound effect with proper user gesture handling
        let audioContext = null;
        let audioEnabled = false;
        
        function initAudio() {
            if (!audioEnabled && (window.AudioContext || window.webkitAudioContext)) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    if (audioContext.state === 'suspended') {
                        audioContext.resume().then(() => {
                            audioEnabled = true;
                        });
                    } else {
                        audioEnabled = true;
                    }
                } catch (e) {
                    console.log('Audio not supported');
                }
            }
        }
        
        function beep() {
            // Only try to play sound if audio has been properly initialized
            if (audioEnabled && audioContext && audioContext.state === 'running') {
                try {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 800;
                    oscillator.type = 'square';
                    gainNode.gain.value = 0.1;
                    
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.05);
                } catch (e) {
                    // Silently fail if audio error occurs
                }
            }
            // If audio not enabled, just continue silently (no error)
        }
        
        // Notification system
        function showNotification(message) {
            // Don't show notifications during boot sequence
            const bootScreen = document.getElementById('bootScreen');
            if (bootScreen && bootScreen.style.display !== 'none') {
                return; // Boot screen is still visible, skip notification
            }
            
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            if (!notification || !notificationText) return;
            
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // START button functionality
        // Toggle START menu
        function toggleStartMenu() {
            const startMenu = document.getElementById('startMenu');
            if (startMenu) {
                if (startMenu.style.display === 'none' || startMenu.style.display === '') {
                    startMenu.style.display = 'block';
                    // Ensure start menu is always on top when opened
                    startMenu.style.zIndex = '25000';
                } else {
                    startMenu.style.display = 'none';
                }
            }
        }
        
        // Close start menu when clicking elsewhere
        document.addEventListener('click', function(e) {
            const startMenu = document.getElementById('startMenu');
            const startButton = e.target.closest('.start-button');
            const startMenuItem = e.target.closest('.start-menu-item');
            
            if (!startButton && !startMenuItem && startMenu) {
                startMenu.style.display = 'none';
            }
            
            // Bring clicked window to front - handle ALL window types
            const clickedWindow = e.target.closest('.window, .iframe-window');
            if (clickedWindow && (clickedWindow.classList.contains('active') || clickedWindow.classList.contains('iframe-window'))) {
                // Ensure this window is on top with robust z-index
                AppState.zIndex = Math.max(AppState.zIndex + 1, 15001);
                clickedWindow.style.zIndex = AppState.zIndex;
                if (clickedWindow.id) {
                    AppState.activeWindow = clickedWindow.id;
                }
            }
        });

        // Enhanced chatbot functionality with AI integration
        async function sendChat() {
            console.log('üí¨ sendChat called');
            const input = DOMCache.get('chatInput');
            const display = DOMCache.get('chatDisplay');
            if (!input || !display) return;
            
            const message = input.value.trim();
            if (message === '') return;
            
            console.log('üìù Processing message:', message);
            
            // Use DocumentFragment for batch DOM updates
            const fragment = document.createDocumentFragment();
            
            // Remove blinking cursor
            const cursor = display.querySelector('.blink');
            if (cursor) cursor.remove();
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.style.marginTop = '10px';
            userMsg.style.color = '#00ff00';
            // Create safe DOM elements to prevent XSS
            const userSpan = document.createElement('span');
            userSpan.style.color = '#ffffff';
            userSpan.textContent = 'USER:';
            userMsg.appendChild(userSpan);
            userMsg.appendChild(document.createTextNode(' ' + message));
            fragment.appendChild(userMsg);
            
            // Add loading indicator
            const loadingMsg = document.createElement('div');
            loadingMsg.style.marginTop = '10px';
            loadingMsg.style.color = '#00ff00';
            loadingMsg.innerHTML = `<span style="color: #ffff00;">ASSISTANT:</span> <span class="blink">Processing...</span>`;
            fragment.appendChild(loadingMsg);
            
            // Batch append to DOM
            display.appendChild(fragment);
            display.scrollTop = display.scrollHeight;
            
            // Process bot response
            let response = '';
            const lowerMsg = message.toLowerCase();
            
            // Handle built-in commands first
            if (lowerMsg.includes('help')) {
                response = `Available commands:
‚ñ∫ 'status' - Check system status
‚ñ∫ 'time' - Get current time
‚ñ∫ 'clear' - Clear chat history
‚ñ∫ 'modules' - List all modules
‚ñ∫ 'tips' - Show productivity tips
‚ñ∫ 'refresh' - Update all module content`;
            } else if (lowerMsg.includes('status')) {
                response = 'All systems operational. Network: ONLINE. Projects: 47 active.';
            } else if (lowerMsg.includes('time')) {
                const now = new Date();
                response = `Current time: ${now.toLocaleTimeString()}`;
            } else if (lowerMsg.includes('clear')) {
                display.innerHTML = `<div style="color: #EB008B;">Chat cleared.</div>`;
                if (AppState.chatbotAI) {
                    AppState.chatbotAI.clearHistory();
                }
                input.value = '';
                return;
            } else if (lowerMsg.includes('modules')) {
                const enabledModules = Object.entries(AppState.config?.modules || {})
                    .filter(([id, config]) => config.enabled)
                    .map(([id, config]) => config.title)
                    .join(', ');
                response = `Available modules: ${enabledModules}`;
            } else if (lowerMsg.includes('tips')) {
                response = AppState.isMobile ? 
                    'Pro tip: Tap any icon to open its module!' : 
                    'Pro tip: Hold SHIFT while clicking to open multiple windows at once!';
            } else if (lowerMsg.includes('refresh')) {
                refreshAllModules();
                response = 'Refreshing all module content from APIs...';
            } else {
                // Use server-side chatbot endpoint
                try {
                    // Collect conversation history for context
                    const history = [];
                    const messages = display.querySelectorAll('div');
                    messages.forEach(msg => {
                        const text = msg.textContent;
                        if (text.startsWith('USER:')) {
                            history.push({ role: 'user', content: text.replace('USER: ', '') });
                        } else if (text.startsWith('ASSISTANT:') && !text.includes('Processing...')) {
                            history.push({ role: 'assistant', content: text.replace('ASSISTANT: ', '') });
                        }
                    });
                    
                    // Call server endpoint
                    const apiResponse = await fetch('/api/chatbot', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: message,
                            history: history.slice(-10) // Send last 10 messages for context
                        })
                    });
                    
                    const result = await apiResponse.json();
                    // API response received
                    response = result.response;
                    
                    if (result.fallback) {
                        // Using fallback response
                    }
                } catch (error) {
                    // API error occurred
                    // Fallback responses
                    const responses = AppState.config?.chatbot?.openai?.fallbackResponses || [
                        'I\'m having trouble processing that right now.',
                        'Let me think about that...',
                        'Interesting question! Tell me more.',
                        'System processing...'
                    ];
                    response = responses[Math.floor(Math.random() * responses.length)];
                }
            }
            
            console.log('‚úÖ Final response:', response);
            
            // Remove loading indicator and add actual response
            try {
                if (loadingMsg && loadingMsg.parentNode) {
                    display.removeChild(loadingMsg);
                    console.log('üóëÔ∏è Loading message removed');
                }
            } catch (error) {
                console.log('Error removing loading message:', error);
            }
            
            const botMsg = document.createElement('div');
            botMsg.style.marginTop = '10px';
            botMsg.style.color = '#00ff00';
            botMsg.innerHTML = `<span style="color: #ffff00;">ASSISTANT:</span> ${response}`;
            display.appendChild(botMsg);
            console.log('üì® Bot response added to display');
            
            // Add new cursor
            const newCursor = document.createElement('div');
            newCursor.style.marginTop = '10px';
            newCursor.style.color = '#00ff00';
            newCursor.className = 'blink';
            newCursor.textContent = '> _';
            display.appendChild(newCursor);
            
            // Clear input and scroll to bottom
            input.value = '';
            display.scrollTop = display.scrollHeight;
        }

        // CMS Functions
        // Load pipeline data and render
        function loadPipelineData(data) {
            const stagesMapping = {
                'warmLeads': 'warmLeadsExpanded',
                'pitchesHappening': 'pitchesHappeningExpanded', 
                'pitchSubmitted': 'pitchSubmittedExpanded',
                'pitchPresented': 'pitchPresentedExpanded',
                'pitchWon': 'pitchWonExpanded'
            };
            
            Object.entries(stagesMapping).forEach(([stage, expandedId]) => {
                const container = document.getElementById(expandedId);
                if (!container) return;
                
                const items = data[stage] || [];
                
                // Clear existing items
                container.innerHTML = '';
                
                // Add expanded items
                items.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'pipeline-expanded-item';
                    
                    itemEl.innerHTML = `
                        <div class="project-name">${item.name || 'Untitled Project'}</div>
                        <div class="project-office">${item.office || 'NYC'}</div>
                        <div class="project-due">Due: ${item.dueDate ? new Date(item.dueDate).toLocaleDateString() : 'TBD'}</div>
                        <div class="project-links">
                            ${item.deckLink ? `<a href="#" class="project-link" onclick="openIframeWindow('${item.deckLink}', '${item.name} - Deck', 900, 700)">View Deck</a>` : ''}
                            ${item.briefLink ? `<a href="#" class="project-link" onclick="openIframeWindow('${item.briefLink}', '${item.name} - Brief', 900, 700)">View Brief</a>` : ''}
                        </div>
                    `;
                    
                    container.appendChild(itemEl);
                });
                
                // If no items, show placeholder
                if (items.length === 0) {
                    container.innerHTML = '<div style="color: #666; font-style: italic; text-align: center; padding: 20px;">No projects in this stage</div>';
                }
            });
        }

        // Send message to Gareth function
        function sendMessageToGareth() {
            const messageTextarea = document.getElementById('garethMessage');
            if (!messageTextarea) return;
            
            const message = messageTextarea.value.trim();
            if (!message) {
                showNotification('Please enter a message before sending.', 'warning');
                return;
            }
            
            // For now, this will show a confirmation and clear the message
            // In a real implementation, this would send an email or Slack message
            showNotification(`Message sent to Gareth Jones (Head of Growth): "${message.substring(0, 50)}${message.length > 50 ? '...' : ''}"`, 'success');
            messageTextarea.value = '';
            
            // Log for debugging
            console.log('üìß Message to Gareth:', {
                recipient: 'Gareth Jones - Head of Growth, RALPH NY',
                message: message,
                timestamp: new Date().toISOString()
            });
        }

        // Send message to Brook (Innovation Lead) function
        function sendMessageToBrook() {
            const messageTextarea = document.getElementById('brookMessage');
            if (!messageTextarea) return;
            
            const message = messageTextarea.value.trim();
            if (!message) {
                showNotification('Please enter a message before sending.', 'warning');
                return;
            }
            
            showNotification(`Innovation idea sent to Brook Downtom: "${message.substring(0, 50)}${message.length > 50 ? '...' : ''}"`, 'success');
            messageTextarea.value = '';
            
            console.log('üöÄ Innovation message to Brook:', {
                recipient: 'Brook Downtom - Innovation Lead, RALPH',
                message: message,
                timestamp: new Date().toISOString()
            });
        }

        // Submit suggestion function
        function submitSuggestion() {
            const nameInput = document.getElementById('suggesterName');
            const categorySelect = document.getElementById('suggestionCategory');
            const textArea = document.getElementById('suggestionText');
            
            if (!textArea) return;
            
            const suggestion = textArea.value.trim();
            const name = nameInput ? nameInput.value.trim() : '';
            const category = categorySelect ? categorySelect.value : 'general';
            
            if (!suggestion) {
                showNotification('Please enter your suggestion before submitting.', 'warning');
                return;
            }
            
            const submitterName = name || 'Anonymous';
            showNotification(`Suggestion submitted by ${submitterName}: "${suggestion.substring(0, 50)}${suggestion.length > 50 ? '...' : ''}"`, 'success');
            
            // Clear form
            if (nameInput) nameInput.value = '';
            if (categorySelect) categorySelect.selectedIndex = 0;
            textArea.value = '';
            
            console.log('üí° New suggestion submitted:', {
                submitter: submitterName,
                category: category,
                suggestion: suggestion,
                timestamp: new Date().toISOString()
            });
        }

        // Submit link function
        function submitLink() {
            const titleInput = document.getElementById('linkTitle');
            const urlInput = document.getElementById('linkUrl');
            const categorySelect = document.getElementById('linkCategory');
            const descriptionArea = document.getElementById('linkDescription');
            
            if (!titleInput || !urlInput) return;
            
            const title = titleInput.value.trim();
            const url = urlInput.value.trim();
            const category = categorySelect ? categorySelect.value : 'internal';
            const description = descriptionArea ? descriptionArea.value.trim() : '';
            
            if (!title || !url) {
                showNotification('Please enter both title and URL before submitting.', 'warning');
                return;
            }
            
            showNotification(`Link submitted: "${title}" - ${url.substring(0, 30)}${url.length > 30 ? '...' : ''}`, 'success');
            
            // Clear form
            titleInput.value = '';
            urlInput.value = '';
            if (categorySelect) categorySelect.selectedIndex = 0;
            if (descriptionArea) descriptionArea.value = '';
            
            console.log('üîó New link submitted:', {
                title: title,
                url: url,
                category: category,
                description: description,
                timestamp: new Date().toISOString()
            });
        }

        // Open external link function
        function openExternalLink(url) {
            if (!url) return;
            window.open(url, '_blank', 'noopener,noreferrer');
            console.log('üåê External link opened:', url);
        }

        // RSVP Innovation Event function
        function rsvpInnovationEvent() {
            showNotification('RSVP confirmed for "Future of Motion Graphics" - Innovation Friday!', 'success');
            console.log('üìÖ Innovation Friday RSVP confirmed:', {
                event: 'Future of Motion Graphics',
                timestamp: new Date().toISOString()
            });
        }

        // Resource download function
        function downloadResource(resourceType) {
            const resourceNames = {
                'brand-guidelines': 'Brand Guidelines v3.2',
                'handbook': 'Employee Handbook 2024',
                'best-practices': 'Creative Best Practices',
                'onboarding': 'Client Onboarding Guide'
            };
            
            const resourceName = resourceNames[resourceType] || 'Resource';
            showNotification(`Downloading ${resourceName}...`, 'success');
            
            console.log('üìÑ Resource download initiated:', {
                resource: resourceName,
                type: resourceType,
                timestamp: new Date().toISOString()
            });
        }

        // Access template function
        function accessTemplate(templateType) {
            const templateNames = {
                'presentation': 'Presentation Template',
                'project-brief': 'Project Brief Template',
                'invoice': 'Invoice Template',
                'tutorials': 'Software Tutorials',
                'communication': 'Client Communication Guide',
                'pm-basics': 'PM Basics Training'
            };
            
            const templateName = templateNames[templateType] || 'Template';
            showNotification(`Opening ${templateName}...`, 'success');
            
            console.log('üìã Template access:', {
                template: templateName,
                type: templateType,
                timestamp: new Date().toISOString()
            });
        }

        // Scroll to section function for tabs
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Update active tab
                const tabs = section.closest('.window').querySelectorAll('.module-tab');
                tabs.forEach(tab => tab.classList.remove('active'));
                event.target.classList.add('active');
            }
        }

        // Check scroll position for back to top button
        function checkScrollPosition(container) {
            const module = container.closest('.window');
            const backToTopBtn = module.querySelector('.back-to-top');
            if (backToTopBtn) {
                if (container.scrollTop > 300) {
                    backToTopBtn.style.display = 'block';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            }
        }

        // Scroll to top function
        function scrollToTop(moduleId) {
            const module = document.getElementById(moduleId);
            if (module) {
                const content = module.querySelector('.dashboard-content') || module.querySelector('.window-content');
                if (content) {
                    content.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }
        }

        // Show Leadership Window
        function showLeadershipWindow() {
            // Create or show the leadership window
            let leadershipWindow = document.getElementById('leadership-window');
            if (!leadershipWindow) {
                leadershipWindow = document.createElement('div');
                leadershipWindow.id = 'leadership-window';
                leadershipWindow.className = 'window active';
                leadershipWindow.style.width = '800px';
                leadershipWindow.style.height = '600px';
                leadershipWindow.style.top = '100px';
                leadershipWindow.style.left = '200px';
                leadershipWindow.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">üè¢ Leadership Team</div>
                        <div class="window-controls">
                            <button class="window-button" onclick="minimizeWindow('leadership-window')">_</button>
                            <button class="window-button" onclick="maximizeWindow('leadership-window')">‚ñ°</button>
                            <button class="window-button" onclick="closeWindow('leadership-window')">X</button>
                        </div>
                    </div>
                    <div class="window-content" style="padding: 20px; overflow: auto;">
                        <div class="leadership-org-chart">
                            <div class="leadership-row leadership-ceo">
                                <div class="leadership-member">
                                    <img src="headshots/placeholder_CEO.png" alt="CEO" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Chief Executive Officer</h4>
                                        <p>Strategic Vision & Company Direction</p>
                                    </div>
                                </div>
                            </div>
                            <div class="leadership-row leadership-executives">
                                <div class="leadership-member">
                                    <img src="headshots/placeholder_COO.png" alt="COO" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Chief Operating Officer</h4>
                                        <p>Operations & Business Development</p>
                                    </div>
                                </div>
                                <div class="leadership-member">
                                    <img src="headshots/placeholder_CD.png" alt="Creative Director" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Creative Director</h4>
                                        <p>Creative Vision & Project Leadership</p>
                                    </div>
                                </div>
                                <div class="leadership-member">
                                    <img src="headshots/placeholder_CTO.png" alt="CTO" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Chief Technology Officer</h4>
                                        <p>Technology Strategy & Innovation</p>
                                    </div>
                                </div>
                            </div>
                            <div class="leadership-row leadership-directors">
                                <div class="leadership-member">
                                    <img src="headshots/8bit_Gareth.png" alt="Gareth" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Gareth - Head of Growth</h4>
                                        <p>Business Development & Partnerships</p>
                                    </div>
                                </div>
                                <div class="leadership-member">
                                    <img src="headshots/8bit_Brook-closed.png" alt="Brook" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Brook - Innovation Lead</h4>
                                        <p>Emerging Technology & R&D</p>
                                    </div>
                                </div>
                                <div class="leadership-member">
                                    <img src="headshots/8bit_Ronda.png" alt="Ronda" class="leadership-headshot">
                                    <div class="leadership-info">
                                        <h4>Ronda - Community Manager</h4>
                                        <p>Team Culture & Communications</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                document.querySelector('.desktop').appendChild(leadershipWindow);
            } else {
                leadershipWindow.classList.add('active');
            }
            
            // Make it draggable
            if (!AppState.windows['leadership-window']) {
                AppState.windows['leadership-window'] = { draggable: null };
                makeDraggable(leadershipWindow);
            }
            
            // Bring window to front
            bringToFront(leadershipWindow);
            
            console.log('üè¢ Leadership window opened');
        }

        // Add new premiere function
        async function addNewPremiere() {
            const dateInput = document.getElementById('premiereDate');
            const titleInput = document.getElementById('premiereTitle');
            const liveLinkInput = document.getElementById('premiereLiveLink');
            
            if (!dateInput || !titleInput || !liveLinkInput) return;
            
            const date = dateInput.value;
            const title = titleInput.value.trim();
            const liveLink = liveLinkInput.value.trim();
            
            if (!date || !title) {
                showNotification('Please enter both date and title for the premiere.');
                return;
            }
            
            // Format the date for display
            const premiereDate = new Date(date);
            const formattedDate = premiereDate.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric' 
            });
            
            // Determine if this is "thisMonth" or "nextMonth"
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            const premiereMonth = premiereDate.getMonth();
            const premiereYear = premiereDate.getFullYear();
            
            let targetSection = 'nextMonth'; // Default to nextMonth
            if (premiereYear === currentYear && premiereMonth === currentMonth) {
                targetSection = 'thisMonth';
            }
            
            try {
                // Get current config
                const response = await fetch(`/api/get-config?t=${Date.now()}`);
                const currentConfig = await response.json();
                
                // Create new premiere object
                const newPremiere = {
                    date: formattedDate,
                    project: title,
                    liveLink: liveLink || ""
                };
                
                // Ensure premieres module exists
                if (!currentConfig.modules.premieres) {
                    currentConfig.modules.premieres = {
                        windowTitle: "Premiere Calendar",
                        headerTitle: "Premiere Calendar", 
                        icon: "üé¨",
                        enabled: true,
                        description: "Track project launches and debut dates ‚Ä¢ Add upcoming premieres",
                        content: {
                            thisMonth: [],
                            nextMonth: []
                        }
                    };
                }
                
                // Ensure content section exists
                if (!currentConfig.modules.premieres.content) {
                    currentConfig.modules.premieres.content = {
                        thisMonth: [],
                        nextMonth: []
                    };
                }
                
                // Add to appropriate section
                if (!currentConfig.modules.premieres.content[targetSection]) {
                    currentConfig.modules.premieres.content[targetSection] = [];
                }
                currentConfig.modules.premieres.content[targetSection].push(newPremiere);
                
                // Save updated config
                console.log('üîÑ Saving premiere to config:', newPremiere);
                console.log('üîÑ Full config being saved:', currentConfig);
                
                const saveResponse = await fetch('/api/save-config', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        configData: currentConfig,
                        lastModified: Date.now()
                    })
                });
                
                const responseData = await saveResponse.text();
                console.log('üì§ Save response:', saveResponse.status, responseData);
                
                if (saveResponse.ok) {
                    showNotification(`Premiere added: "${title}" on ${formattedDate}`);
                    
                    // Update the display immediately
                    if (AppState.config) {
                        AppState.config = currentConfig;
                        const premiereWindow = document.getElementById('premieres');
                        if (premiereWindow) {
                            updatePremieresContent(premiereWindow, currentConfig.modules.premieres.content);
                        }
                    }
                    
                    // Clear the form
                    dateInput.value = '';
                    titleInput.value = '';
                    liveLinkInput.value = '';
                } else {
                    console.error('‚ùå Save failed:', responseData);
                    showNotification('Failed to save premiere. Please try again.');
                }
            } catch (error) {
                console.error('Error adding premiere:', error);
                showNotification('Error adding premiere. Please try again.');
            }
            
            // Log for debugging
            console.log('üé¨ New Premiere Added:', {
                date: date,
                formattedDate: formattedDate,
                title: title,
                liveLink: liveLink,
                targetSection: targetSection,
                timestamp: new Date().toISOString()
            });
        }


        // Send shoutout function
        function sendShoutout() {
            const nameInput = document.getElementById('shoutoutName');
            const messageInput = document.getElementById('shoutoutMessage');
            
            if (!nameInput || !messageInput) return;
            
            const name = nameInput.value.trim();
            const message = messageInput.value.trim();
            
            if (!name || !message) {
                showNotification('Please enter your name and message.', 'warning');
                return;
            }
            
            // For now, this will show a confirmation and clear the form
            // In a real implementation, this would add to the shoutouts list
            showNotification(`Shoutout sent from ${name}: "${message.substring(0, 30)}${message.length > 30 ? '...' : ''}"`, 'success');
            
            // Clear the form
            nameInput.value = '';
            messageInput.value = '';
            
            // Log for debugging
            console.log('üì¢ Shoutout Sent:', {
                from: name,
                message: message,
                timestamp: new Date().toISOString()
            });
        }
        
        // Open document in iframe window
        function openIframe(url, title) {
            // Create iframe window
            const iframeWindow = document.createElement('div');
            iframeWindow.className = 'window';
            iframeWindow.style.cssText = `
                top: 80px; 
                left: 80px; 
                width: 800px; 
                height: 600px; 
                z-index: ${AppState.zIndex++};
            `;
            
            iframeWindow.innerHTML = `
                <div class="window-header">
                    <div class="window-title">üìÑ ${title}</div>
                    <div class="window-controls">
                        <button class="window-button" onclick="this.parentElement.parentElement.parentElement.remove()">X</button>
                    </div>
                </div>
                <div class="window-content" style="padding: 0;">
                    <iframe src="${url}" style="width: 100%; height: 100%; border: none;" frameborder="0"></iframe>
                </div>
            `;
            
            document.body.appendChild(iframeWindow);
            makeDraggable(iframeWindow);
        }

        function loadModuleContentFromCMS(moduleId) {
            // Loading content from CMS
            if (!AppState.config || !AppState.config.modules) {
                console.log('‚ö†Ô∏è No config available, skipping content load');
                return;
            }
            
            const moduleConfig = AppState.config.modules[moduleId];
            if (!moduleConfig || !moduleConfig.enabled) {
                console.log(`‚ö†Ô∏è Module ${moduleId} not found or disabled`);
                return;
            }
            
            const windowElement = document.getElementById(moduleId);
            if (windowElement) {
                const title = windowElement.querySelector('.window-title');
                if (title) {
                    title.textContent = `${moduleConfig.icon} ${moduleConfig.title}`;
                }
                
                // Update module description (skip for redesigned modules)
                const redesignedModules = ['suggestions', 'announcements', 'links', 'innovation', 'resources', 'pitchPlease'];
                if (!redesignedModules.includes(moduleId)) {
                    const contentArea = windowElement.querySelector('.window-content');
                    if (contentArea && moduleConfig.description) {
                        let existingDescription = contentArea.querySelector('.module-description');
                        if (!existingDescription) {
                            existingDescription = document.createElement('div');
                            existingDescription.className = 'module-description';
                            contentArea.insertBefore(existingDescription, contentArea.firstChild);
                        }
                        existingDescription.textContent = moduleConfig.description;
                    }
                }
                
                // Update specific module content
                if (moduleId === 'newBiz' && moduleConfig.content) {
                    console.log('üìä Loading New Business Pipeline content');
                    loadPipelineData(moduleConfig.content);
                } else if (moduleId === 'shoutouts' && moduleConfig.content) {
                    updateShoutoutsContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'premieres' && moduleConfig.content) {
                    updatePremieresContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'ralphNews' && moduleConfig.content) {
                    updateRalphNewsContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'suggestions' && moduleConfig.content) {
                    updateSuggestionsContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'announcements' && moduleConfig.content) {
                    updateAnnouncementsContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'articles' && moduleConfig.content) {
                    updateArticlesContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'innovation' && moduleConfig.content) {
                    updateInnovationContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'resources' && moduleConfig.content) {
                    updateResourcesContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'links' && moduleConfig.content) {
                    updateLinksContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'pitchPlease' && moduleConfig.content) {
                    updatePitchPleaseContent(windowElement, moduleConfig.content);
                } else if (moduleId === 'ralphNews' && moduleConfig.content) {
                    updateRalphNewsContent(windowElement, moduleConfig.content);
                }
            }
        }

        // Initialize chatbot content from CMS
        function initializeChatbotContent() {
            const chatDisplay = document.getElementById('chatDisplay');
            if (!chatDisplay || !AppState.config?.chatbot) return;
            
            const chatbotConfig = AppState.config.chatbot;
            chatDisplay.innerHTML = `
                <div style="color: #EB008B;">=======================================</div>
                <div style="color: #EB008B;">${chatbotConfig.title || 'RALPH ASSISTANT v1.0'} - INITIALIZED</div>
                <div style="color: #EB008B;">=======================================</div>
                <div style="margin-top: 10px;">
                    <span style="color: #ffff00;">ASSISTANT:</span> ${chatbotConfig.introText || 'Welcome to RALPH\'s assistant!'}
                </div>
                <div style="margin-top: 10px;">
                    ${chatbotConfig.promptText || 'Type your message below!'}
                </div>
                <div style="margin-top: 10px; color: #00ff00;" class="blink">
                    > _
                </div>
            `;
        }

        // Initialize info panel content from CMS
        function initializeInfoPanelContent() {
            const infoWindow = document.getElementById('info');
            if (!infoWindow || !AppState.config?.infoPanel) return;
            
            const infoPanelConfig = AppState.config.infoPanel;
            const windowContent = infoWindow.querySelector('.window-content');
            if (!windowContent) return;
            
            // Update window title
            const windowTitle = infoWindow.querySelector('.window-title');
            if (windowTitle) {
                windowTitle.textContent = infoPanelConfig.title || 'üìä RALPH Intranet Info';
            }
            
            // Generate sections HTML
            let sectionsHTML = '';
            if (infoPanelConfig.sections) {
                infoPanelConfig.sections.forEach(section => {
                    sectionsHTML += `
                        <div style="margin-bottom: 25px;">
                            <h3 style="color: ${section.icon || 'var(--ralph-green)'}; margin-bottom: 15px; font-size: 16px;">${section.title}</h3>
                            ${section.description ? `<p>${section.description}</p>` : ''}
                            
                            ${section.items ? `
                                <ul style="margin: 15px 0; padding-left: 20px; color: #333;">
                                    ${section.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            ` : ''}
                            
                            ${section.features ? `
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                                    ${section.features.map(feature => `
                                        <div style="padding: 15px; background: #f9f9f9; border-radius: 8px;">
                                            <strong style="color: ${feature.color};">${feature.title}</strong><br>
                                            ${feature.description}
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                    `;
                });
            }
            
            // Update content
            windowContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 18px; font-weight: bold; color: var(--ralph-pink); margin-bottom: 10px;">
                        ${infoPanelConfig.welcome?.title || 'üè¢ WELCOME TO RALPH\'S RETRO INTRANET SYSTEM'}
                    </div>
                    <div style="font-size: 12px; color: #666;">
                        ${infoPanelConfig.subtitle || 'Version 2.0 | Built with ‚ô•Ô∏è by the RALPH team'}
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <p>${infoPanelConfig.welcome?.description || 'This retro-inspired intranet brings together all your RALPH tools, updates, and team connections in one nostalgic interface.'}</p>
                </div>
                
                ${sectionsHTML}
                
                <div style="background: var(--ralph-pink); color: white; padding: 15px; border-radius: 8px; text-align: center; margin-top: 30px;">
                    <strong>${infoPanelConfig.footer?.title || 'üåü Have ideas for new features?'}</strong><br>
                    ${infoPanelConfig.footer?.message || 'Use the Suggestion Box to share your thoughts!'}
                </div>
            `;
        }

        function loadContentFromCMS() {
            // Loading CMS content
            if (!AppState.config) {
                console.log('‚ö†Ô∏è No config available, skipping content load');
                return;
            }
            console.log('üìù Loading modules:', Object.keys(AppState.config.modules || {}));
            
            // Update chatbot welcome message
            const welcomeArea = document.querySelector('#chatDisplay');
            if (welcomeArea && AppState.config.chatbot) {
                const chatConfig = AppState.config.chatbot;
                welcomeArea.innerHTML = `
                    <div style="color: #EB008B;">=======================================</div>
                    <div style="color: #EB008B;">${chatConfig.title.toUpperCase()} - INITIALIZED</div>
                    <div style="color: #EB008B;">=======================================</div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ffff00;">ASSISTANT:</span> ${chatConfig.welcomeMessage}
                    </div>
                    <div style="margin-top: 10px;">
                        ${chatConfig.helpText}
                    </div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ffff00;">TIP:</span> Press ESC to close all windows
                    </div>
                    <div style="margin-top: 10px;">
                        Type 'help' for more commands or ask me anything!
                    </div>
                    <div style="margin-top: 10px; color: #00ff00;" class="blink">
                        > _
                    </div>
                `;
            }
            
            // Update module icons and titles
            Object.entries(AppState.config.modules).forEach(([moduleId, moduleConfig]) => {
                if (!moduleConfig.enabled) {
                    const icon = document.querySelector(`[onclick="openWindow('${moduleId}')"]`);
                    if (icon) icon.style.display = 'none';
                    return;
                }
                
                const windowElement = document.getElementById(moduleId);
                if (windowElement) {
                    const title = windowElement.querySelector('.window-title');
                    if (title) {
                        // Use new windowTitle field, fallback to old title field for backward compatibility
                        const windowTitleText = moduleConfig.windowTitle || moduleConfig.title || 'Module';
                        
                        // Handle special icon types for window titles
                        let windowIcon = moduleConfig.icon;
                        if (moduleConfig.iconType === 'rnn-logo') {
                            title.innerHTML = `üì¢ <span class="rnn-logo">RNN</span> ${windowTitleText}`;
                        } else if (moduleConfig.iconType === 'text') {
                            const color = moduleConfig.iconColor || '#000';
                            title.innerHTML = `<span style="color: ${color}; font-weight: bold;">${moduleConfig.icon}</span> ${windowTitleText}`;
                        } else {
                            title.textContent = `${windowIcon} ${windowTitleText}`;
                        }
                    }
                    
                    // Update internal header title (h2 elements)
                    const headerTitle = windowElement.querySelector('h2[class$="-title"]');
                    if (headerTitle) {
                        // Use new headerTitle field, fallback to windowTitle or title for backward compatibility
                        const headerTitleText = moduleConfig.headerTitle || moduleConfig.windowTitle || moduleConfig.title || 'Module';
                        headerTitle.textContent = headerTitleText;
                    }
                    
                    // Update subtitle/description
                    const subtitle = windowElement.querySelector('[class$="-subtitle"]');
                    if (subtitle && moduleConfig.description) {
                        subtitle.textContent = moduleConfig.description;
                    }
                    
                    // Update specific module content
                    if (moduleId === 'newBiz' && moduleConfig.content) {
                        loadPipelineData(moduleConfig.content);
                    } else if (moduleId === 'shoutouts' && moduleConfig.content) {
                        updateShoutoutsContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'premieres' && moduleConfig.content) {
                        updatePremieresContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'ralphNews' && moduleConfig.content) {
                        updateRalphNewsContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'suggestions' && moduleConfig.content) {
                        updateSuggestionsContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'announcements' && moduleConfig.content) {
                        updateAnnouncementsContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'articles' && moduleConfig.content) {
                        updateArticlesContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'innovation' && moduleConfig.content) {
                        updateInnovationContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'resources' && moduleConfig.content) {
                        updateResourcesContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'links' && moduleConfig.content) {
                        updateLinksContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'pitchPlease' && moduleConfig.content) {
                        updatePitchPleaseContent(windowElement, moduleConfig.content);
                    } else if (moduleId === 'trendspotting' && moduleConfig.content) {
                        updateTrendspottingContent(windowElement, moduleConfig.content);
                    }
                }
            });
        }

        // Update New Business Pipeline content dynamically
        function updateNewBizContent(windowElement, content) {
            console.log('üîÑ Updating New Biz Pipeline content:', content);
            
            const windowContent = windowElement.querySelector('.window-content');
            if (!windowContent) return;
            
            // Pipeline stage definitions
            const stages = {
                warmLeads: { name: 'WARM LEADS', color: '#ef4444' },
                pitchesHappening: { name: 'PITCHES HAPPENING', color: '#f97316' },
                pitchSubmitted: { name: 'PITCH SUBMITTED', color: '#eab308' },
                pitchPresented: { name: 'PITCH PRESENTED', color: '#22c55e' },
                pitchWon: { name: 'PITCH WON', color: '#3b82f6' }
            };
            
            // Build pipeline columns HTML
            let pipelineHtml = '';
            Object.entries(stages).forEach(([stageKey, stage]) => {
                const items = content[stageKey] || [];
                const count = items.length;
                
                let itemsHtml = '';
                items.forEach(item => {
                    const deckLinkHtml = item.deckLink ? 
                        `<button onclick="openIframeWindow('${item.deckLink}', '${item.name} - Deck', 900, 700)" style="background: #EB008B; color: white; border: none; padding: 4px 8px; margin: 2px; cursor: pointer; border-radius: 2px; font-size: 12px; font-family: 'Space Mono', monospace;">[DECK]</button>` : '';
                    const briefLinkHtml = item.briefLink ? 
                        `<button onclick="openIframeWindow('${item.briefLink}', '${item.name} - Brief', 900, 700)" style="background: #059669; color: white; border: none; padding: 4px 8px; margin: 2px; cursor: pointer; border-radius: 2px; font-size: 12px; font-family: 'Space Mono', monospace;">[BRIEF]</button>` : '';
                    
                    // Smart data detection in case fields are swapped
                    let dueDate = '';
                    let office = '';
                    
                    // Check if dueDate looks like a date (contains numbers) or office code
                    if (item.dueDate && item.dueDate.match(/\d{4}-\d{2}-\d{2}/)) {
                        dueDate = new Date(item.dueDate).toLocaleDateString();
                    } else if (item.dueDate && item.dueDate.match(/^(LON|NY|LA|TK)$/)) {
                        office = `[${item.dueDate}]`; // dueDate field contains office
                    }
                    
                    // Check if office looks like a date or office code
                    if (item.office && item.office.match(/\d{4}-\d{2}-\d{2}/)) {
                        dueDate = new Date(item.office).toLocaleDateString(); // office field contains date
                    } else if (item.office && item.office.match(/^(LON|NY|LA|TK)$/)) {
                        office = `[${item.office}]`;
                    }
                    
                    itemsHtml += `
                        <div class="pipeline-item" style="background: rgba(0,0,0,0.3); padding: 8px; margin: 4px 0; border-radius: 4px; font-size: 11px;">
                            <div style="font-weight: bold; color: white; margin-bottom: 4px;">${item.name}</div>
                            <div style="color: #b0b0b0; margin-bottom: 4px;">
                                ${dueDate ? `üìÖ ${dueDate}` : ''} ${office}
                            </div>
                            <div>${deckLinkHtml}${briefLinkHtml}</div>
                        </div>
                    `;
                });
                
                pipelineHtml += `
                    <div class="pipeline-column" style="flex: 1; margin: 0 4px; min-height: 200px;">
                        <div class="pipeline-header" style="background: ${stage.color}; color: white; padding: 8px; text-align: center; font-weight: bold; font-size: 11px; margin-bottom: 8px; border-radius: 4px;">
                            ${stage.name} <span style="background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 10px; margin-left: 4px;">(${count})</span>
                        </div>
                        <div class="pipeline-items" style="min-height: 150px;">
                            ${itemsHtml}
                        </div>
                    </div>
                `;
            });
            
            // Update the window content with horizontal layout
            windowContent.innerHTML = `
                <div class="ascii-art" style="margin-bottom: 12px;">
    ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
    ‚ïë  ${content.header || 'RALPH PIPELINE TRACKER 1.0'}  ‚ïë
    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                </div>
                <div class="pipeline-container" style="display: flex; gap: 8px; height: 250px; overflow-x: auto;">
                    ${pipelineHtml}
                </div>
            `;
            
            console.log('‚úÖ New Biz Pipeline content updated successfully');
        }

        // Update Industry Articles content dynamically
        function updateArticlesContent(windowElement, content) {
            console.log('üîÑ Updating Industry Articles content:', content);
            
            const trendingContainer = document.getElementById('trendingArticles');
            const mustReadContainer = document.getElementById('mustReadArticles');
            
            if (!trendingContainer || !mustReadContainer) {
                console.log('‚ö†Ô∏è Article containers not found');
                return;
            }
            
            // Clear existing content
            trendingContainer.innerHTML = '';
            mustReadContainer.innerHTML = '';
            
            // Build trending articles
            if (content.trending) {
                content.trending.forEach((article, index) => {
                    const title = typeof article === 'string' ? article : (article.title || '');
                    const url = typeof article === 'object' ? (article.url || '') : '';
                    const submittedBy = typeof article === 'object' ? (article.submittedBy || 'RALPH Team') : 'RALPH Team';
                    const date = typeof article === 'object' ? (article.date || new Date().toLocaleDateString()) : new Date().toLocaleDateString();
                    const source = typeof article === 'object' ? (article.source || 'Industry News') : 'Industry News';
                    
                    const articleEl = document.createElement('div');
                    articleEl.className = 'article-card';
                    articleEl.dataset.url = url;
                    articleEl.dataset.title = title;
                    articleEl.onclick = () => selectArticleForViewing(url, title, articleEl);
                    
                    articleEl.innerHTML = `
                        <div class="article-card-title">${title}</div>
                        <div class="article-card-metadata">Submitted by ${submittedBy} on ${date}</div>
                        <div class="article-card-source">${source}</div>
                    `;
                    
                    trendingContainer.appendChild(articleEl);
                });
            }
            
            // Build must reads
            if (content.mustReads) {
                content.mustReads.forEach((item, index) => {
                    const title = item.title || '';
                    const url = item.url || '';
                    const source = item.source || 'Unknown Source';
                    const submittedBy = item.submittedBy || 'Editorial Team';
                    const date = item.date || new Date().toLocaleDateString();
                    
                    const articleEl = document.createElement('div');
                    articleEl.className = 'article-card';
                    articleEl.dataset.url = url;
                    articleEl.dataset.title = title;
                    articleEl.onclick = () => selectArticleForViewing(url, title, articleEl);
                    
                    articleEl.innerHTML = `
                        <div class="article-card-title">${title}</div>
                        <div class="article-card-metadata">Submitted by ${submittedBy} on ${date}</div>
                        <div class="article-card-source">${source}</div>
                    `;
                    
                    mustReadContainer.appendChild(articleEl);
                });
            }
            
            console.log('‚úÖ Industry Articles content updated successfully');
        }
        
        // Select and display article in iframe
        function selectArticleForViewing(url, title, element) {
            // Remove selection from other articles
            document.querySelectorAll('.article-card').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Add selection to clicked article
            element.classList.add('selected');
            
            if (!url) {
                showNotification('No URL available for this article.');
                return;
            }
            
            // Check for domains that typically block iframes due to CSP
            const blockedDomains = [
                'adage.com',
                'campaignlive.com', 
                'techcrunch.com',
                'theverge.com',
                'wired.com',
                'forbes.com',
                'bloomberg.com',
                'reuters.com',
                'cnn.com',
                'bbc.com',
                'guardian.com',
                'nytimes.com',
                'washingtonpost.com'
            ];
            
            const urlObj = new URL(url);
            const isBlocked = blockedDomains.some(domain => urlObj.hostname.includes(domain));
            
            if (isBlocked) {
                // Open in new tab for blocked domains
                window.open(url, '_blank', 'noopener,noreferrer');
                showNotification(`Opening "${title}" in new tab (site blocks iframes)`);
                return;
            }
            
            // Show iframe and hide placeholder for allowed domains
            const iframe = document.getElementById('articleFrame');
            const placeholder = document.getElementById('articlesPlaceholder');
            
            if (iframe && placeholder) {
                iframe.src = url;
                iframe.style.display = 'block';
                placeholder.style.display = 'none';
                
                console.log(`üì∞ Loading article: ${title}`);
                showNotification(`Loading: ${title}`);
            }
        }
        
        // Add new article function
        function addNewArticle() {
            const titleInput = document.getElementById('articleTitle');
            const urlInput = document.getElementById('articleUrl');
            const sourceInput = document.getElementById('articleSource');
            const submitterInput = document.getElementById('articleSubmitter');
            
            if (!titleInput || !urlInput || !sourceInput || !submitterInput) {
                console.log('‚ö†Ô∏è Article form inputs not found');
                return;
            }
            
            const title = titleInput.value.trim();
            const url = urlInput.value.trim();
            const source = sourceInput.value.trim();
            const submitter = submitterInput.value.trim();
            
            if (!title || !url || !source || !submitter) {
                showNotification('Please fill in all fields to add an article.', 'warning');
                return;
            }
            
            // For now, this will show a confirmation and clear the form
            // In a real implementation, this would add to the CMS and save to database
            showNotification(`Article "${title}" from ${source} submitted successfully!`, 'success');
            
            // Clear the form
            titleInput.value = '';
            urlInput.value = '';
            sourceInput.value = '';
            submitterInput.value = '';
            
            // Log for debugging
            console.log('üì∞ New Article Added:', {
                title: title,
                url: url,
                source: source,
                submittedBy: submitter,
                date: new Date().toLocaleDateString(),
                timestamp: new Date().toISOString()
            });
        }

        // Ralph News Network Functions
        let presenterAnimationInterval;
        
        // Animate the presenter (Hassell character) with realistic speech patterns
        function startPresenterAnimation() {
            const presenterImage = document.getElementById('presenterImage');
            if (!presenterImage) return;
            
            let isOpen = true;
            let isSpeaking = false;
            let speechBurstCount = 0;
            let maxBurstLength = 0;
            
            function scheduleNextFrame() {
                let delay;
                
                if (!isSpeaking) {
                    // Start a speaking burst
                    isSpeaking = true;
                    maxBurstLength = 3 + Math.floor(Math.random() * 8); // 3-10 mouth movements per burst
                    speechBurstCount = 0;
                    delay = 100 + Math.random() * 150; // Quick start to speaking
                } else if (speechBurstCount < maxBurstLength) {
                    // Continue speaking burst
                    speechBurstCount++;
                    delay = 80 + Math.random() * 120; // Fast mouth movements during speech
                } else {
                    // End speaking burst, start pause
                    isSpeaking = false;
                    speechBurstCount = 0;
                    delay = 500 + Math.random() * 2000; // Pause between 0.5-2.5 seconds
                    // Reset to closed mouth during pause
                    presenterImage.src = 'headshots/8bit_Hassell-closed.png';
                    isOpen = false;
                }
                
                presenterAnimationInterval = setTimeout(() => {
                    if (isSpeaking) {
                        // Rapid mouth movement during speech
                        presenterImage.src = isOpen ? 
                            'headshots/8bit_Hassell-closed.png' : 
                            'headshots/8bit_Hassell-open.png';
                        isOpen = !isOpen;
                    }
                    scheduleNextFrame();
                }, delay);
            }
            
            scheduleNextFrame();
        }
        
        // Stop presenter animation
        function stopPresenterAnimation() {
            if (presenterAnimationInterval) {
                clearTimeout(presenterAnimationInterval);
                presenterAnimationInterval = null;
            }
        }
        
        // Presenter hover sound effects
        let hoverAudio = null;
        
        function initializePresenterHoverSound() {
            const presenterImage = document.getElementById('presenterImage');
            if (!presenterImage) return;
            
            // Create audio element
            hoverAudio = new Audio('music/blahblah.mp3');
            hoverAudio.loop = true;
            hoverAudio.volume = 0.3; // Set volume to 30%
            
            // Add hover event listeners
            presenterImage.addEventListener('mouseenter', function() {
                if (hoverAudio) {
                    hoverAudio.currentTime = 0; // Reset to beginning
                    hoverAudio.play().catch(console.error);
                }
            });
            
            presenterImage.addEventListener('mouseleave', function() {
                if (hoverAudio) {
                    hoverAudio.pause();
                    hoverAudio.currentTime = 0; // Reset for next hover
                }
            });
        }
        
        // Update Ralph News Network content
        function updateRalphNewsContent(windowElement, content) {
            console.log('üîÑ Updating Ralph News Network content:', content);
            
            // Update ticker
            const ticker = document.getElementById('newsTicker');
            if (ticker && content.ticker) {
                let tickerText = content.ticker.map(item => item.text || item).join(' ‚Ä¢ ');
                ticker.textContent = tickerText;
            }
            
            // Update main headline
            const mainHeadline = document.getElementById('mainHeadline');
            if (mainHeadline && content.mainStory) {
                const story = content.mainStory;
                mainHeadline.innerHTML = `
                    <div class="headline-story" onclick="expandStory('main', '${story.id}')">
                        ${story.image ? `<img src="${story.image}" alt="${story.title}" class="headline-image">` : ''}
                        <div class="headline-content">
                            <h1 class="headline-title">${story.title}</h1>
                            <p class="headline-excerpt">${story.excerpt}</p>
                            <div class="headline-meta">
                                ${story.author} ‚Ä¢ ${story.date} ‚Ä¢ ${story.category}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Update secondary stories
            const secondaryStories = document.getElementById('secondaryStories');
            if (secondaryStories && content.secondaryStories) {
                secondaryStories.innerHTML = '';
                content.secondaryStories.forEach((story, index) => {
                    const storyCard = document.createElement('div');
                    storyCard.className = 'story-card';
                    storyCard.onclick = () => expandStory('secondary', story.id);
                    
                    storyCard.innerHTML = `
                        ${story.image ? `<img src="${story.image}" alt="${story.title}" class="story-image">` : ''}
                        <div class="story-content">
                            <h3 class="story-title">${story.title}</h3>
                            <p class="story-excerpt">${story.excerpt}</p>
                            <div class="story-meta">${story.author} ‚Ä¢ ${story.date}</div>
                        </div>
                    `;
                    
                    secondaryStories.appendChild(storyCard);
                });
            }
            
            // Update sidebar stories
            const sidebarStories = document.getElementById('sidebarStories');
            if (sidebarStories && content.sidebarStories) {
                sidebarStories.innerHTML = '<h3 class="sidebar-title">More News</h3>';
                content.sidebarStories.forEach(story => {
                    const sidebarStory = document.createElement('div');
                    sidebarStory.className = 'sidebar-story';
                    sidebarStory.onclick = () => expandStory('sidebar', story.id);
                    
                    sidebarStory.innerHTML = `
                        <h4 class="sidebar-story-title">${story.title}</h4>
                        <p class="sidebar-story-excerpt">${story.excerpt}</p>
                        <div class="sidebar-story-meta">${story.author} ‚Ä¢ ${story.date}</div>
                    `;
                    
                    sidebarStories.appendChild(sidebarStory);
                });
            }
            
            console.log('‚úÖ Ralph News Network content updated successfully');
        }
        
        // Sample story data for placeholder content
        const placeholderStories = {
            'main-1': {
                id: 'main-1',
                title: 'RALPH Announces Major Expansion with New Tokyo Office',
                fullContent: `RALPH, the award-winning creative agency, today announced a major expansion of their Tokyo office operations set to begin in Q2 2025. The expansion will see the addition of 50 new positions across multiple departments including creative, strategy, production, and client services.

"This expansion represents our commitment to the Asian market and our belief in the incredible talent pool in Tokyo," said Chris Hassell, Co-Founder of RALPH. "We're not just growing our footprint - we're investing in the future of creative excellence in this region."

The new hires will support RALPH's growing roster of Asian clients and help establish new partnerships with major brands looking to expand their presence in Western markets. The expansion is expected to be completed by September 2025.

The Tokyo office, currently located in Level 11, Aoyama Palacio Tower, will be relocating to a larger space to accommodate the additional staff. The new office will feature state-of-the-art creative studios, collaboration spaces, and cutting-edge technology.

"Our Tokyo team has been instrumental in some of our most innovative campaigns," added Yuki Koizumi, Managing Director of RALPH Tokyo. "This expansion will allow us to take on even more ambitious projects and serve our clients better."`,
                author: 'RALPH Communications Team',
                date: 'December 24, 2024',
                category: 'Company News',
                image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI0VCMDAzQiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjI0IiBmaWxsPSJ3aGl0ZSI+UkFMUEggVG9reW8gRXhwYW5zaW9uPC90ZXh0Pjwvc3ZnPg=='
            },
            'secondary-1': {
                id: 'secondary-1',
                title: 'Award Win: Best Digital Campaign at Industry Awards',
                fullContent: `RALPH's innovative social media campaign for BeReal has been recognized as the Best Digital Campaign at the prestigious Digital Marketing Excellence Awards. The campaign, which ran across multiple platforms and generated over 50 million impressions, showcased the authentic moments that make life real.

The winning campaign featured user-generated content, interactive experiences, and a unique approach to authentic storytelling that resonated with audiences globally. "This award validates our belief that authenticity beats perfection every time," commented Jeremy Groff, Managing Director of RALPH LA.

The campaign included a series of unfiltered moments from real users, celebrity partnerships that felt genuine, and interactive installations in major cities worldwide. The strategy focused on celebrating imperfection and real moments over polished content.`,
                author: 'Awards Team',
                date: 'December 22, 2024',
                image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzMxQkRCRiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjI0IiBmaWxsPSJ3aGl0ZSI+QXdhcmQgV2luPC90ZXh0Pjwvc3ZnPg=='
            },
            'secondary-2': {
                id: 'secondary-2', 
                title: 'New Partnership with Streaming Giant Announced',
                fullContent: `In a significant move into entertainment production, RALPH has announced a new partnership with a major streaming platform to create a series of original branded content pieces. The partnership will see RALPH produce monthly content that blends entertainment with brand storytelling.

"This partnership represents the evolution of advertising into entertainment," said Tom Winbow, Managing Director of RALPH London. "We're not just creating ads anymore - we're creating content that people actually want to watch."

The first series will launch in early 2025 and will feature documentaries about creative processes, behind-the-scenes content from major campaigns, and original series that showcase innovative brand partnerships.`,
                author: 'Business Development',
                date: 'December 20, 2024',
                image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI0YxNjUyNCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBmb250LXNpemU9IjE4IiBmaWxsPSJ3aGl0ZSI+U3RyZWFtaW5nIFBhcnRuZXJzaGlwPC90ZXh0Pjwvc3ZnPg=='
            },
            'sidebar-1': {
                id: 'sidebar-1',
                title: 'Holiday Party Details Announced',
                fullContent: `RALPH's annual holiday celebration is set for December 20th, 2024, with all offices participating in a global virtual event. The celebration will feature special appearances from industry leaders, live entertainment, and prize giveaways for all employees.

This year's theme is "Creative Connections" and will include virtual rooms for each office to showcase their year's best work, interactive games, and networking opportunities across all global locations.`,
                author: 'People & Culture',
                date: 'December 15, 2024'
            }
        };
        
        // Expand story functionality
        function expandStory(section, storyId) {
            console.log(`üì∞ Expanding story: ${section}-${storyId}`);
            
            // First try to get from CMS config
            const config = AppState.config?.modules?.ralphNews?.content;
            let story = null;
            
            if (config) {
                if (section === 'main' && config.mainStory && config.mainStory.id === storyId) {
                    story = config.mainStory;
                } else if (section === 'secondary' && config.secondaryStories) {
                    story = config.secondaryStories.find(s => s.id === storyId);
                } else if (section === 'sidebar' && config.sidebarStories) {
                    story = config.sidebarStories.find(s => s.id === storyId);
                }
            }
            
            // Fallback to placeholder content
            if (!story) {
                story = placeholderStories[storyId];
            }
            
            if (!story) {
                console.log('Story not found:', storyId);
                return;
            }
            
            // Create and show modal
            showStoryModal(story);
        }
        
        // Show story in modal
        function showStoryModal(story) {
            // Remove existing modal if any
            const existingModal = document.querySelector('.story-modal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'story-modal';
            modal.style.display = 'flex';
            
            modal.innerHTML = `
                <div class="story-modal-content">
                    <button class="story-modal-close" onclick="closeStoryModal()">&times;</button>
                    <div class="story-modal-header">
                        <h2 class="story-modal-title">${story.title}</h2>
                        <div class="story-meta">${story.author} ‚Ä¢ ${story.date} ‚Ä¢ ${story.category || ''}</div>
                    </div>
                    ${story.image ? `<img src="${story.image}" style="width: 100%; height: 300px; object-fit: cover;">` : ''}
                    <div class="story-modal-body">
                        ${story.fullContent || story.excerpt}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal on background click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeStoryModal();
                }
            });
        }
        
        // Close story modal
        function closeStoryModal() {
            const modal = document.querySelector('.story-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Initialize Ralph News Network when window is opened
        function initializeRalphNews() {
            console.log('üé¨ Initializing Ralph News Network');
            startPresenterAnimation();
            initializePresenterHoverSound();
            
            // Force load content if not already loaded
            const windowElement = document.getElementById('ralphNews');
            if (windowElement) {
                const config = AppState.config?.modules?.ralphNews;
                if (config && config.content) {
                    console.log('üì∞ Loading RNN content from CMS');
                    updateRalphNewsContent(windowElement, config.content);
                } else {
                    console.log('‚ö†Ô∏è No RNN config found, content should be visible from HTML');
                }
            }
        }
        
        // Auto-initialize when RNN window becomes visible
        function checkRalphNewsVisibility() {
            const ralphNewsWindow = document.getElementById('ralphNews');
            if (ralphNewsWindow && ralphNewsWindow.style.display !== 'none') {
                initializeRalphNews();
                // Only initialize once
                ralphNewsWindow.dataset.initialized = 'true';
            }
        }
        
        // Clean up when Ralph News window is closed
        function cleanupRalphNews() {
            stopPresenterAnimation();
        }

        // Update Innovation content dynamically
        function updateInnovationContent(windowElement, content) {
            console.log('üîÑ Updating redesigned Innovation module with CMS content');
            
            if (!content) {
                console.log('‚ö†Ô∏è No innovation content provided');
                return;
            }
            
            // Update experiments/current projects section
            const experimentsContainer = windowElement.querySelector('.innovation-experiments');
            if (experimentsContainer && content.experiments) {
                let experimentsHTML = '';
                content.experiments.forEach(experiment => {
                    const isActive = experiment.url && experiment.url !== '#' && experiment.url !== '';
                    const statusClass = experiment.status === 'ACTIVE' ? 'active' : 
                                       experiment.status === 'COMPLETE' ? 'complete' : 'coming-soon';
                    
                    experimentsHTML += `
                        <div class="innovation-project">
                            <div class="innovation-status ${statusClass}">
                                ${experiment.status === 'ACTIVE' ? 'ACTIVE' : experiment.status === 'COMPLETE' ? 'COMPLETE' : 'COMING SOON'}
                            </div>
                            <div class="innovation-main-content">
                                ${experiment.thumbnail ? `
                                    <img src="${experiment.thumbnail}" alt="${experiment.name}" class="innovation-thumbnail" />
                                ` : `
                                    <div class="innovation-thumbnail" style="display: flex; align-items: center; justify-content: center; color: #00ff00; font-size: 32px;">
                                        üí°
                                    </div>
                                `}
                                <div class="innovation-content">
                                    <h4>${experiment.name || 'Untitled Project'}</h4>
                                    <div class="innovation-project-description">
                                        ${experiment.description || 'No description available'}
                                    </div>
                                    <div class="innovation-actions">
                                        ${isActive ? `
                                            <button class="innovation-project-btn preview-btn" onclick="previewInnovationProject('${experiment.url}', '${experiment.name}')">
                                                Preview
                                            </button>
                                            <button class="innovation-project-btn copy-btn" onclick="copyProjectLink('${experiment.url}')">
                                                Copy Link
                                            </button>
                                        ` : `
                                            <button class="innovation-project-btn" disabled>
                                                Coming Soon
                                            </button>
                                        `}
                                    </div>
                                </div>
                            </div>
                            <div class="innovation-progress-wrapper">
                                <div class="innovation-progress-bar">
                                    <div class="innovation-progress-fill" data-progress="${experiment.progress || 0}"></div>
                                    <div class="innovation-progress-text">${experiment.progress || 0}%</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                experimentsContainer.innerHTML = experimentsHTML;
            }
            
            // Update upcoming sessions section
            const upcomingContainer = windowElement.querySelector('.innovation-upcoming');
            if (upcomingContainer && content.upcomingSessions) {
                let upcomingHTML = '';
                content.upcomingSessions.forEach(session => {
                    upcomingHTML += `
                        <div class="upcoming-session">
                            <div class="session-date">${session.date || 'TBD'}</div>
                            <div class="session-details">
                                <h4>${session.topic || 'Session Topic'}</h4>
                                <p>${session.description || 'Details coming soon'}</p>
                                <span class="session-presenter">Led by: ${session.presenter || 'TBD'}</span>
                            </div>
                        </div>
                    `;
                });
                upcomingContainer.innerHTML = upcomingHTML;
            }
            
            console.log('‚úÖ Innovation content updated successfully');
            
            // Animate progress bars after content is rendered
            setTimeout(() => {
                animateProgressBars(windowElement);
            }, 200);
        }
        
        // Animate progress bars loading effect
        function animateProgressBars(windowElement) {
            const progressFills = windowElement.querySelectorAll('.innovation-progress-fill');
            
            progressFills.forEach((fill, index) => {
                const targetProgress = parseInt(fill.dataset.progress) || 0;
                
                // Stagger the animations slightly for a nice cascading effect
                setTimeout(() => {
                    fill.classList.add('animate');
                    fill.style.width = targetProgress + '%';
                }, index * 150);
            });
        }

        // Pitch, Please! Functions
        function submitPitch() {
            const pitchData = {
                title: document.getElementById('pitchTitle').value,
                type: document.getElementById('pitchType').value,
                audience: document.getElementById('pitchAudience').value,
                shareable: document.getElementById('pitchShareable').value,
                ralph: document.getElementById('pitchRalph').value,
                twist: document.getElementById('pitchTwist').value,
                oneBreath: document.getElementById('pitchOneBreath').value,
                win: document.getElementById('pitchWin').value,
                scalable: document.getElementById('pitchScalable').value,
                anonymous: document.getElementById('pitchAnonymous').checked,
                timestamp: new Date().toISOString()
            };
            
            // Basic validation
            if (!pitchData.title || !pitchData.type || !pitchData.oneBreath) {
                showNotification('Please fill in the required fields: Title, Type, and One-breath pitch', 'error');
                return;
            }
            
            // Simulate submission
            console.log('Pitch submitted:', pitchData);
            showNotification('üéâ Pitch submitted successfully! You\'ll receive feedback after judging.', 'success');
            
            // Clear form
            document.getElementById('pitchTitle').value = '';
            document.getElementById('pitchType').value = '';
            document.getElementById('pitchAudience').value = '';
            document.getElementById('pitchShareable').value = '';
            document.getElementById('pitchRalph').value = '';
            document.getElementById('pitchTwist').value = '';
            document.getElementById('pitchOneBreath').value = '';
            document.getElementById('pitchWin').value = '';
            document.getElementById('pitchScalable').value = '';
            
            // TODO: Send to actual backend/CMS
        }
        
        function saveDraft() {
            const pitchData = {
                title: document.getElementById('pitchTitle').value,
                type: document.getElementById('pitchType').value,
                audience: document.getElementById('pitchAudience').value,
                shareable: document.getElementById('pitchShareable').value,
                ralph: document.getElementById('pitchRalph').value,
                twist: document.getElementById('pitchTwist').value,
                oneBreath: document.getElementById('pitchOneBreath').value,
                win: document.getElementById('pitchWin').value,
                scalable: document.getElementById('pitchScalable').value,
                anonymous: document.getElementById('pitchAnonymous').checked,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('pitchPleaseDraft', JSON.stringify(pitchData));
            showNotification('üíæ Draft saved successfully!', 'info');
        }
        
        // Load draft on page load if exists
        function loadPitchDraft() {
            const draft = localStorage.getItem('pitchPleaseDraft');
            if (draft) {
                try {
                    const pitchData = JSON.parse(draft);
                    document.getElementById('pitchTitle').value = pitchData.title || '';
                    document.getElementById('pitchType').value = pitchData.type || '';
                    document.getElementById('pitchAudience').value = pitchData.audience || '';
                    document.getElementById('pitchShareable').value = pitchData.shareable || '';
                    document.getElementById('pitchRalph').value = pitchData.ralph || '';
                    document.getElementById('pitchTwist').value = pitchData.twist || '';
                    document.getElementById('pitchOneBreath').value = pitchData.oneBreath || '';
                    document.getElementById('pitchWin').value = pitchData.win || '';
                    document.getElementById('pitchScalable').value = pitchData.scalable || '';
                    document.getElementById('pitchAnonymous').checked = pitchData.anonymous !== false;
                } catch (e) {
                    console.error('Error loading draft:', e);
                }
            }
        }


        // Continuous Matrix Background for Innovation Module
        let matrixInterval = null;
        
        function initializeMatrixBackground(windowElement) {
            console.log('üéØ Matrix initialization starting...');
            const windowContent = windowElement.querySelector('.window-content');
            if (!windowContent) {
                console.log('‚ùå No window content found');
                return;
            }
            
            // Check if matrix background already exists
            if (windowContent.querySelector('.matrix-background')) {
                console.log('‚ö†Ô∏è Matrix background already exists');
                return;
            }
            
            console.log('‚ú® Creating matrix background...');
            // Create matrix background container
            const matrixBg = document.createElement('div');
            matrixBg.className = 'matrix-background';
            matrixBg.id = 'innovationMatrixBg';
            
            // Insert at the beginning so it's behind content
            windowContent.insertBefore(matrixBg, windowContent.firstChild);
            
            // Matrix characters (mix of tech symbols and Japanese characters)
            const matrixChars = ['0', '1', 'Œª', 'œÄ', '‚àë', 'Œî', '‚àû', '‚âà', '‚ü®', '‚ü©', '‚Üí', '‚Üê', '‚Üë', '‚Üì', 
                                '„Ç¢', '„Ç§', '„Ç¶', '„Ç®', '„Ç™', '„Ç´', '„Ç≠', '„ÇØ', '„Ç±', '„Ç≥', 'Êï∞', 'Â≠ó', 'Á¨¶', 'Âè∑'];
            
            // Create initial columns
            const columnCount = Math.floor(windowContent.offsetWidth / 25);
            console.log(`üé¨ Creating ${columnCount} matrix columns (width: ${windowContent.offsetWidth}px)`);
            
            // Function to create a wave of columns
            function createMatrixWave() {
                for (let i = 0; i < columnCount; i++) {
                    setTimeout(() => {
                        createContinuousMatrixColumn(matrixBg, i * 25, matrixChars, i);
                    }, i * 50); // Stagger column creation
                }
            }
            
            // Create initial wave
            createMatrixWave();
            
            // Set up continuous waves
            if (matrixInterval) clearInterval(matrixInterval);
            matrixInterval = setInterval(() => {
                createMatrixWave();
            }, 6000); // New wave every 6 seconds
            
            // Store interval reference for cleanup
            windowElement.matrixInterval = matrixInterval;
            
            console.log('‚úÖ Matrix background initialization complete with continuous waves');
        }
        
        function createContinuousMatrixColumn(container, leftPos, chars, columnIndex) {
            console.log(`üìä Creating matrix column ${columnIndex} at position ${leftPos}px`);
            const column = document.createElement('div');
            column.className = 'matrix-column';
            column.style.left = leftPos + 'px';
            
            // Randomize animation duration and delay for variety
            const duration = 4 + Math.random() * 6; // 4-10 seconds
            const delay = Math.random() * duration; // Random start point
            column.style.animationDuration = `${duration}s`;
            column.style.animationDelay = `${delay}s`;
            
            console.log(`‚è±Ô∏è Column ${columnIndex}: duration=${duration.toFixed(1)}s, delay=${delay.toFixed(1)}s`);
            
            // Create longer string for continuous effect
            const charCount = Math.floor(Math.random() * 15 + 20); // 20-35 characters
            for (let i = 0; i < charCount; i++) {
                const char = document.createElement('span');
                char.className = 'matrix-char';
                char.textContent = chars[Math.floor(Math.random() * chars.length)];
                
                // Randomize individual character fade timing
                char.style.animationDelay = `${Math.random() * 2}s`;
                column.appendChild(char);
            }
            
            container.appendChild(column);
            
            // Clean up old columns to prevent DOM bloat
            setTimeout(() => {
                if (column.parentNode) {
                    column.remove();
                    console.log(`üßπ Cleaned up matrix column ${columnIndex}`);
                }
            }, (duration + 1) * 1000); // Remove after animation completes + 1 second buffer
        }
        
        // Preview Innovation Project in iframe
        function previewInnovationProject(url, projectName) {
            // Create or get existing iframe window
            let iframeWindow = document.getElementById('innovationPreview');
            if (!iframeWindow) {
                // Create new iframe window
                iframeWindow = document.createElement('div');
                iframeWindow.id = 'innovationPreview';
                iframeWindow.className = 'window';
                iframeWindow.style.cssText = 'top: 100px; left: 100px; width: 1000px; height: 700px; z-index: 15010;';
                
                iframeWindow.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">üîç Preview: ${projectName}</div>
                        <div class="window-controls">
                            <button class="window-button" onclick="minimizeWindow('innovationPreview')">_</button>
                            <button class="window-button" onclick="maximizeWindow('innovationPreview')">‚ñ°</button>
                            <button class="window-button" onclick="closeInnovationPreview()">X</button>
                        </div>
                    </div>
                    <div class="window-content" style="padding: 0;">
                        <iframe src="${url}" style="width: 100%; height: 100%; border: none; background: white;"></iframe>
                    </div>
                `;
                
                document.body.appendChild(iframeWindow);
                makeDraggable(iframeWindow);
            } else {
                // Update existing iframe
                const iframe = iframeWindow.querySelector('iframe');
                const title = iframeWindow.querySelector('.window-title');
                iframe.src = url;
                title.textContent = `üîç Preview: ${projectName}`;
                iframeWindow.style.display = 'block';
            }
            
            // Bring to front
            focusWindow(iframeWindow);
        }
        
        // Close Innovation Preview window
        function closeInnovationPreview() {
            const previewWindow = document.getElementById('innovationPreview');
            if (previewWindow) {
                previewWindow.remove();
            }
        }
        
        // Copy project link to clipboard
        function copyProjectLink(url) {
            navigator.clipboard.writeText(url).then(() => {
                showNotification('üîó Link copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('üîó Link copied to clipboard!');
            });
        }
        
        // Enhanced Innovation window opening with continuous matrix background
        function openInnovationWindow() {
            console.log('üîÆ Opening Innovation window with matrix effect');
            const windowElement = document.getElementById('innovation');
            if (windowElement) {
                openWindow('innovation');
                
                // Initialize continuous matrix background
                setTimeout(() => {
                    console.log('üé¨ Initializing matrix background...');
                    initializeMatrixBackground(windowElement);
                }, 100);
            }
        }

        // Update Resources content dynamically
        function updateResourcesContent(windowElement, content) {
            console.log('üîÑ Updating redesigned Resources module with CMS content');
            
            if (!content) {
                console.log('‚ö†Ô∏è No resources content provided');
                return;
            }
            
            // Update Documents section
            const documentsContainer = windowElement.querySelector('.resources-documents .resource-items');
            if (documentsContainer && content.documents) {
                let documentsHTML = '';
                content.documents.forEach(document => {
                    const isActive = document.url && document.url !== '#';
                    documentsHTML += `
                        <div class="resource-item ${isActive ? '' : 'inactive'}">
                            <div class="resource-icon">üìÑ</div>
                            <div class="resource-details">
                                <h4>${document.name || 'Untitled Document'}</h4>
                                <p>${document.description || 'Essential company document'}</p>
                            </div>
                            <button class="resource-btn" onclick="${isActive ? `openExternalLink('${document.url}')` : ''}" ${isActive ? '' : 'disabled style="opacity: 0.5;"'}>
                                ${isActive ? 'View' : 'Coming Soon'}
                            </button>
                        </div>
                    `;
                });
                documentsContainer.innerHTML = documentsHTML;
            }
            
            // Update Templates section
            const templatesContainer = windowElement.querySelector('.resources-templates .resource-items');
            if (templatesContainer && content.templates) {
                let templatesHTML = '';
                content.templates.forEach(template => {
                    const isActive = template.url && template.url !== '#';
                    templatesHTML += `
                        <div class="resource-item ${isActive ? '' : 'inactive'}">
                            <div class="resource-icon"></div>
                            <div class="resource-details">
                                <h4>${template.name || 'Untitled Template'}</h4>
                                <p>${template.description || 'Professional template'}</p>
                            </div>
                            <button class="resource-btn" onclick="${isActive ? `openExternalLink('${template.url}')` : ''}" ${isActive ? '' : 'disabled style="opacity: 0.5;"'}>
                                ${isActive ? 'Download' : 'Coming Soon'}
                            </button>
                        </div>
                    `;
                });
                templatesContainer.innerHTML = templatesHTML;
            }
            
            // Update Training section
            const trainingContainer = windowElement.querySelector('.resources-training .resource-items');
            if (trainingContainer && content.training) {
                let trainingHTML = '';
                content.training.forEach(training => {
                    const isActive = training.url && training.url !== '#';
                    trainingHTML += `
                        <div class="resource-item ${isActive ? '' : 'inactive'}">
                            <div class="resource-icon"></div>
                            <div class="resource-details">
                                <h4>${training.name || 'Untitled Training'}</h4>
                                <p>${training.description || 'Professional development resource'}</p>
                            </div>
                            <button class="resource-btn" onclick="${isActive ? `openExternalLink('${training.url}')` : ''}" ${isActive ? '' : 'disabled style="opacity: 0.5;"'}>
                                ${isActive ? 'Start' : 'Coming Soon'}
                            </button>
                        </div>
                    `;
                });
                trainingContainer.innerHTML = trainingHTML;
            }
            
            console.log('‚úÖ Resources content updated successfully');
        }

        // Update Quick Links content dynamically
        function updateLinksContent(windowElement, content) {
            console.log('üîÑ Updating redesigned Links module with CMS content');
            
            if (!content) {
                console.log('‚ö†Ô∏è No links content provided');
                return;
            }
            
            // Update Internal Tools section
            const internalGrid = windowElement.querySelector('.links-internal-section .links-grid');
            if (internalGrid && content.internal) {
                let internalHTML = '';
                content.internal.forEach(link => {
                    const url = link.url && link.url !== '#' ? link.url : null;
                    const clickAction = url ? `openExternalLink('${url}')` : '';
                    const disabled = !url;
                    
                    internalHTML += `
                        <div class="link-card">
                            <div class="link-icon">${link.icon || 'üîó'}</div>
                            <h4>${link.name || 'Untitled'}</h4>
                            <p>${link.description || 'No description available'}</p>
                            <button class="link-card-btn" onclick="${clickAction}" ${disabled ? 'style="opacity: 0.5; cursor: not-allowed;" disabled' : ''}>
                                ${disabled ? 'Coming Soon' : 'Open'}
                            </button>
                        </div>
                    `;
                });
                internalGrid.innerHTML = internalHTML;
            }
            
            // Update External Resources section
            const externalGrid = windowElement.querySelector('.links-external-section .links-grid');
            if (externalGrid && content.external) {
                let externalHTML = '';
                content.external.forEach(link => {
                    const url = link.url && link.url !== '#' ? link.url : null;
                    const clickAction = url ? `openExternalLink('${url}')` : '';
                    const disabled = !url;
                    
                    externalHTML += `
                        <div class="link-card">
                            <div class="link-icon">${link.icon || 'üåç'}</div>
                            <h4>${link.name || 'Untitled'}</h4>
                            <p>${link.description || 'No description available'}</p>
                            <button class="link-card-btn" onclick="${clickAction}" ${disabled ? 'style="opacity: 0.5; cursor: not-allowed;" disabled' : ''}>
                                ${disabled ? 'Coming Soon' : 'Open'}
                            </button>
                        </div>
                    `;
                });
                externalGrid.innerHTML = externalHTML;
            }
            
            console.log('‚úÖ Quick Links content updated successfully');
        }

        // Update module descriptions from CMS
        function updateModuleDescriptions() {
            if (!AppState.config?.modules) return;
            
            // Mapping from CMS module IDs to CSS class names
            const moduleClassMap = {
                'newBiz': 'new-biz',
                'pitchPlease': 'pitch-please',
                'ralphNews': 'ralph-news',
                'premieres': 'premieres',
                'shoutouts': 'shoutouts', 
                'articles': 'articles',
                'suggestions': 'suggestions',
                'announcements': 'announcements',
                'links': 'links',
                'innovation': 'innovation',
                'resources': 'resources'
            };
            
            // Update all module subtitles from CMS descriptions
            Object.keys(AppState.config.modules).forEach(moduleId => {
                const moduleConfig = AppState.config.modules[moduleId];
                if (moduleConfig.enabled && moduleConfig.description) {
                    const cssClassName = moduleClassMap[moduleId] || moduleId;
                    const subtitleElement = document.querySelector(`.${cssClassName}-subtitle`);
                    if (subtitleElement) {
                        subtitleElement.textContent = moduleConfig.description;
                        console.log(`‚úÖ Updated ${moduleId} (${cssClassName}) subtitle from CMS`);
                    } else {
                        console.log(`‚ö†Ô∏è Could not find subtitle element for ${moduleId} (.${cssClassName}-subtitle)`);
                    }
                }
            });
        }

        // Update Pitch Please content from CMS
        function updatePitchPleaseContent(windowElement, content) {
            console.log('üîÑ Updating Pitch Please content:', content);
            
            if (!content) {
                console.log('‚ö†Ô∏è No Pitch Please content provided');
                return;
            }

            // Update header subtitle from CMS content or use module description as fallback
            const subtitleElement = windowElement.querySelector('.pitch-please-subtitle');
            if (subtitleElement) {
                if (content.subtitle) {
                    subtitleElement.textContent = content.subtitle;
                } else if (AppState.config?.modules?.pitchPlease?.description) {
                    subtitleElement.textContent = AppState.config.modules.pitchPlease.description;
                }
            }

            // Update current competition stats
            const submissionsElement = windowElement.querySelector('.stat:nth-child(1) .stat-number');
            const prizeElement = windowElement.querySelector('.stat:nth-child(2) .stat-number');
            const daysLeftElement = windowElement.querySelector('.stat:nth-child(3) .stat-number');
            const deadlineElement = windowElement.querySelector('.deadline');

            if (content.currentSubmissions && submissionsElement) {
                submissionsElement.textContent = content.currentSubmissions;
            }
            if (content.prize && prizeElement) {
                prizeElement.textContent = content.prize;
            }
            if (content.daysLeft && daysLeftElement) {
                daysLeftElement.textContent = content.daysLeft;
            }
            if (content.deadline && deadlineElement) {
                deadlineElement.textContent = `Deadline: ${content.deadline}`;
            }

            // Update competition theme if available
            const themeElement = windowElement.querySelector('.competition-theme');
            if (content.theme && themeElement) {
                themeElement.textContent = content.theme;
            }

            console.log('‚úÖ Pitch Please content updated successfully');
        }


        function updateShoutoutsContent(windowElement, content) {
            console.log('üîÑ Updating Shoutouts content:', content);
            
            const emojis = content.emojis || {};
            
            // Update birthdays
            const birthdayContainer = document.getElementById('birthdayItems');
            if (birthdayContainer) {
                birthdayContainer.innerHTML = '';
                if (content.birthdays && content.birthdays.length > 0) {
                    content.birthdays.forEach(birthday => {
                        const itemEl = document.createElement('div');
                        itemEl.className = `shoutout-item birthday-item ${birthday.highlight ? 'highlight' : ''}`;
                        itemEl.innerHTML = `${birthday.date} - ${birthday.person}${birthday.highlight ? '!' : ''}`;
                        birthdayContainer.appendChild(itemEl);
                    });
                } else {
                    birthdayContainer.innerHTML = '<div style="color: #666; font-style: italic; text-align: center; padding: 20px;">No birthdays this month</div>';
                }
            }
            
            // Update anniversaries
            const anniversaryContainer = document.getElementById('anniversaryItems');
            if (anniversaryContainer) {
                anniversaryContainer.innerHTML = '';
                if (content.anniversaries && content.anniversaries.length > 0) {
                    content.anniversaries.forEach(anniversary => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'shoutout-item anniversary-item';
                        itemEl.innerHTML = `${anniversary.years} Year${anniversary.years !== 1 ? 's' : ''} - ${anniversary.person}`;
                        anniversaryContainer.appendChild(itemEl);
                    });
                } else {
                    anniversaryContainer.innerHTML = '<div style="color: #666; font-style: italic; text-align: center; padding: 20px;">No work anniversaries</div>';
                }
            }
            
            // Update shoutouts
            const shoutoutContainer = document.getElementById('shoutoutItems');
            if (shoutoutContainer) {
                shoutoutContainer.innerHTML = '';
                if (content.shoutouts && content.shoutouts.length > 0) {
                    content.shoutouts.forEach(shoutout => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'shoutout-item';
                        itemEl.innerHTML = `
                            <div class="shoutout-message">"${shoutout.message}"</div>
                            <div class="shoutout-author">- ${shoutout.from}</div>
                        `;
                        shoutoutContainer.appendChild(itemEl);
                    });
                } else {
                    shoutoutContainer.innerHTML = '<div style="color: #666; font-style: italic; text-align: center; padding: 20px;">No recent shoutouts</div>';
                }
            }
        }

        function updatePremieresContent(windowElement, content) {
            console.log('üîÑ Updating Premieres content:', content);
            
            // Update This Month premieres
            const thisMonthContainer = document.getElementById('thisMonthPremieres');
            if (thisMonthContainer) {
                thisMonthContainer.innerHTML = '';
                if (content.thisMonth && content.thisMonth.length > 0) {
                    content.thisMonth.forEach(premiere => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'premiere-item';
                        const linkHTML = premiere.liveLink ? ` <a href="${premiere.liveLink}" target="_blank" style="color: var(--ralph-yellow); text-decoration: none;">WATCH</a>` : '';
                        itemEl.innerHTML = `
                            <div class="premiere-date">${premiere.date}</div>
                            <div class="premiere-title">${premiere.project}${linkHTML}</div>
                        `;
                        thisMonthContainer.appendChild(itemEl);
                    });
                } else {
                    thisMonthContainer.innerHTML = '<div style="color: #666; font-style: italic; text-align: center; padding: 20px;">No premieres this month</div>';
                }
            }
            
            // Update Next Month premieres
            const nextMonthContainer = document.getElementById('nextMonthPremieres');
            if (nextMonthContainer) {
                nextMonthContainer.innerHTML = '';
                if (content.nextMonth && content.nextMonth.length > 0) {
                    content.nextMonth.forEach(premiere => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'premiere-item';
                        const linkHTML = premiere.liveLink ? ` <a href="${premiere.liveLink}" target="_blank" style="color: var(--ralph-yellow); text-decoration: none;">WATCH</a>` : '';
                        itemEl.innerHTML = `
                            <div class="premiere-date">${premiere.date}</div>
                            <div class="premiere-title">${premiere.project}${linkHTML}</div>
                        `;
                        nextMonthContainer.appendChild(itemEl);
                    });
                } else {
                    nextMonthContainer.innerHTML = '<div style="color: #666; font-style: italic; text-align: center; padding: 20px;">No upcoming premieres</div>';
                }
            }
        }

        function updateTrendspottingContent(windowElement, content) {
            console.log('üîÑ Updating Trendspotting content:', content);
            
            if (!content || !content.offices) {
                console.log('‚ö†Ô∏è No Trendspotting content provided');
                return;
            }
            
            // Update timestamp
            const updateTime = windowElement.querySelector('#trendspottingUpdateTime');
            if (updateTime) {
                const now = new Date();
                const options = { 
                    month: 'short', 
                    day: 'numeric', 
                    hour: '2-digit', 
                    minute: '2-digit' 
                };
                updateTime.textContent = now.toLocaleString('en-US', options);
            }
            
            // Update each office's content
            Object.entries(content.offices).forEach(([officeKey, officeData]) => {
                // Update playlist
                const playlistContainer = document.getElementById(`trendspotting-${officeKey}-playlist`);
                if (playlistContainer && officeData.playlist) {
                    playlistContainer.innerHTML = '';
                    officeData.playlist.forEach(song => {
                        const songEl = document.createElement('div');
                        songEl.className = 'trendspotting-playlist-item';
                        songEl.innerHTML = `
                            <div class="trendspotting-song-title">${song.title}</div>
                            <div class="trendspotting-song-artist">${song.artist}</div>
                        `;
                        playlistContainer.appendChild(songEl);
                    });
                }
                
                // Update trends
                const trendsContainer = document.getElementById(`trendspotting-${officeKey}-trends`);
                if (trendsContainer && officeData.trends) {
                    trendsContainer.innerHTML = '';
                    officeData.trends.forEach(trend => {
                        const trendEl = document.createElement('div');
                        trendEl.className = 'trendspotting-trend-item';
                        trendEl.innerHTML = `
                            <span class="trendspotting-trend-category">${trend.category}:</span>
                            <span class="trendspotting-trend-description">${trend.description}</span>
                        `;
                        trendsContainer.appendChild(trendEl);
                    });
                }
            });
            
            // Add interactive hover effects
            windowElement.querySelectorAll('.trendspotting-office-section').forEach(section => {
                section.addEventListener('mouseenter', function() {
                    this.style.filter = 'brightness(1.1)';
                });
                
                section.addEventListener('mouseleave', function() {
                    this.style.filter = 'brightness(1)';
                });
            });
        }

        function updateSuggestionsContent(windowElement, content) {
            console.log('üîÑ Updating redesigned Suggestions module with CMS content');
            
            if (!content || !content.recentSuggestions) {
                console.log('‚ö†Ô∏è No suggestions content provided');
                return;
            }
            
            // Find the suggestions list container
            const suggestionsList = windowElement.querySelector('.suggestions-list');
            if (!suggestionsList) {
                console.error('‚ùå Suggestions list container not found');
                return;
            }
            
            // Generate HTML for suggestions from CMS
            let suggestionsHTML = '';
            if (content.recentSuggestions && content.recentSuggestions.length > 0) {
                content.recentSuggestions.forEach(suggestion => {
                    const statusClass = {
                        'APPROVED': 'approved',
                        'IN REVIEW': 'reviewing', 
                        'CONSIDERING': 'considering',
                        'REJECTED': 'rejected'
                    }[suggestion.status] || 'considering';
                    
                    const statusText = {
                        'APPROVED': 'APPROVED ‚úì',
                        'IN REVIEW': 'IN REVIEW',
                        'CONSIDERING': 'CONSIDERING',
                        'REJECTED': 'REJECTED ‚úó'
                    }[suggestion.status] || 'CONSIDERING';
                    
                    suggestionsHTML += `
                        <div class="suggestion-item">
                            <div class="suggestion-content">
                                <h4>${suggestion.title || suggestion.idea || 'Untitled Suggestion'}</h4>
                                <p>${suggestion.description || suggestion.idea || 'No description provided'}</p>
                                <div class="suggestion-meta">
                                    <span class="suggestion-author">${suggestion.author || 'Anonymous'}</span>
                                    <span class="suggestion-category">${suggestion.category || 'General'}</span>
                                </div>
                            </div>
                            <div class="suggestion-status ${statusClass}">${statusText}</div>
                        </div>
                    `;
                });
            } else {
                suggestionsHTML = '<div class="no-suggestions">No recent suggestions available</div>';
            }
            
            // Update the content
            suggestionsList.innerHTML = suggestionsHTML;
            
            console.log('‚úÖ Suggestions content updated successfully');
        }

        function updateAnnouncementsContent(windowElement, content) {
            console.log('üîÑ Updating redesigned Announcements module with CMS content');
            
            if (!content) {
                console.log('‚ö†Ô∏è No announcements content provided');
                return;
            }
            
            // Update Important/Urgent announcements
            const urgentList = windowElement.querySelector('.announcements-urgent-section .announcements-list');
            if (urgentList) {
                let importantHTML = '';
                if (content.important && content.important.length > 0) {
                    content.important.forEach(announcement => {
                        importantHTML += `
                            <div class="announcement-item urgent">
                                <div class="announcement-badge">URGENT</div>
                                <div class="announcement-content">
                                    <h4>${announcement.title || 'Important Notice'}</h4>
                                    <p>${announcement.message || announcement}</p>
                                    <div class="announcement-meta">
                                        <span class="announcement-date">Posted: ${announcement.date || 'Today'}</span>
                                        <span class="announcement-dept">${announcement.department || 'Management'}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    importantHTML = '<div class="no-announcements">No urgent announcements</div>';
                }
                urgentList.innerHTML = importantHTML;
            }
            
            // Update General announcements
            const generalList = windowElement.querySelector('.announcements-general-section .announcements-list');
            if (generalList) {
                let generalHTML = '';
                if (content.general && content.general.length > 0) {
                    content.general.forEach(announcement => {
                        generalHTML += `
                            <div class="announcement-item">
                                <div class="announcement-content">
                                    <h4>${announcement.title || 'General Notice'}</h4>
                                    <p>${announcement.message || announcement}</p>
                                    <div class="announcement-meta">
                                        <span class="announcement-date">Posted: ${announcement.date || 'Recently'}</span>
                                        <span class="announcement-dept">${announcement.department || 'General'}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    generalHTML = '<div class="no-announcements">No general announcements</div>';
                }
                generalList.innerHTML = generalHTML;
            }
            
            console.log('‚úÖ Announcements content updated successfully');
        }




        // Share Challenge Popup Functions
        let shareState = {
            completedShares: new Set(),
            totalItems: 0
        };

        function openSharePopup() {
            console.log('üì≤ Opening share challenge popup...');
            
            if (!AppState.config || !AppState.config.modules.sharing) {
                console.error('Share challenge configuration not found');
                return;
            }
            
            const shareConfig = AppState.config.modules.sharing.content;
            
            // Update popup content
            document.getElementById('shareWeek').textContent = shareConfig.weekOf;
            document.getElementById('giftCardAmount').textContent = shareConfig.giftCardAmount;
            
            // Populate share items
            populateShareItems(shareConfig.items);
            
            // Show popup
            document.getElementById('sharePopup').style.display = 'flex';
            
            // Reset state
            shareState.completedShares.clear();
            shareState.totalItems = shareConfig.items.length;
            updateShareProgress();
        }

        function populateShareItems(items) {
            const container = document.getElementById('shareItems');
            container.innerHTML = '';
            
            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'share-item';
                itemElement.id = `share-item-${item.id}`;
                
                itemElement.innerHTML = `
                    <img src="${item.thumbnail}" alt="${item.title}" class="share-thumbnail" 
                         onerror="this.style.background='linear-gradient(45deg, var(--ralph-pink), #ff1493)'; this.alt='${item.type}';">
                    <div class="share-content">
                        <div class="share-type">${item.type} ‚Ä¢ ${item.platform}</div>
                        <h4>${item.title}</h4>
                        <div class="share-description">${item.description}</div>
                        <div class="share-actions">
                            <button class="share-link-btn" onclick="openShareLink('${item.shareUrl}')">
                                üîó Open ${item.platform}
                            </button>
                            <div class="share-checkbox">
                                <input type="checkbox" id="checkbox-${item.id}" onchange="toggleShare(${item.id})">
                                <label for="checkbox-${item.id}">Shared!</label>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(itemElement);
            });
        }

        function openShareLink(url) {
            window.open(url, '_blank');
        }

        function toggleShare(itemId) {
            const checkbox = document.getElementById(`checkbox-${itemId}`);
            const itemElement = document.getElementById(`share-item-${itemId}`);
            
            if (checkbox.checked) {
                shareState.completedShares.add(itemId);
                itemElement.classList.add('completed');
            } else {
                shareState.completedShares.delete(itemId);
                itemElement.classList.remove('completed');
            }
            
            updateShareProgress();
        }

        function updateShareProgress() {
            const completed = shareState.completedShares.size;
            const total = shareState.totalItems;
            
            document.getElementById('shareProgress').textContent = `${completed} of ${total} shared`;
            
            const submitBtn = document.getElementById('shareSubmitBtn');
            if (completed === total && total > 0) {
                submitBtn.disabled = false;
                submitBtn.textContent = 'üéØ ENTER SWEEPSTAKES';
            } else {
                submitBtn.disabled = true;
                submitBtn.textContent = `üéØ SHARE ${total - completed} MORE`;
            }
        }

        function submitShares() {
            if (shareState.completedShares.size !== shareState.totalItems) {
                return;
            }
            
            // Hide the form and show success message
            document.getElementById('shareFooter').style.display = 'none';
            document.getElementById('shareItems').style.display = 'none';
            document.getElementById('shareSuccess').style.display = 'block';
            
            // Add some celebration
            showNotification('üéâ Thanks for sharing! You\'ve been entered to win!');
            
            // Optional: Send data to server for tracking
            console.log('üìä User completed all shares:', Array.from(shareState.completedShares));
        }

        function closeSharePopup() {
            document.getElementById('sharePopup').style.display = 'none';
            
            // Reset popup state for next time
            setTimeout(() => {
                document.getElementById('shareFooter').style.display = 'block';
                document.getElementById('shareItems').style.display = 'block';
                document.getElementById('shareSuccess').style.display = 'none';
                shareState.completedShares.clear();
                // Uncheck all checkboxes
                document.querySelectorAll('.share-checkbox input').forEach(cb => cb.checked = false);
                // Remove completed styling
                document.querySelectorAll('.share-item').forEach(item => item.classList.remove('completed'));
            }, 300);
        }

        // Auto-show popup on desktop load (can be disabled/modified)
        // Track which modules have been viewed
        const viewedModules = JSON.parse(localStorage.getItem('viewedModules') || '{}');
        
        // Check if module has new content since last view
        function hasNewContent(moduleId) {
            const lastViewed = viewedModules[moduleId] || 0;
            const now = Date.now();
            // Consider content "new" if not viewed in last 24 hours
            return (now - lastViewed) > (24 * 60 * 60 * 1000);
        }
        
        // Mark module as viewed
        function markModuleViewed(moduleId) {
            viewedModules[moduleId] = Date.now();
            localStorage.setItem('viewedModules', JSON.stringify(viewedModules));
            // Remove new indicator
            const icon = document.querySelector(`[data-module="${moduleId}"] .icon-new-indicator`);
            if (icon) {
                icon.remove();
            }
        }
        
        // Generate What's New content
        function generateWhatsNewContent() {
            console.log('üîÑ Generating What\'s New content...');
            console.log('üìä AppState.config:', AppState.config ? 'loaded' : 'missing');
            console.log('üìã AppState.config.modules:', AppState.config?.modules ? Object.keys(AppState.config.modules) : 'missing');
            
            if (!AppState.config || !AppState.config.modules || typeof AppState.config.modules !== 'object' || Object.keys(AppState.config.modules).length === 0) {
                console.error('‚ùå Cannot generate What\'s New: config or modules missing/invalid');
                return '';
            }
            
            const today = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            let html = `
                <div class="whats-new-header">
                    <img src="headshots/8bit_Ronda.png" alt="Ronda" class="header-headshot">
                    <h1 class="whats-new-title">Hey Brook! Here's what's new at RALPH this week</h1>
                    <div class="whats-new-subtitle">${today}</div>
                </div>
                <div class="whats-new-dashboard-grid">
                    ${generateAnnouncementsCard()}
                    ${generateNewBizCard()}
                    ${generateWhatsHappeningCard()}
                    ${generateInnovationHighlightsCard()}
                    ${generateShoutoutsCard()}
                </div>
                ${generateWeeklyShareCard()}
            `;
            
            return html;
        }

        // Remove old content generation - keeping stub for reference
        function generateOldContent() {
            const updates = [];
            
            // New Business Pipeline updates
            if (AppState.config.modules.newBiz?.enabled && AppState.config.modules.newBiz.content) {
                const pipeline = AppState.config.modules.newBiz.content;
                if (pipeline.warmLeads?.length > 0) {
                    updates.push({
                        module: 'New Business',
                        icon: 'üìä',
                        items: [`${pipeline.warmLeads.length} warm leads in pipeline`],
                        moduleId: 'newBiz'
                    });
                }
            }
            
            // Upcoming Premieres
            if (AppState.config.modules.premieres?.enabled && AppState.config.modules.premieres.content) {
                const premieres = AppState.config.modules.premieres.content;
                if (premieres.thisMonth?.length > 0) {
                    updates.push({
                        module: 'Premieres',
                        icon: 'üé¨',
                        items: premieres.thisMonth.slice(0, 2).map(p => `${p.date}: ${p.project}`),
                        moduleId: 'premieres'
                    });
                }
            }
            
            // Current Pitch Competition
            if (AppState.config.modules.pitchPlease?.enabled && AppState.config.modules.pitchPlease.content) {
                const pitchContent = AppState.config.modules.pitchPlease.content;
                if (pitchContent) {
                    updates.push({
                        module: 'Pitch, Please!',
                        icon: 'üí°',
                        items: [`${pitchContent.currentQuarter} Competition: ${pitchContent.theme}`],
                        badge: 'NEW',
                        moduleId: 'pitchPlease'
                    });
                }
            }
            
            // Birthdays & Celebrations
            if (AppState.config.modules.shoutouts?.enabled && AppState.config.modules.shoutouts.content) {
                const shoutouts = AppState.config.modules.shoutouts.content;
                const birthdayToday = shoutouts.birthdays?.find(b => b.highlight);
                if (birthdayToday) {
                    updates.push({
                        module: 'Celebrations',
                        icon: 'üéâ',
                        items: [`üéÇ ${birthdayToday.person}'s birthday today!`],
                        badge: 'TODAY',
                        moduleId: 'shoutouts'
                    });
                }
            }
            
            // RALPH News
            if (AppState.config.modules.ralphNews?.enabled && AppState.config.modules.ralphNews.content) {
                const news = AppState.config.modules.ralphNews.content;
                const liveNews = news.breaking?.filter(n => n.live);
                if (liveNews?.length > 0) {
                    updates.push({
                        module: 'Breaking News',
                        icon: 'üì¢',
                        items: liveNews.map(n => n.headline),
                        badge: 'LIVE',
                        moduleId: 'ralphNews'
                    });
                }
            }
            
            // System Announcements
            if (AppState.config.modules.announcements?.enabled && AppState.config.modules.announcements.content) {
                const announcements = AppState.config.modules.announcements.content;
                if (announcements.important?.length > 0) {
                    updates.push({
                        module: 'Important',
                        icon: 'üì£',
                        items: announcements.important.slice(0, 2),
                        badge: 'URGENT',
                        moduleId: 'announcements'
                    });
                }
            }
            
            // Build the HTML
            if (updates.length > 0) {
                updates.forEach(update => {
                    html += `
                        <div class="whats-new-section">
                            <h3>${update.icon} ${update.module}
                                ${update.badge ? `<span class="whats-new-badge">${update.badge}</span>` : ''}
                            </h3>
                    `;
                    
                    update.items.forEach(item => {
                        html += `
                            <div class="whats-new-item" onclick="openWindowBeside('${update.moduleId}', 'whatsNew');">
                                ‚ñ∫ ${item}
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                });
            } else {
                html += `
                    <div class="whats-new-section">
                        <h3>üìã No New Updates</h3>
                        <div class="whats-new-item">
                            Check back later for the latest updates from around RALPH!
                        </div>
                    </div>
                `;
            }
            
            // Add quick stats
            html += `
                <div class="whats-new-section" style="background: linear-gradient(135deg, #f9f9f9 0%, #e9e9e9 100%);">
                    <h3>üìà Quick Stats</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div class="whats-new-item" style="text-align: center;">
                            <strong>${Object.keys(AppState.config.modules).filter(m => AppState.config.modules[m].enabled).length}</strong><br>
                            Active Modules
                        </div>
                        <div class="whats-new-item" style="text-align: center;">
                            <strong>${updates.length}</strong><br>
                            New Updates
                        </div>
                    </div>
                </div>
            `;
            
            return html;
        }

        // Dashboard Card Generation Functions
        function generateAnnouncementsCard() {
            const announcements = AppState.config?.modules?.announcements?.content;
            if (!announcements) return '';
            
            return `
                <div class="dashboard-card">
                    <h3>ANNOUNCEMENTS</h3>
                    <div class="dashboard-card-content">
                        ${announcements.important?.slice(0, 3).map(item => `
                            <div class="dashboard-item">
                                <span class="badge-urgent">URGENT</span> ${item}
                            </div>
                        `).join('') || ''}
                        ${announcements.general?.slice(0, 2).map(item => `
                            <div class="dashboard-item">
                                ‚Ä¢ ${item}
                            </div>
                        `).join('') || ''}
                    </div>
                </div>
            `;
        }

        function generateNewBizCard() {
            const newBiz = AppState.config?.modules?.newBiz?.content;
            if (!newBiz) return '';
            
            return `
                <div class="dashboard-card dashboard-card-wide" onclick="openWindowBeside('newBiz', 'whatsNew');">
                    <h3>NEW BIZ PIPELINE TRACKER</h3>
                    <div class="dashboard-card-content">
                        
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px;">
                            <!-- Warm Leads -->
                            <div style="border-right: 1px solid #333; padding-right: 12px;">
                                <div style="text-align: center; margin-bottom: 12px;">
                                    <div class="stat-number" style="font-size: 24px;">${newBiz.warmLeads?.length || 0}</div>
                                    <div class="stat-label">Warm Leads</div>
                                </div>
                                <div style="font-size: 11px; line-height: 1.4;">
                                    ${newBiz.warmLeads?.map(lead => `
                                        <div style="margin-bottom: 6px; padding: 4px; background: #222; border-radius: 4px;">
                                            <strong>${lead.name}</strong><br>
                                            <span style="color: #888;">${lead.office} ‚Ä¢ ${lead.dueDate}</span>
                                        </div>
                                    `).join('') || '<div style="color: #666; text-align: center;">None</div>'}
                                </div>
                            </div>
                            
                            <!-- Active Pitches -->
                            <div style="border-right: 1px solid #333; padding-right: 12px;">
                                <div style="text-align: center; margin-bottom: 12px;">
                                    <div class="stat-number" style="font-size: 24px; color: #ffaa00;">${newBiz.pitchesHappening?.length || 0}</div>
                                    <div class="stat-label">Active</div>
                                </div>
                                <div style="font-size: 11px; line-height: 1.4;">
                                    ${newBiz.pitchesHappening?.map(pitch => `
                                        <div style="margin-bottom: 6px; padding: 4px; background: #222; border-radius: 4px; border-left: 2px solid #ffaa00;">
                                            <strong>${pitch.name}</strong><br>
                                            <span style="color: #888;">${pitch.office} ‚Ä¢ ${pitch.dueDate}</span>
                                        </div>
                                    `).join('') || '<div style="color: #666; text-align: center;">None</div>'}
                                </div>
                            </div>
                            
                            <!-- Submitted -->
                            <div style="border-right: 1px solid #333; padding-right: 12px;">
                                <div style="text-align: center; margin-bottom: 12px;">
                                    <div class="stat-number" style="font-size: 24px; color: #00aaff;">${newBiz.pitchSubmitted?.length || 0}</div>
                                    <div class="stat-label">Submitted</div>
                                </div>
                                <div style="font-size: 11px; line-height: 1.4;">
                                    ${newBiz.pitchSubmitted?.map(pitch => `
                                        <div style="margin-bottom: 6px; padding: 4px; background: #222; border-radius: 4px; border-left: 2px solid #00aaff;">
                                            <strong>${pitch.name}</strong><br>
                                            <span style="color: #888;">${pitch.office} ‚Ä¢ ${pitch.dueDate}</span>
                                        </div>
                                    `).join('') || '<div style="color: #666; text-align: center;">None</div>'}
                                </div>
                            </div>
                            
                            <!-- Presented -->
                            <div style="border-right: 1px solid #333; padding-right: 12px;">
                                <div style="text-align: center; margin-bottom: 12px;">
                                    <div class="stat-number" style="font-size: 24px; color: #aa00ff;">${newBiz.pitchPresented?.length || 0}</div>
                                    <div class="stat-label">Presented</div>
                                </div>
                                <div style="font-size: 11px; line-height: 1.4;">
                                    ${newBiz.pitchPresented?.map(pitch => `
                                        <div style="margin-bottom: 6px; padding: 4px; background: #222; border-radius: 4px; border-left: 2px solid #aa00ff;">
                                            <strong>${pitch.name}</strong><br>
                                            <span style="color: #888;">${pitch.office} ‚Ä¢ ${pitch.dueDate}</span>
                                        </div>
                                    `).join('') || '<div style="color: #666; text-align: center;">None</div>'}
                                </div>
                            </div>
                            
                            <!-- Won -->
                            <div>
                                <div style="text-align: center; margin-bottom: 12px;">
                                    <div class="stat-number" style="font-size: 24px; color: #00ff00;">${newBiz.pitchWon?.length || 0}</div>
                                    <div class="stat-label">Won</div>
                                </div>
                                <div style="font-size: 11px; line-height: 1.4;">
                                    ${newBiz.pitchWon?.map(pitch => `
                                        <div style="margin-bottom: 6px; padding: 4px; background: #222; border-radius: 4px; border-left: 2px solid #00ff00;">
                                            <strong>${pitch.name}</strong><br>
                                            <span style="color: #888;">${pitch.office} ‚Ä¢ ${pitch.dueDate}</span>
                                        </div>
                                    `).join('') || '<div style="color: #666; text-align: center;">None</div>'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateWhatsHappeningCard() {
            const premieres = AppState.config?.modules?.premieres?.content;
            const shoutouts = AppState.config?.modules?.shoutouts?.content;
            const emojis = shoutouts?.emojis || {};
            
            return `
                <div class="dashboard-card">
                    <h3>WHAT'S HAPPENING</h3>
                    <div class="dashboard-card-content">
                        ${premieres?.thisMonth?.slice(0, 2).map(item => `
                            <div class="dashboard-item" onclick="openWindowBeside('premieres', 'whatsNew');">
                                <strong>${item.date}</strong> - ${item.project}
                            </div>
                        `).join('') || ''}
                        ${shoutouts?.birthdays?.filter(b => b.highlight).map(birthday => `
                            <div class="dashboard-item">
                                <span class="badge-new">TODAY</span> ${emojis.birthday || ''} ${birthday.person}
                            </div>
                        `).join('') || ''}
                        ${shoutouts?.anniversaries?.slice(0, 1).map(anni => `
                            <div class="dashboard-item">
                                ${emojis.anniversary || ''} ${anni.person} - ${anni.years} years!
                            </div>
                        `).join('') || ''}
                    </div>
                </div>
            `;
        }

        function generateInnovationHighlightsCard() {
            const innovation = AppState.config?.modules?.innovation?.content;
            if (!innovation) return '';
            
            const experiments = innovation.experiments || [];
            const activeExperiments = experiments.filter(exp => exp.status === 'ACTIVE' || exp.status === 'DEV' || exp.status === 'BETA').slice(0, 3);
            const completedCount = experiments.filter(exp => exp.status === 'COMPLETE').length;
            
            return `
                <div class="dashboard-card" onclick="openWindowBeside('innovation', 'whatsNew');">
                    <h3>INNOVATION HIGHLIGHTS</h3>
                    <div class="dashboard-card-content">
                        <div class="dashboard-item">
                            <strong>${activeExperiments.length} Active Projects</strong>
                            <span class="badge-new">LIVE</span>
                        </div>
                        ${activeExperiments.map(exp => `
                            <div class="dashboard-item">
                                <strong>${exp.name}</strong> - ${exp.progress || 0}% complete
                                <span class="badge-${exp.status?.toLowerCase()}">${exp.status}</span>
                            </div>
                        `).join('')}
                        ${completedCount > 0 ? `
                            <div class="dashboard-item">
                                üéâ ${completedCount} projects completed this quarter
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }
        
        function generateWeeklyShareCard() {
            const sharing = AppState.config?.modules?.sharing?.content;
            if (!sharing || !AppState.config?.modules?.sharing?.enabled) return '';
            
            const items = sharing.items || [];
            const weekOf = sharing.weekOf || 'This Week';
            const giftCardAmount = sharing.giftCardAmount || '$25';
            
            return `
                <div class="weekly-share-pane">
                    <div class="weekly-share-header">
                        <h3>3 Things to Share This Week</h3>
                    </div>
                    <div class="weekly-share-grid">
                        ${items.slice(0, 3).map((item, index) => `
                            <div class="share-item" data-platform="${item.platform}">
                                <div class="share-thumbnail">
                                    <img src="${item.thumbnail}" alt="${item.title}" />
                                </div>
                                <div class="share-content">
                                    <h4 class="share-title">${item.title}</h4>
                                    <p class="share-description">${item.description}</p>
                                    <div class="share-actions">
                                        <button class="share-button share-btn" onclick="window.open('${item.shareUrl}', '_blank')">
                                            Share on ${item.platform}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function generateShoutoutsCard() {
            const shoutouts = AppState.config?.modules?.shoutouts?.content;
            if (!shoutouts) return '';
            
            return `
                <div class="dashboard-card" onclick="openWindowBeside('shoutouts', 'whatsNew');">
                    <h3>TEAM SHOUTOUTS</h3>
                    <div class="dashboard-card-content">
                        ${shoutouts.shoutouts?.slice(0, 3).map(shout => `
                            <div class="dashboard-item">
                                "${shout.message}" - ${shout.from}
                            </div>
                        `).join('') || ''}
                    </div>
                </div>
            `;
        }

        function generateQuickStatsCard() {
            const activeModules = Object.keys(AppState.config?.modules || {}).filter(
                id => AppState.config.modules[id].enabled
            ).length;
            
            const totalProjects = (AppState.config?.modules?.premieres?.content?.thisMonth?.length || 0) +
                                 (AppState.config?.modules?.premieres?.content?.nextMonth?.length || 0);
            
            return `
                <div class="dashboard-card">
                    <h3>QUICK STATS</h3>
                    <div class="dashboard-card-content">
                        <div class="dashboard-stats">
                            <div class="stat-item">
                                <span class="stat-number">${activeModules}</span>
                                <span class="stat-label">Active Modules</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">${totalProjects}</span>
                                <span class="stat-label">Projects</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Show What's New window
        function showWhatsNew(retryCount = 0) {
            // Check if config is loaded, if not wait for it
            if (!AppState.config || !AppState.config.modules || typeof AppState.config.modules !== 'object' || Object.keys(AppState.config.modules).length === 0) {
                if (retryCount < 10) { // Max 5 seconds of retries
                    console.log(`‚è≥ Config not loaded yet, waiting for config... (attempt ${retryCount + 1}/10)`);
                    setTimeout(() => showWhatsNew(retryCount + 1), 500);
                } else {
                    console.error('‚ùå Config failed to load after 5 seconds, showing fallback content');
                    // Show fallback content when config fails to load
                    const whatsNewContent = document.getElementById('whatsNewContent');
                    if (whatsNewContent) {
                        whatsNewContent.innerHTML = `
                            <div style="padding: 40px; text-align: center; color: #666;">
                                <h2>‚ö†Ô∏è Loading Configuration</h2>
                                <p>Configuration is still loading. Please refresh the page if this continues.</p>
                                <button onclick="window.location.reload()" style="padding: 10px 20px; margin-top: 20px; background: var(--ralph-pink); color: white; border: none; border-radius: 4px; cursor: pointer;">Refresh Page</button>
                            </div>
                        `;
                    }
                    openWindow('whatsNew');
                }
                return;
            }
            
            const whatsNewContent = document.getElementById('whatsNewContent');
            if (whatsNewContent) {
                whatsNewContent.innerHTML = generateWhatsNewContent();
            }
            openWindow('whatsNew');
            
            // Ensure draggable functionality is properly set up
            const whatsNewWindow = document.getElementById('whatsNew');
            if (whatsNewWindow) {
                if (!AppState.windows.whatsNew) {
                    AppState.windows.whatsNew = { draggable: null };
                }
                // Always ensure it's draggable (safe to call multiple times)
                makeDraggable(whatsNewWindow);
            }
        }

        // Show new dashboard modules (Suggestions, Announcements, Links, Innovation, Resources)
        function showDashboardModule(moduleId) {
            // Simply redirect to openWindow for consistency
            openWindow(moduleId);
        }

        function refreshAllModules() {
            if (!AppState.apiIntegration || !AppState.config) return;
            
            Object.entries(AppState.config.modules).forEach(([moduleId, moduleConfig]) => {
                if (moduleConfig.enabled && moduleConfig.apiEndpoint) {
                    AppState.apiIntegration.updateModuleContent(moduleId, moduleConfig);
                    AppState.apiIntegration.startAutoRefresh(moduleId, moduleConfig);
                }
            });
        }

        // Load desktop icons dynamically from CMS configuration
        function loadDesktopIcons() {
            // Desktop icons loading
            
            const container = document.getElementById('desktop-icons');
            if (!container) {
                console.error('Desktop icons container not found');
                return;
            }
            
            if (!AppState.config || !AppState.config.modules) {
                console.error('Configuration or modules not available');
                return;
            }
            
            // Keep Ralph.World icon but clear other icons
            const ralphWorldIcon = container.querySelector('[onclick="openRalphWorld()"]');
            const clonedRalphWorldIcon = ralphWorldIcon ? ralphWorldIcon.cloneNode(true) : null;
            container.innerHTML = '';
            
            // Add module icons in specific order as defined in CMS
            const moduleOrder = [
                'newBiz',        // Row 1, Left (New Biz Pipe)
                'premieres',     // Row 1, Right (Premiere Calendar) 
                'pitchPlease',   // Row 2, Left (Pitch Please)
                'shoutouts',     // Row 2, Right (Shoutouts)
                'articles',      // Row 3, Left (Industry Articles)
                'ralphNews',     // Row 3, Right (Ralph News Network)
                'suggestions',   // Row 4, Left (Suggestions)
                'announcements', // Row 4, Right (Announcements)
                'links',         // Row 5, Left (Quick Links)
                'innovation',    // Row 5, Right (Innovation)
                'resources',     // Row 6, Left (Resources)
                'trendspotting'  // Row 6, Right (Trendspotting)
            ];
            
            moduleOrder.forEach(moduleId => {
                const moduleConfig = AppState.config.modules[moduleId];
                if (moduleConfig && moduleConfig.enabled && moduleId !== 'music' && moduleId !== 'sharing') {
                    const iconElement = document.createElement('div');
                    iconElement.className = 'icon';
                    
                    // Special handler for Innovation module with matrix animation
                    if (moduleId === 'innovation') {
                        iconElement.onclick = () => openInnovationWindow();
                    } else {
                        iconElement.onclick = () => openWindow(moduleId);
                    }
                    
                    // Use the new iconLabel field for desktop icon naming
                    let label = moduleConfig.iconLabel || moduleConfig.windowTitle || moduleConfig.title || moduleId;
                    if (typeof label === 'string') {
                        label = label.replace(/v\d+\.\d+/g, ''); // Remove version numbers
                        label = label.replace(/\s+/g, ' ').trim(); // Clean up spaces
                    }
                    
                    // Handle special icon types (like RNN logo and text icons)
                    let iconDisplay = moduleConfig.icon;
                    if (moduleConfig.iconType === 'rnn-logo') {
                        iconDisplay = '<span class="rnn-logo">RNN</span>';
                    } else if (moduleConfig.iconType === 'text') {
                        const color = moduleConfig.iconColor || '#000';
                        iconDisplay = `<span style="color: ${color}; font-weight: bold; font-size: 24px;">${moduleConfig.icon}</span>`;
                    }
                    
                    iconElement.innerHTML = `
                        <div class="icon-image" style="position: relative;">
                            ${iconDisplay}
                            ${hasNewContent(moduleId) ? '<div class="icon-new-indicator">!</div>' : ''}
                        </div>
                        <div class="icon-label">${label}</div>
                    `;
                    
                    // Set data attribute for tracking
                    iconElement.setAttribute('data-module', moduleId);
                    
                    container.appendChild(iconElement);
                }
            });
            
            // Always ensure Ralph.World icon exists at the end
            if (clonedRalphWorldIcon) {
                // Ensure the onclick event is properly attached after cloning
                clonedRalphWorldIcon.onclick = openRalphWorld;
                container.appendChild(clonedRalphWorldIcon);
                console.log('‚úÖ Ralph.World icon re-added with click handler');
            } else {
                // Create Ralph.World icon if it didn't exist before
                console.log('üîß Creating fresh Ralph.World icon (no existing icon found)');
                const freshRalphWorldIcon = document.createElement('div');
                freshRalphWorldIcon.className = 'icon';
                freshRalphWorldIcon.onclick = openRalphWorld;
                freshRalphWorldIcon.innerHTML = `
                    <div class="icon-image">üåç</div>
                    <div class="icon-label">Ralph.World</div>
                `;
                container.appendChild(freshRalphWorldIcon);
                console.log('‚úÖ Fresh Ralph.World icon created with click handler');
            }
            
            console.log(`‚úÖ Loaded ${Object.keys(AppState.config.modules).filter(id => AppState.config.modules[id].enabled).length} desktop icons`);
        }

        // ASCII Art Animation
        function showAsciiIntro() {
            console.log('üé® Starting RALPH ASCII animation');
            const frames = [
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                      ‚ñà                         
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà                       
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà                      
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà                      
                      ‚ñà‚ñà‚ñà‚ñà‚ñà                ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà                      
                   ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà                       
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà              
              ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà              
              ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà              
               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà               
                ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà                
                 ‚ñà‚ñà‚ñà‚ñà‚ñà                               ‚ñà‚ñà‚ñà‚ñà             ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà               
                  ‚ñà‚ñà‚ñà‚ñà‚ñà                              ‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà‚ñà             
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà                                            
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà                       
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà                      
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà‚ñà                     
                         ‚ñà‚ñà                ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà‚ñà                     
                     ‚ñà‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà                      
                  ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà                
            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà             
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà             
              ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà             
              ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà              
               ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà               
                ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà                   ‚ñà‚ñà‚ñà‚ñà‚ñà            ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà               
                 ‚ñà‚ñà‚ñà‚ñà‚ñà                               ‚ñà‚ñà‚ñà‚ñà‚ñà               ‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà             
                  ‚ñà‚ñà‚ñà‚ñà‚ñà                              ‚ñà‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà            
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà                       
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                       ‚ñà‚ñà‚ñà‚ñà                     
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                       ‚ñà‚ñà‚ñà‚ñà                     
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                       ‚ñà‚ñà‚ñà‚ñà                     
                       ‚ñà‚ñà‚ñà‚ñà               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà‚ñà                     
                    ‚ñà‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà                     
           ‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà               
           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà            
            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà            
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà             
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà             
              ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà              
               ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà              
                ‚ñà‚ñà‚ñà‚ñà‚ñà                                ‚ñà‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà             
                 ‚ñà‚ñà‚ñà‚ñà‚ñà                               ‚ñà‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà‚ñà            
                   ‚ñà‚ñà                                ‚ñà‚ñà‚ñà‚ñà‚ñà                              ‚ñà           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                             ‚ñà‚ñà‚ñà‚ñà‚ñà                                                  
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà                      
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà                     
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà                     
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà                     
                      ‚ñà‚ñà‚ñà‚ñà‚ñà               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà              ‚ñà          ‚ñà‚ñà‚ñà                     
                   ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà                     
          ‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà              
          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           
           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà           
            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà            
             ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà            
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà             
              ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà             
               ‚ñà‚ñà‚ñà‚ñà          ‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà             
                ‚ñà‚ñà‚ñà‚ñà                                 ‚ñà‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà‚ñà            
                 ‚ñà‚ñà‚ñà‚ñà                                ‚ñà‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                             ‚ñà‚ñà‚ñà‚ñà‚ñà                                                  
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà                     
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà‚ñà                    
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà‚ñà                    
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà‚ñà                    
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà                    
                    ‚ñà‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà             ‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà                    
                  ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà                    
         ‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà             
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           
          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà          
           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà           
            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà            
            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà            
             ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà             
              ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                     ‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà             
               ‚ñà‚ñà‚ñà‚ñà                                   ‚ñà‚ñà‚ñà‚ñà                ‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà            
               ‚ñà‚ñà‚ñà‚ñà‚ñà                                 ‚ñà‚ñà‚ñà‚ñà‚ñà                           ‚ñà‚ñà‚ñà‚ñà‚ñà          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                                           
                                                      ‚ñà‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                             ‚ñà‚ñà‚ñà‚ñà‚ñà                                                  
                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                           ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà                    
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà                   
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà                   
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà                   
                      ‚ñà‚ñà‚ñà‚ñà                ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà                   
                   ‚ñà‚ñà‚ñà‚ñà‚ñà                  ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà                   
                 ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà                    
        ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà          
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà         
          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà          
           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà           
           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà           
            ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà            
             ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà            
             ‚ñà‚ñà‚ñà‚ñà‚ñà                                    ‚ñà‚ñà‚ñà‚ñà               ‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà           
              ‚ñà‚ñà‚ñà‚ñà‚ñà                                   ‚ñà‚ñà‚ñà‚ñà                           ‚ñà‚ñà‚ñà‚ñà‚ñà          
               ‚ñà‚ñà‚ñà‚ñà‚ñà                                  ‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà‚ñà        
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                      ‚ñà‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                             ‚ñà‚ñà‚ñà‚ñà‚ñà                                                  
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà                    
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                         ‚ñà‚ñà‚ñà‚ñà                   
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà                   
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà                  
                                          ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà‚ñà                  
                     ‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà‚ñà                  
                  ‚ñà‚ñà‚ñà‚ñà‚ñà                   ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà                   
                ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà                   
       ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà          
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà         
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà        
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà         
          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà          
          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà          
           ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà           
            ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà           
            ‚ñà‚ñà‚ñà‚ñà‚ñà          ‚ñà‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà           
             ‚ñà‚ñà‚ñà‚ñà‚ñà                                    ‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà          
              ‚ñà‚ñà‚ñà‚ñà‚ñà                                   ‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà‚ñà        
                ‚ñà‚ñà‚ñà                                  ‚ñà‚ñà‚ñà‚ñà‚ñà                                ‚ñà‚ñà‚ñà       
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                      ‚ñà‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                              ‚ñà‚ñà‚ñà                                                   
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                                                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                           ‚ñà                    
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà                   
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà                  
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà                  
                                          ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                          ‚ñà‚ñà‚ñà‚ñà                  
                                          ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                           ‚ñà‚ñà‚ñà‚ñà                  
                   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà               ‚ñà‚ñà          ‚ñà‚ñà‚ñà‚ñà                  
                ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                    ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà                  
               ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà                  
      ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà         
       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        
       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà       
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà        
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà         
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà         
          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà          
           ‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà          
           ‚ñà‚ñà‚ñà‚ñà‚ñà         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                      ‚ñà‚ñà‚ñà‚ñà‚ñà              ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà          
            ‚ñà‚ñà‚ñà‚ñà‚ñà                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà         
             ‚ñà‚ñà‚ñà‚ñà‚ñà                                    ‚ñà‚ñà‚ñà‚ñà‚ñà                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                   ‚ñà‚ñà‚ñà‚ñà                               ‚ñà‚ñà‚ñà‚ñà‚ñà      
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà                                           
                                                       ‚ñà‚ñà                                           
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    `,
                `                                                                                                    
                                                                                                    
                                            ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                 
                                           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                                
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                          ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                                               
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà                           ‚ñà‚ñà‚ñà                 
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà                            ‚ñà‚ñà‚ñà‚ñà                
                                         ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà                
                  ‚ñà‚ñà‚ñà‚ñà‚ñà                  ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà                
               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                    ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà                
             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà                
            ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà           ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà                
   ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     
     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà     
     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà     
      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà      
      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà      
       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà‚ñà‚ñà‚ñà       
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà       
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       
         ‚ñà‚ñà‚ñà‚ñà‚ñà          ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                        ‚ñà‚ñà‚ñà‚ñà‚ñà               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       
         ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                       ‚ñà‚ñà‚ñà‚ñà‚ñà                 ‚ñà‚ñà‚ñà‚ñà        ‚ñà‚ñà‚ñà‚ñà‚ñà       
          ‚ñà‚ñà‚ñà‚ñà‚ñà                                       ‚ñà‚ñà‚ñà‚ñà‚ñà                             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      
           ‚ñà‚ñà‚ñà‚ñà‚ñà                                      ‚ñà‚ñà‚ñà‚ñà‚ñà                               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    
            ‚ñà‚ñà‚ñà‚ñà                                      ‚ñà‚ñà‚ñà‚ñà‚ñà                                  ‚ñà‚ñà‚ñà‚ñà   
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                                         
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                     ‚ñà‚ñà‚ñà‚ñà‚ñà                                          
                                                      ‚ñà‚ñà‚ñà‚ñà                                          
                                                                                                    
                                                                                                    `
            ];

            const asciiElement = document.createElement('div');
            asciiElement.className = 'ascii-intro';
            asciiElement.textContent = frames[0];
            document.body.appendChild(asciiElement);
            console.log('üé® ASCII element created and added to DOM', asciiElement);

            let currentFrame = 0;
            
            // Show first frame
            setTimeout(() => {
                asciiElement.classList.add('show');
                console.log('üé® ASCII element should now be visible with opacity 1');
            }, 500);

            // Animate through frames (four times as fast as original)
            const frameInterval = setInterval(() => {
                currentFrame++;
                if (currentFrame < frames.length) {
                    asciiElement.textContent = frames[currentFrame];
                } else {
                    // Animation complete, keep final frame permanently on desktop
                    clearInterval(frameInterval);
                    
                    // Show What's New window after animation completes
                    setTimeout(() => {
                        console.log('üé® ASCII animation complete, showing What\'s New');
                        showWhatsNew();
                    }, 1000);
                }
            }, 200);
        }

        // Bring window to front by managing z-index
        function bringToFront(windowElement) {
            // Get all windows (both static and iframe)
            const allWindows = document.querySelectorAll('.window');
            
            // Reset all windows to base z-index
            allWindows.forEach(win => {
                if (win.style.zIndex > 1000) {
                    win.style.zIndex = 1000;
                }
            });
            
            // Bring clicked window to front
            AppState.zIndex = Math.max(AppState.zIndex + 1, 15001);
            windowElement.style.zIndex = AppState.zIndex;
        }

        // Get next available z-index for new windows
        function getNextWindowZIndex() {
            AppState.zIndex = Math.max(AppState.zIndex + 1, 15001);
            return AppState.zIndex;
        }

        // Create iframe window within desktop
        function openIframeWindow(url, title, width = 800, height = 600) {
            console.log('üåê Opening iframe window:', title, url);
            
            // Check if URL is Google Docs/Sheets/Slides - these can't be embedded
            if (url.includes('docs.google.com') || url.includes('drive.google.com') || url.includes('sheets.google.com') || url.includes('slides.google.com')) {
                console.log('üîó Google Docs detected - opening in new tab instead of iframe');
                window.open(url, '_blank', 'noopener,noreferrer');
                return;
            }
            
            // Generate unique window ID
            const windowId = 'iframe_' + Date.now();
            
            // Use fixed position for now to debug
            const left = 100;
            const top = 100;
            
            console.log('üéØ Window positioning:', { left, top, width, height });
            
            // Get next z-index (higher than all existing windows)
            const nextZIndex = getNextWindowZIndex();
            
            // Create window element
            const windowElement = document.createElement('div');
            windowElement.id = windowId;
            windowElement.className = 'window';
            windowElement.style.cssText = `
                position: absolute;
                top: ${top}px;
                left: ${left}px;
                width: ${width}px;
                height: ${height}px;
                z-index: ${nextZIndex};
                background: #c0c0c0;
                border: 2px outset #c0c0c0;
                box-shadow: 2px 2px 0px #808080;
                display: block !important;
            `;
            
            // Create window HTML with iframe
            windowElement.innerHTML = `
                <div class="window-header">
                    <div class="window-title">üåê ${title}</div>
                    <div class="window-controls">
                        <button class="window-button" onclick="minimizeWindow('${windowId}')">_</button>
                        <button class="window-button" onclick="maximizeWindow('${windowId}')">‚ñ°</button>
                        <button class="window-button" onclick="closeIframeWindow('${windowId}')">X</button>
                    </div>
                </div>
                <div class="window-content" style="padding: 0; overflow: hidden;">
                    <iframe 
                        src="${url}" 
                        style="width: 100%; height: 100%; border: none; background: white;"
                        frameborder="0"
                        allowfullscreen
                        onload="console.log('‚úÖ Iframe loaded successfully:', '${url}');"
                        onerror="console.error('‚ùå Iframe failed to load:', '${url}');"
                        onabort="console.warn('‚ö†Ô∏è Iframe loading aborted:', '${url}');">
                        <p style="padding: 20px; text-align: center; font-family: 'Space Mono', monospace;">
                            Loading ${title}...<br>
                            <small>If content doesn't appear, the site may not support iframe embedding.</small>
                        </p>
                    </iframe>
                </div>
            `;
            
            // Add to desktop
            document.body.appendChild(windowElement);
            
            // Ensure window fits within viewport
            constrainWindowToViewport(windowElement);
            
            console.log('üîç Element added to DOM:', {
                elementId: windowId,
                elementExists: !!document.getElementById(windowId),
                elementVisible: windowElement.offsetWidth > 0 && windowElement.offsetHeight > 0,
                computedStyle: window.getComputedStyle(windowElement).display,
                boundingRect: windowElement.getBoundingClientRect()
            });
            
            // Add iframe loading timeout and fallback option
            const iframe = windowElement.querySelector('iframe');
            let hasLoaded = false;
            
            console.log('üîç Created iframe element:', {
                exists: !!iframe,
                src: iframe?.src,
                srcAttribute: iframe?.getAttribute('src'),
                currentUrl: url
            });
            
            iframe.onload = () => {
                hasLoaded = true;
                console.log('‚úÖ Iframe content loaded successfully');
                console.log('üîç Iframe details:', {
                    src: iframe.src,
                    readyState: iframe.readyState,
                    contentWindow: !!iframe.contentWindow,
                    width: iframe.offsetWidth,
                    height: iframe.offsetHeight
                });
                
                // Try to access iframe content (will fail if cross-origin)
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    console.log('üîç Iframe document loaded:', !!iframeDoc);
                    console.log('üîç Iframe document title:', iframeDoc.title);
                    console.log('üîç Iframe document readyState:', iframeDoc.readyState);
                } catch (e) {
                    console.log('üîí Cannot access iframe content (cross-origin):', e.message);
                }
            };
            
            iframe.onerror = (error) => {
                console.error('‚ùå Iframe error event triggered:', error);
                console.log('üîç Error iframe details:', {
                    src: iframe.src,
                    readyState: iframe.readyState
                });
            };
            
            // If iframe doesn't load within 10 seconds, offer alternative
            setTimeout(() => {
                if (!hasLoaded) {
                    console.warn('‚ö†Ô∏è Iframe took too long to load, adding fallback option');
                    const fallbackButton = document.createElement('div');
                    fallbackButton.innerHTML = `
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; background: rgba(255,255,255,0.95); padding: 20px; border-radius: 8px; font-family: 'Space Mono', monospace; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                            <p style="margin: 0 0 15px 0; color: #333;">Content not loading in iframe</p>
                            <button onclick="window.open('${url}', '_blank'); closeIframeWindow('${windowId}');" 
                                    style="background: #EB008B; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-family: 'Space Mono', monospace; font-size: 14px;">
                                Open in New Tab
                            </button>
                        </div>
                    `;
                    windowElement.querySelector('.window-content').appendChild(fallbackButton);
                }
            }, 10000);
            
            // Make draggable
            makeDraggable(windowElement);
            
            // Add click handler to bring to front
            windowElement.addEventListener('mousedown', () => {
                bringToFront(windowElement);
            });
            
            // Focus the window
            bringToFront(windowElement);
            
            console.log('‚úÖ Iframe window created:', windowId);
            return windowId;
        }

        // Close iframe window
        function closeIframeWindow(windowId) {
            const windowElement = document.getElementById(windowId);
            if (windowElement) {
                windowElement.remove();
                console.log('üóëÔ∏è Iframe window closed:', windowId);
            }
        }

        // Admin login functionality
        function openRalphWorld() {
            console.log('üåç Opening Ralph.World...');
            console.log('üîß AppState.config available:', !!AppState.config);
            console.log('üîß AppState.config.system available:', !!AppState.config?.system);
            
            const url = AppState.config?.system?.ralphWorldUrl || 'https://ralph.world';
            console.log('üîó Using URL:', url);
            console.log('üîó URL type:', typeof url);
            console.log('üîó URL length:', url.length);
            console.log('üîó URL starts with https:', url.startsWith('https://'));
            console.log('üéØ About to call openIframeWindow with:', { url, title: 'Ralph.World - Company Website', width: 1000, height: 700 });
            
            // Test the URL directly first
            console.log('üß™ Testing URL accessibility...');
            fetch(url, { mode: 'no-cors' })
                .then(() => console.log('‚úÖ URL is accessible'))
                .catch(err => console.error('‚ùå URL access failed:', err));
            
            openIframeWindow(url, 'Ralph.World - Company Website', 1000, 700);
            console.log('‚úÖ openIframeWindow call completed');
        }
        
        function openAdminLogin() {
            openWindow('adminLogin');
            // Focus on username field
            setTimeout(() => {
                document.getElementById('adminUsername').focus();
            }, 100);
        }
        
        // User Profile Functions
        function openUserProfile() {
            // Use the standard window opening pattern
            openWindow('userProfile');
            
            // Center it horizontally, position near top  
            const profileWindow = document.getElementById('userProfile');
            if (profileWindow) {
                const windowWidth = 500; // Match the width in the HTML
                const centerLeft = (window.innerWidth - windowWidth) / 2;
                profileWindow.style.left = centerLeft + 'px';
                profileWindow.style.top = '80px';
                profileWindow.style.transform = 'none';
                
                // Load existing profile data and set up event listeners
                loadUserProfile();
                
                // Add office selection change handler
                const officeSelect = document.getElementById('userOffice');
                if (officeSelect) {
                    officeSelect.addEventListener('change', updateOfficeFlag);
                }
            }
        }
        
        function loadUserProfile() {
            // Load saved profile from localStorage
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                const profile = JSON.parse(savedProfile);
                
                // Set office
                const officeSelect = document.getElementById('userOffice');
                if (officeSelect && profile.office) {
                    officeSelect.value = profile.office;
                    // Update flag display
                    updateOfficeFlag();
                }
                
                // Set content priorities
                if (profile.priorities) {
                    profile.priorities.forEach(priority => {
                        const checkbox = document.getElementById(`priority-${priority}`);
                        if (checkbox) {
                            checkbox.checked = true;
                        }
                    });
                }
                
                // Set preferred name
                if (profile.preferredName) {
                    const preferredNameElement = document.getElementById('preferredName');
                    if (preferredNameElement) {
                        preferredNameElement.value = profile.preferredName;
                    }
                }
            }
        }
        
        function updateOfficeFlag() {
            const officeSelect = document.getElementById('userOffice');
            const flagElement = document.getElementById('officeFlag');
            
            if (!officeSelect || !flagElement) return;
            
            const officeFlags = {
                'la': 'üá∫üá∏',
                'ny': 'üá∫üá∏', 
                'lon': 'üá¨üáß',
                'mum': 'üáÆüá≥',
                'tok': 'üáØüáµ'
            };
            
            const selectedOffice = officeSelect.value;
            if (selectedOffice && officeFlags[selectedOffice]) {
                flagElement.textContent = officeFlags[selectedOffice];
                flagElement.style.display = 'block';
            } else {
                flagElement.style.display = 'none';
            }
        }
        
        function saveUserProfile() {
            const profile = {
                office: document.getElementById('userOffice').value,
                priorities: [],
                preferredName: document.getElementById('preferredName').value,
                savedAt: new Date().toISOString()
            };
            
            // Get checked priorities
            const priorityCheckboxes = document.querySelectorAll('#userProfile input[type="checkbox"]:checked');
            priorityCheckboxes.forEach(checkbox => {
                profile.priorities.push(checkbox.value);
            });
            
            // Save to localStorage
            localStorage.setItem('userProfile', JSON.stringify(profile));
            
            // Show confirmation
            showNotification('‚úÖ Profile preferences saved!');
            
            // Apply preferences (future implementation)
            applyUserPreferences(profile);
            
            // Close window
            setTimeout(() => {
                closeWindow('userProfile');
            }, 1000);
        }
        
        function applyUserPreferences(profile) {
            // This function can be expanded to:
            // - Filter content based on priorities
            // - Show office-specific content first
            // - Customize dashboard layout
            // - Update timezone display
            console.log('User preferences applied:', profile);
            
            // Update What's New content based on preferences (placeholder)
            if (profile.office) {
                // Could filter news by office location
                console.log(`Filtering content for ${profile.office} office`);
            }
            
            if (profile.priorities && profile.priorities.length > 0) {
                // Could prioritize content modules
                console.log(`Content priorities: ${profile.priorities.join(', ')}`);
            }
        }

        // SECURITY: Admin credentials removed for production
        // Authentication should be handled server-side with proper security

        // Handle admin login form and load pitch draft
        document.addEventListener('DOMContentLoaded', () => {
            // Load pitch draft if exists
            setTimeout(() => loadPitchDraft(), 1000);
            const adminForm = document.getElementById('adminLoginForm');
            if (adminForm) {
                adminForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const username = document.getElementById('adminUsername').value;
                    const password = document.getElementById('adminPassword').value;
                    
                    try {
                        const response = await fetch('/api/admin-auth', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ username, password })
                        });
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            // Success - redirect to admin panel with session
                            showNotification('Access granted! Opening CMS...');
                            setTimeout(() => {
                                window.open(`/admin/${result.sessionId}`, '_blank');
                                closeWindow('adminLogin');
                                // Clear form values
                                document.getElementById('adminUsername').value = '';
                                document.getElementById('adminPassword').value = '';
                            }, 1500);
                        } else {
                            throw new Error('Authentication failed');
                        }
                    } catch (error) {
                        // Show error
                        const errorDiv = document.getElementById('adminLoginError');
                        errorDiv.style.display = 'block';
                        
                        // Clear error after 3 seconds
                        setTimeout(() => {
                            errorDiv.style.display = 'none';
                        }, 3000);
                        
                        // Clear password field
                        document.getElementById('adminPassword').value = '';
                    }
                });
                
                // Enter key support for password field
                document.getElementById('adminPassword').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        adminForm.dispatchEvent(new Event('submit'));
                    }
                });
            }
        });

        // Form submission handler
        async function submitSuggestion() {
            const nameInput = document.querySelector('#suggestions input[type="text"]');
            const ideaInput = document.querySelector('#suggestions textarea');
            
            if (!nameInput || !ideaInput) return;
            
            const data = {
                name: nameInput.value.trim(),
                idea: ideaInput.value.trim(),
                timestamp: new Date().toISOString()
            };
            
            if (!data.name || !data.idea) {
                showNotification('Please fill in all fields!');
                return;
            }
            
            if (AppState.config?.modules?.suggestions?.submitEndpoint) {
                const result = await AppState.apiIntegration.submitData(
                    AppState.config.modules.suggestions.submitEndpoint,
                    data
                );
                
                if (result.success) {
                    nameInput.value = '';
                    ideaInput.value = '';
                    showNotification('Suggestion submitted successfully!');
                } else {
                    showNotification('Failed to submit suggestion. Please try again.');
                }
            } else {
                // Simulate success if no API endpoint
                nameInput.value = '';
                ideaInput.value = '';
                showNotification('Suggestion submitted!');
            }
        }
        
        // Responsive handling
        function handleResize() {
            const wasMobile = AppState.isMobile;
            AppState.isMobile = Utils.isMobileDevice();
            
            if (wasMobile !== AppState.isMobile) {
                // Reset window positions when switching between mobile and desktop
                document.querySelectorAll('.window').forEach(windowEl => {
                    if (AppState.isMobile) {
                        windowEl.style.cssText = '';
                    } else {
                        windowEl.dataset.maximized = 'false';
                    }
                });
            }
        }
        
        // Random character animation for ASCII art
        function randomAnimateAscii(element, duration = 2000) {
            if (!element) {
                console.error('‚ùå Random animation: element not found');
                return;
            }
            
            const originalText = element.textContent;
            const chars = [];
            
            // Wrap each character in a span with class for animation
            let wrappedText = '';
            for (let i = 0; i < originalText.length; i++) {
                const char = originalText[i];
                if (char === '\n') {
                    wrappedText += '\n';
                } else if (char === ' ') {
                    wrappedText += ' '; // Keep spaces as-is
                } else {
                    chars.push(i);
                    wrappedText += `<span class="ascii-char" data-index="${i}">${char}</span>`;
                }
            }
            
            element.innerHTML = wrappedText;
            
            // Shuffle the character indices for random order
            const shuffledChars = [...chars].sort(() => Math.random() - 0.5);
            
            // Calculate timing for animation
            const delayBetweenChars = duration / shuffledChars.length;
            
            console.log(`üé≤ Starting random ASCII animation:`, {
                element: element.className,
                totalChars: chars.length,
                duration: duration + 'ms',
                delayPerChar: delayBetweenChars.toFixed(2) + 'ms'
            });
            
            // Animate characters in random order
            shuffledChars.forEach((charIndex, animationIndex) => {
                setTimeout(() => {
                    const charSpan = element.querySelector(`[data-index="${charIndex}"]`);
                    if (charSpan) {
                        charSpan.classList.add('visible');
                    }
                    
                    // Log completion
                    if (animationIndex === shuffledChars.length - 1) {
                        console.log('‚úÖ Random ASCII animation complete for', element.className);
                    }
                }, animationIndex * delayBetweenChars);
            });
        }
        
        // Start typing animation for login text in sequence
        function startLoginTypingAnimation() {
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const submitBtn = document.querySelector('.login-btn');
            
            // Get elements in the order they should appear
            const loginForm = document.querySelector('.login-form');
            const allTypingElements = loginForm.querySelectorAll('.typing-text');
            
            // Build sequence in correct order
            const sequence = [
                { element: allTypingElements[0] }, // "INTRANET AUTHENTICATION REQUIRED"
                { element: allTypingElements[1] }, // "USERNAME:"
                { showInput: usernameInput },
                { element: allTypingElements[2] }, // "PASSWORD:"
                { showInput: passwordInput },
                { element: allTypingElements[3] }, // "Authenticate to proceed"
                { showButton: submitBtn }
            ];
            
            // Execute sequence step by step
            let currentStep = 0;
            
            function executeNextStep() {
                if (currentStep >= sequence.length) return;
                
                const item = sequence[currentStep];
                
                if (item.element) {
                    item.element.style.opacity = '1';
                    item.element.classList.add('active');
                    
                    // After typing completes, move to next step
                    setTimeout(() => {
                        item.element.classList.add('typed-complete');
                        item.element.style.width = 'auto';
                        item.element.style.opacity = '1';
                        currentStep++;
                        executeNextStep();
                    }, 500); // 400ms for typing + 100ms buffer
                    
                } else if (item.showInput) {
                    item.showInput.style.display = 'block';
                    item.showInput.style.opacity = '1';
                    item.showInput.classList.add('revealed');
                    
                    currentStep++;
                    setTimeout(executeNextStep, 200);
                    
                } else if (item.showButton) {
                    item.showButton.style.display = 'block';
                    item.showButton.style.opacity = '1';
                    item.showButton.classList.add('revealed');
                    
                    currentStep++;
                    setTimeout(executeNextStep, 200);
                }
            }
            
            // Start the sequence
            executeNextStep();
        }

        // Start login ASCII fade-in animation
        function startLoginAsciiAnimation() {
            const bootLogo = document.querySelector('.boot-logo');
            const bootScreen = document.getElementById('bootScreen');
            if (!bootLogo || !bootScreen) return;
            
            console.log('üé¨ Starting login ASCII fade-in animation');
            
            // Reset all previous states completely
            bootScreen.classList.remove('login-mode');
            bootLogo.style.animation = 'none';
            bootLogo.style.maskImage = 'none';
            bootLogo.style.webkitMaskImage = 'none';
            bootLogo.style.filter = 'none';
            bootLogo.style.transform = 'none';
            
            // Start completely hidden (black screen)
            bootLogo.style.opacity = '0';
            bootLogo.style.transition = 'opacity 0.8s ease-in';
            
            // Force a reflow to ensure all styles are applied
            bootLogo.offsetHeight;
            
            console.log('üì∫ Boot logo hidden, starting fade-in timer');
            
            // Fade in from black after 500ms
            setTimeout(() => {
                console.log('‚ú® Starting fade-in to opacity 1');
                bootLogo.style.opacity = '1';
                
                // Start typing animation after ASCII appears
                setTimeout(() => {
                    startLoginTypingAnimation();
                }, 1000); // Wait longer for ASCII to be visible first
                
                // After fade-in completes (0.8 seconds), enable gentle flicker
                setTimeout(() => {
                    console.log('üí´ Fade-in complete, enabling gentle flicker');
                    bootScreen.classList.add('login-mode');
                    bootLogo.style.transition = 'none'; // Remove transition so flicker can work
                    
                    // Force apply flicker animation directly
                    bootLogo.style.animation = 'flicker 0.1s infinite';
                    
                    console.log('üé≠ Added login-mode class to:', bootScreen.className);
                    console.log('üí° ASCII element classes:', bootLogo.className);
                    
                    // Force check that animation is applied
                    const computedStyle = window.getComputedStyle(bootLogo);
                    console.log('üé™ Animation applied:', computedStyle.animation);
                    console.log('üé™ Animation name:', computedStyle.animationName);
                }, 800);
            }, 500);
        }

        // Start boot ASCII scan line loading animation  
        function startBootAsciiAnimation() {
            const bootLogo = document.querySelector('.boot-logo');
            if (!bootLogo) return;
            
            // Reset any previous styling and hide initially
            bootLogo.style.transition = 'none';
            bootLogo.style.opacity = '0';
            bootLogo.style.maskImage = 'linear-gradient(to bottom, transparent 0%, transparent 100%)';
            bootLogo.style.webkitMaskImage = 'linear-gradient(to bottom, transparent 0%, transparent 100%)';
            
            // Show it immediately but masked
            setTimeout(() => {
                // Start with very low opacity and fade in
                bootLogo.style.opacity = '0.1';
                
                // Create scan line loading effect
                let scanProgress = 0;
                const scanSpeed = 8; // milliseconds between updates
                const totalDuration = 1200; // total time to load
                const updateInterval = totalDuration / 100; // 100 steps
                
                const scanInterval = setInterval(() => {
                    scanProgress += (100 / (totalDuration / updateInterval));
                    
                    // Add some jerkiness to the scan
                    const jitter = Math.random() * 3 - 1.5; // -1.5 to +1.5
                    const actualProgress = Math.min(100, scanProgress + jitter);
                    
                    // Fade in the ASCII as it loads (CRT warming up effect)
                    const fadeOpacity = Math.min(1, (scanProgress / 100) * 1.2); // Slightly faster fade than scan
                    bootLogo.style.opacity = fadeOpacity;
                    
                    // Create the mask effect - revealing from top to bottom
                    const maskValue = `linear-gradient(to bottom, 
                        rgba(0,0,0,1) 0%, 
                        rgba(0,0,0,1) ${actualProgress}%, 
                        transparent ${actualProgress + 2}%, 
                        transparent 100%)`;
                    
                    bootLogo.style.maskImage = maskValue;
                    bootLogo.style.webkitMaskImage = maskValue;
                    
                    // Add scan line flicker effect (more intense)
                    if (Math.random() < 0.5) { // 50% chance of flicker
                        const flickerIntensity = Math.random() * 0.4 + 0.8; // 0.8 to 1.2
                        const contrastFlicker = Math.random() * 0.3 + 1.0; // 1.0 to 1.3
                        bootLogo.style.filter = `brightness(${flickerIntensity}) contrast(${contrastFlicker})`;
                        setTimeout(() => {
                            bootLogo.style.filter = 'brightness(1) contrast(1)';
                        }, Math.random() * 30 + 10); // 10-40ms flicker duration
                    }
                    
                    // Additional random brightness flickers
                    if (Math.random() < 0.2) { // 20% chance of extra flicker
                        bootLogo.style.opacity = fadeOpacity * (Math.random() * 0.3 + 0.7); // 70-100% of normal
                        setTimeout(() => {
                            bootLogo.style.opacity = fadeOpacity;
                        }, 15);
                    }
                    
                    if (scanProgress >= 100) {
                        clearInterval(scanInterval);
                        // Final reveal
                        bootLogo.style.maskImage = 'none';
                        bootLogo.style.webkitMaskImage = 'none';
                        
                        // After ASCII reveal completes, enable flicker and start login form typing animation
                        setTimeout(() => {
                            // Enable flicker on ASCII
                            console.log('üí´ ASCII scan complete, enabling flicker');
                            bootLogo.style.animation = 'flicker 0.1s infinite';
                            bootScreen.classList.add('login-mode');
                            
                            startLoginTypingAnimation();
                        }, 300);
                    }
                }, updateInterval);
                
            }, 100);
        }
        
        // Global audio setup
        let bootAudioReady = null;
        
        // Prepare audio on first user interaction
        function prepareBootAudio() {
            if (!bootAudioReady) {
                bootAudioReady = new Audio('/music/windows-startup.mp3');
                bootAudioReady.volume = 0.4;
                bootAudioReady.preload = 'auto';
                bootAudioReady.load();
                console.log('üîä Boot audio prepared on user interaction');
            }
        }
        
        // Add event listeners for user interaction
        document.addEventListener('click', prepareBootAudio, { once: true });
        document.addEventListener('keydown', prepareBootAudio, { once: true });
        document.addEventListener('touchstart', prepareBootAudio, { once: true });
        
        // Play boot completion sound
        function playBootCompletionSound() {
            console.log('üîä playBootCompletionSound() called');
            
            // If audio wasn't prepared by user interaction, try Web Audio API
            if (!bootAudioReady) {
                console.log('üîä No user interaction yet, using Web Audio API fallback');
                tryAlternativeAudio();
                return;
            }
            
            try {
                const playPromise = bootAudioReady.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        console.log('‚úÖ Boot sound playing successfully!');
                    }).catch(error => {
                        console.log('‚ùå Boot sound failed, trying fallback:', error.name);
                        tryAlternativeAudio();
                    });
                } else {
                    console.log('üîä Playing audio (older browser)');
                }
                
            } catch (error) {
                console.log('‚ùå Boot sound error, trying fallback:', error);
                tryAlternativeAudio();
            }
        }
        
        // Alternative audio approach for autoplay restrictions
        function tryAlternativeAudio() {
            console.log('üîä Trying alternative audio approach');
            // Create a simple audio context beep as fallback
            if (window.AudioContext || window.webkitAudioContext) {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 523; // C note
                    oscillator.type = 'sine';
                    gainNode.gain.value = 0.1;
                    
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.5);
                    console.log('üîä Fallback beep sound played');
                } catch (e) {
                    console.log('‚ùå Fallback audio also failed:', e);
                }
            }
        }
        
        // Start desktop ASCII random animation
        function startDesktopAsciiAnimation() {
            const desktopAscii = document.querySelector('.desktop-ascii');
            if (!desktopAscii) return;
            
            // Start animation with 1 second duration (twice as fast)
            setTimeout(() => {
                desktopAscii.classList.add('animating');
                randomAnimateAscii(desktopAscii, 1000);
            }, 1000); // Small delay to let boot complete first
        }

        // Login handler
        function handleLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            // Simple validation - any non-empty values work
            if (username && password) {
                startBootSequence();
            } else {
                // Flash the inputs if empty
                const inputs = document.querySelectorAll('.login-input');
                inputs.forEach(input => {
                    if (!input.value.trim()) {
                        input.style.borderColor = '#ff4444';
                        input.style.boxShadow = '0 0 5px #ff4444';
                        setTimeout(() => {
                            input.style.borderColor = 'var(--terminal-green)';
                            input.style.boxShadow = 'none';
                        }, 1000);
                    }
                });
            }
        }
        
        // Allow Enter key to submit login
        function setupLoginKeyHandler() {
            const inputs = document.querySelectorAll('.login-input');
            inputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        handleLogin();
                    }
                });
            });
        }
        
        // Start boot sequence after login
        function startBootSequence() {
            const loginScreen = document.getElementById('loginScreen');
            const bootSequence = document.getElementById('bootSequence');
            const bootScreen = document.getElementById('bootScreen');
            const bootLogo = document.querySelector('.boot-logo');
            
            console.log('üöÄ Starting boot sequence transition');
            
            // Remove CRT flicker from boot screen
            bootScreen.classList.remove('login-mode');
            bootLogo.style.animation = 'none';
            
            // Simply fade out the login form elements while keeping ASCII
            const loginForm = document.querySelector('.login-form');
            if (loginForm) {
                loginForm.style.opacity = '0';
                loginForm.style.transition = 'opacity 0.3s ease';
            }
            
            // After login form disappears, show boot sequence elements around existing ASCII
            setTimeout(() => {
                // Hide login form completely 
                loginForm.style.display = 'none';
                
                // Show boot sequence elements (they'll appear around the existing ASCII)
                const bootText = document.querySelector('.boot-text');
                const loadingContainer = document.querySelector('.loading-bar-container'); 
                const bootMessages = document.querySelector('.boot-messages');
                
                if (bootText) {
                    bootText.style.opacity = '0';
                    bootText.style.display = 'block';
                    setTimeout(() => bootText.style.opacity = '1', 100);
                }
                
                if (loadingContainer) {
                    loadingContainer.style.opacity = '0';
                    loadingContainer.style.display = 'flex';
                    setTimeout(() => loadingContainer.style.opacity = '1', 200);
                }
                
                if (bootMessages) {
                    bootMessages.style.opacity = '0';
                    bootMessages.style.display = 'block';
                    setTimeout(() => bootMessages.style.opacity = '1', 300);
                }
                
                // Start the actual boot sequence
                runBootSequence();
            }, 300);
        }

        // Boot sequence
        function runBootSequence() {
            const bootScreen = document.getElementById('bootScreen');
            const desktop = document.getElementById('desktop');
            const loadingBar = document.getElementById('loadingBar');
            const loadingPercentage = document.getElementById('loadingPercentage');
            const bootMessages = document.getElementById('bootMessages');
            
            console.log('üöÄ Boot sequence starting...', {
                bootScreen: !!bootScreen,
                desktop: !!desktop,
                loadingBar: !!loadingBar,
                loadingPercentage: !!loadingPercentage,
                bootMessages: !!bootMessages
            });
            
            if (!bootScreen || !desktop) return;
            
            const messages = [
                'Loading system kernel...',
                'Initializing RALPH protocols...',
                'Checking security clearance...',
                'Loading user preferences...',
                'Mounting network drives...',
                'Starting creative services...',
                'Loading project database...',
                'Initializing communication modules...',
                'Checking for updates...',
                'Loading desktop environment...',
                'Starting RALPH SUPER-INTRANET...',
                'System ready!'
            ];
            
            let progress = 0;
            let messageIndex = 0;
            
            let bootInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                if (loadingBar) loadingBar.style.width = progress + '%';
                if (loadingPercentage) loadingPercentage.textContent = Math.floor(progress) + '%';
                
                if (bootMessages && messageIndex < messages.length && 
                    progress > (messageIndex / messages.length) * 100) {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'boot-message';
                    messageDiv.textContent = '> ' + messages[messageIndex];
                    bootMessages.appendChild(messageDiv);
                    bootMessages.scrollTop = bootMessages.scrollHeight;
                    messageIndex++;
                }
                
                // Play sound at 85% completion (before page transition)
                if (progress >= 85 && !window.bootSoundPlayed) {
                    window.bootSoundPlayed = true;
                    playBootCompletionSound();
                }
                
                if (progress >= 100) {
                    clearInterval(bootInterval);
                    
                    setTimeout(() => {
                        bootScreen.classList.add('hide');
                        desktop.style.display = 'block';
                        
                        // Show taskbar now that desktop is ready
                        const taskbar = document.querySelector('.taskbar');
                        if (taskbar) {
                            taskbar.style.display = 'flex';
                        }
                        
                        // Show ASCII intro sequence
                        showAsciiIntro();
                        
                        // Old desktop ASCII animation disabled
                        
                        
                        // Make chatbot window draggable
                        const chatbotWindow = document.getElementById('chatbot');
                        if (chatbotWindow && !AppState.isMobile) {
                            makeDraggable(chatbotWindow);
                        }
                        
                        setTimeout(() => {
                            showNotification('RALPH INTRANET SYSTEM 1.0 - READY');
                        }, 500);
                        
                        // Welcome banner auto-popup removed per user request
                    }, 1000);
                }
            }, 300);
        }
        
        // Welcome Banner Functions
        function showWelcomeBanner() {
            const banner = document.getElementById('welcomeBanner');
            if (banner) {
                banner.classList.add('show');
            }
        }
        
        function closeBanner() {
            const banner = document.getElementById('welcomeBanner');
            if (banner) {
                banner.classList.remove('show');
            }
        }
        
        // Music Player Functionality
        let musicPlayer = {
            audio: null,
            isPlaying: false,
            currentTrack: 0,
            volume: 0.7,
            playlist: [] // Will be loaded from CMS config
        };
        
        function toggleMusicPlayer() {
            const player = document.getElementById('musicPlayer');
            const button = document.querySelector('.sound-button');
            
            if (player.classList.contains('active')) {
                player.classList.remove('active');
                button.classList.remove('active');
            } else {
                player.classList.add('active');
                button.classList.add('active');
                initializeMusicPlayer();
                
                // Make draggable if not already
                if (!player.draggableInitialized && !AppState.isMobile) {
                    makeMusicPlayerDraggable(player);
                    player.draggableInitialized = true;
                }
            }
        }
        
        function initializeMusicPlayer() {
            console.log('üéµ Initializing music player...');
            console.log('üéµ Current playlist length:', musicPlayer.playlist.length);
            console.log('üéµ AppState.config exists:', !!AppState.config);
            
            // Load playlist from CMS config if not already loaded
            if (musicPlayer.playlist.length === 0 && AppState.config && AppState.config.modules && AppState.config.modules.music) {
                const musicModule = AppState.config.modules.music;
                console.log('üéµ Music module found:', musicModule);
                console.log('üéµ Music module enabled:', musicModule.enabled);
                console.log('üéµ Music module content:', musicModule.content);
                
                if (musicModule.content && musicModule.content.tracks) {
                    console.log('üéµ Loading tracks:', musicModule.content.tracks);
                    musicPlayer.playlist = musicModule.content.tracks.map(track => ({
                        title: track.title,
                        artist: track.artist,
                        file: track.file
                    }));
                    console.log('üéµ Playlist loaded with', musicPlayer.playlist.length, 'tracks');
                } else {
                    console.log('üéµ No tracks found in music module content');
                }
            } else {
                console.log('üéµ Playlist already loaded or config not available');
                if (!AppState.config) console.log('üéµ - No AppState.config');
                if (!AppState.config?.modules) console.log('üéµ - No modules in config');
                if (!AppState.config?.modules?.music) console.log('üéµ - No music module in config');
            }
            
            if (!musicPlayer.audio) {
                musicPlayer.audio = new Audio();
                musicPlayer.audio.volume = musicPlayer.volume;
                
                musicPlayer.audio.addEventListener('timeupdate', updateTrackTime);
                musicPlayer.audio.addEventListener('ended', nextTrack);
                musicPlayer.audio.addEventListener('loadstart', () => {
                    document.getElementById('trackInfo').textContent = 'Loading...';
                });
                musicPlayer.audio.addEventListener('canplay', () => {
                    const track = musicPlayer.playlist[musicPlayer.currentTrack];
                    if (track) {
                        document.getElementById('trackInfo').textContent = `${track.artist} - ${track.title}`;
                    }
                });
                musicPlayer.audio.addEventListener('error', () => {
                    document.getElementById('trackInfo').textContent = 'Error loading track';
                });
                
                loadCurrentTrack();
            }
        }
        
        function loadCurrentTrack() {
            if (musicPlayer.playlist.length > 0 && musicPlayer.currentTrack < musicPlayer.playlist.length) {
                const track = musicPlayer.playlist[musicPlayer.currentTrack];
                musicPlayer.audio.src = track.file;
                document.getElementById('trackInfo').textContent = `${track.artist} - ${track.title}`;
                document.getElementById('trackTime').textContent = '00:00 / 00:00';
            }
        }
        
        function togglePlayPause() {
            if (!musicPlayer.audio) {
                initializeMusicPlayer();
                return;
            }
            
            const playBtn = document.getElementById('playBtn');
            
            if (musicPlayer.isPlaying) {
                musicPlayer.audio.pause();
                playBtn.textContent = '‚ñ∂';
                musicPlayer.isPlaying = false;
            } else {
                musicPlayer.audio.play().then(() => {
                    playBtn.textContent = '‚è∏';
                    musicPlayer.isPlaying = true;
                }).catch(() => {
                    showNotification('Error playing audio - check file path');
                });
            }
        }
        
        function stopTrack() {
            if (musicPlayer.audio) {
                musicPlayer.audio.pause();
                musicPlayer.audio.currentTime = 0;
                document.getElementById('playBtn').textContent = '‚ñ∂';
                musicPlayer.isPlaying = false;
                updateTrackTime();
            }
        }
        
        function previousTrack() {
            if (musicPlayer.playlist.length > 0) {
                musicPlayer.currentTrack = (musicPlayer.currentTrack - 1 + musicPlayer.playlist.length) % musicPlayer.playlist.length;
                loadCurrentTrack();
                if (musicPlayer.isPlaying) {
                    togglePlayPause();
                    setTimeout(togglePlayPause, 100);
                }
            }
        }
        
        function nextTrack() {
            if (musicPlayer.playlist.length > 0) {
                musicPlayer.currentTrack = (musicPlayer.currentTrack + 1) % musicPlayer.playlist.length;
                loadCurrentTrack();
                if (musicPlayer.isPlaying) {
                    togglePlayPause();
                    setTimeout(togglePlayPause, 100);
                }
            }
        }
        
        function updateTrackTime() {
            if (musicPlayer.audio) {
                const current = formatTime(musicPlayer.audio.currentTime || 0);
                const duration = formatTime(musicPlayer.audio.duration || 0);
                document.getElementById('trackTime').textContent = `${current} / ${duration}`;
                
                // Update progress bar if exists
                const progressBar = document.querySelector('.track-progress');
                if (progressBar && musicPlayer.audio.duration) {
                    const progress = (musicPlayer.audio.currentTime / musicPlayer.audio.duration) * 100;
                    progressBar.style.width = progress + '%';
                }
            }
        }
        
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '00:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        function setVolume(value) {
            musicPlayer.volume = value / 100;
            if (musicPlayer.audio) {
                musicPlayer.audio.volume = musicPlayer.volume;
            }
            // Update slider visual if needed
            const slider = document.getElementById('volumeSlider');
            if (slider && typeof value === 'number') {
                slider.value = value;
            }
        }
        
        function makeMusicPlayerDraggable(element) {
            if (AppState.isMobile) return; // Disable dragging on mobile
            
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            const header = element.querySelector('.player-header');
            if (!header) return;
            
            const dragMouseDown = (e) => {
                e = e || window.event;
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            };
            
            const elementDrag = (e) => {
                e = e || window.event;
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                let newTop = element.offsetTop - pos2;
                let newLeft = element.offsetLeft - pos1;
                
                // Keep within viewport bounds
                const rect = element.getBoundingClientRect();
                const maxTop = window.innerHeight - rect.height - 40;
                const maxLeft = window.innerWidth - rect.width;
                
                newTop = Math.max(0, Math.min(newTop, maxTop));
                newLeft = Math.max(0, Math.min(newLeft, maxLeft));
                
                element.style.top = newTop + "px";
                element.style.left = newLeft + "px";
                element.style.right = "auto"; // Override right positioning
                element.style.bottom = "auto"; // Override bottom positioning
            };
            
            const closeDragElement = () => {
                document.onmouseup = null;
                document.onmousemove = null;
            };
            
            header.onmousedown = dragMouseDown;
            header.style.cursor = 'move';
        }
        

        // Initialize application
        // DEVELOPMENT FLAG - Set to false to skip boot screen and login
        const ENABLE_BOOT_LOGIN = false; // Change to true to re-enable
        
        async function init() {
            // Detect device type
            AppState.isMobile = Utils.isMobileDevice();
            AppState.touchDevice = 'ontouchstart' in window;
            
            // Enable audio on first user interaction
            document.addEventListener('click', initAudio, { once: true });
            document.addEventListener('keydown', initAudio, { once: true });
            document.addEventListener('touchstart', initAudio, { once: true });
            
            // Load CMS configuration
            if (typeof CMS_CONFIG !== 'undefined') {
                AppState.config = CMS_CONFIG;
                
                // Initialize API integration
                if (typeof APIIntegration !== 'undefined') {
                    AppState.apiIntegration = new APIIntegration(AppState.config);
                }
                
                // Chatbot is now handled server-side for security
                console.log('üí¨ Chatbot configured - using secure server endpoint');
                
                // Load desktop icons from CMS configuration
                loadDesktopIcons();
                
                // Initialize music player with CMS data
                initializeMusicPlayer();
                
                // Initialize chatbot content from CMS
                initializeChatbotContent();
                
                // Initialize info panel content from CMS
                initializeInfoPanelContent();
                
                // Update module descriptions from CMS
                updateModuleDescriptions();
                
                // Initialize all windows to ensure they're draggable
                // Clear any existing window states first to prevent conflicts
                AppState.windows = {};
                const allWindows = ['suggestions', 'announcements', 'links', 'innovation', 'resources', 
                                   'newBiz', 'premieres', 'shoutouts', 'articles', 
                                   'whatsNew', 'ralphNews', 'chatbot', 'info', 'trendspotting', 'userProfile'];
                allWindows.forEach(windowId => {
                    const windowEl = document.getElementById(windowId);
                    if (windowEl) {
                        // Ensure window is properly positioned and independent
                        windowEl.style.position = 'absolute';
                        // Clear any CSS z-index that might interfere
                        windowEl.style.zIndex = '';
                        
                        // Initialize fresh window state
                        AppState.windows[windowId] = { draggable: null };
                        makeDraggable(windowEl);
                    }
                });
                
                // Auto-popup removed per user request
            }
            
            // Skip boot screen and login if disabled for development
            if (!ENABLE_BOOT_LOGIN) {
                // Hide boot screen immediately
                const bootScreen = document.getElementById('bootScreen');
                const loginScreen = document.getElementById('loginScreen');
                if (bootScreen) {
                    bootScreen.style.display = 'none';
                }
                if (loginScreen) {
                    loginScreen.style.display = 'none';
                }
                
                // Show desktop
                const desktop = document.querySelector('.desktop');
                if (desktop) {
                    desktop.style.display = 'block';
                }
                
                // Show taskbar
                const taskbar = document.querySelector('.taskbar');
                if (taskbar) {
                    taskbar.style.display = 'block';
                }
                
                // Load content immediately
                loadContentFromCMS();
                
                // Show ASCII intro sequence (since boot sequence is bypassed)
                // What's New will be shown automatically after ASCII completes
                showAsciiIntro();
                
                // Setup essential event handlers even in development mode
                setupEssentialEventHandlers();
                
                // Initialize system components
                initializeSystem();
                
                console.log('üöÄ Boot screen disabled for development - content loaded directly');
                return; // Skip the rest of boot sequence
            }
            
            // Setup login screen
            setupLoginKeyHandler();
            
            // Start login ASCII animation with downward typing/wipe effect  
            startBootAsciiAnimation();
            
            // Start clock with tracked interval
            const clockInterval = setInterval(updateClock, 1000);
            AppState.intervals.push(clockInterval);
            updateClock();
            
            // Setup essential event handlers
            setupEssentialEventHandlers();
            
            // Initialize system components
            initializeSystem();
        }
        
        // Essential event handlers that work in both development and production modes
        function setupEssentialEventHandlers() {
            // Handle responsive design
            window.addEventListener('resize', Utils.debounce(handleResize, 250));
            
            // Keyboard shortcuts - ESC key to close all windows
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.window.active').forEach(w => {
                        w.classList.remove('active');
                    });
                }
            });
            
            // Chat input handler
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendChat();
                    }
                });
            }
            
            // Prevent zoom on double tap for mobile
            if (AppState.touchDevice) {
                let lastTouchEnd = 0;
                document.addEventListener('touchend', (e) => {
                    const now = Date.now();
                    if (now - lastTouchEnd <= 300) {
                        e.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
        }

        // Initialize the system when page loads
        function initializeSystem() {
            // Detect environment - use server config in production, local config in development
            const isProduction = window.location.hostname !== 'localhost' && 
                                !window.location.hostname.includes('127.0.0.1') &&
                                !window.location.hostname.includes('192.168.') &&
                                window.location.protocol === 'https:';
            
            setTimeout(() => {
                if (isProduction) {
                    // Production: use server config with database updates
                    console.log('üöÄ Production environment detected - using server config with database');
                    refreshConfigFromServer();
                } else {
                    // Development: use local config files to avoid placeholder URL errors
                    console.log('üîß Development environment detected - using local config files');
                }
            }, 2000); // Delay to ensure all elements are loaded
        }
        
        // Refresh configuration from server
        async function refreshConfigFromServer() {
            console.log('üîÑ CHECKING FOR CONFIG UPDATES FROM SERVER');
            console.log('üïê Current AppState.configLastModified:', AppState.configLastModified);
            try {
                const response = await fetch(`/api/get-config?t=${Date.now()}`);
                console.log('üì° Config fetch response status:', response.status);
                
                if (response.ok) {
                    const response_data = await response.json();
                    
                    // Handle new API structure with config and timestamp
                    const newConfig = response_data.config || response_data;
                    const lastModified = response_data.lastModified;
                    
                    console.log('üì• Raw response_data:', response_data);
                    console.log('üì• newConfig:', newConfig);
                    console.log('üì• newConfig.modules type:', typeof newConfig.modules);
                    console.log('üì• newConfig.modules:', newConfig.modules);
                    console.log('üì• New config received, modules:', Object.keys(newConfig.modules || {}));
                    if (lastModified) {
                        console.log('üìÖ Config timestamp:', new Date(lastModified));
                    }
                    
                    // Validate the new config before applying
                    if (!newConfig.modules || typeof newConfig.modules !== 'object' || Object.keys(newConfig.modules).length === 0) {
                        console.warn('‚ö†Ô∏è Received invalid config from server - modules missing or empty, keeping current config');
                        return;
                    }
                    
                    // Check if config actually changed using timestamp comparison (more reliable than JSON.stringify)
                    const isFirstLoad = !AppState.configLastModified;
                    const configChanged = isFirstLoad || lastModified > AppState.configLastModified;
                    console.log('üîç Config changed?', configChanged, isFirstLoad ? '(first load)' : '(update)');
                    console.log('üìÖ Timestamps - Current:', AppState.configLastModified, 'New:', lastModified);
                    
                    if (configChanged) {
                        console.log('üöÄ APPLYING CONFIG CHANGES TO FRONTEND');
                        AppState.config = newConfig;
                        AppState.configLastModified = lastModified;
                        
                        // Update global reference
                        window.CMS_CONFIG = newConfig;
                        
                        // Reload content with new configuration
                        console.log('üîÑ Reloading content from CMS...');
                        loadDesktopIcons();
                        loadContentFromCMS(); // Update all open windows with new config
                        
                        console.log('‚úÖ Configuration refreshed and applied successfully!');
                        showNotification('‚ú® Content updated from CMS!');
                    } else {
                        console.log('üìã No changes detected in config');
                    }
                } else {
                    console.error('‚ùå Failed to fetch config from server, status:', response.status);
                }
            } catch (error) {
                console.error('üí• Error refreshing config:', error);
            }
        }
        
        // Environment detection for config refresh
        const isProduction = window.location.hostname !== 'localhost' && 
                            !window.location.hostname.includes('127.0.0.1') &&
                            !window.location.hostname.includes('192.168.') &&
                            window.location.protocol === 'https:';
        
        if (isProduction) {
            // Periodically check for config updates in production only
            console.log('üîÑ Enabling periodic config refresh for production environment');
            const configInterval = setInterval(refreshConfigFromServer, 30000);
            AppState.intervals.push(configInterval);
        } else {
            console.log('üîß Skipping periodic config refresh in development environment');
        }
        
        if (isProduction) {
            // Listen for force refresh messages from CMS admin in production only
            window.addEventListener('message', (event) => {
                if (event.data && event.data.type === 'CMS_FORCE_REFRESH') {
                    console.log('üî• Received force refresh signal from CMS admin');
                    showNotification('‚ö° CMS update detected! Refreshing content...');
                    refreshConfigFromServer();
                }
            });
        }
        
        if (isProduction) {
            // Check localStorage for force refresh signals in production only
            const checkForceRefresh = () => {
                const refreshSignal = localStorage.getItem('cms_force_refresh');
                if (refreshSignal) {
                    try {
                        const message = JSON.parse(refreshSignal);
                        const timeDiff = Date.now() - message.timestamp;
                        
                        // Only act on recent signals (within 10 seconds)
                        if (timeDiff < 10000) {
                            console.log('üî• Detected force refresh from localStorage');
                            showNotification('‚ö° CMS update detected! Refreshing content...');
                            refreshConfigFromServer();
                            localStorage.removeItem('cms_force_refresh'); // Clean up
                        }
                    } catch (e) {
                        console.warn('Failed to parse refresh signal:', e);
                        localStorage.removeItem('cms_force_refresh');
                    }
                }
            };
            
            // Check for force refresh signals every 2 seconds in production
            const forceRefreshCheck = setInterval(checkForceRefresh, 2000);
            AppState.intervals.push(forceRefreshCheck);
        }
        
        // Cleanup function for when page unloads
        window.addEventListener('beforeunload', () => {
            // Clear all intervals
            AppState.intervals.forEach(id => clearInterval(id));
            // Clear all timeouts
            AppState.timeouts.forEach(id => clearTimeout(id));
            // Clear all animation frames
            AppState.rafIds.forEach(id => cancelAnimationFrame(id));
        });
        
        // Start application when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>